10'
11'Ï¯ÌßÉ¾²»¸
20'X:¶ÍÞÉ¼Þ®³Î³
21'X:1¶ÍÞ¤2Ø®³ÄËÞ×
22'X:3³´ÉÄËÞ×¤4¼ÀÉÄËÞ×
23'X:5¼Þ®³¹Þ¶¸¼
24'X:6³´É¶¸¼¤7¼ÀÉ¶¸¼
30'Y:¶ÍÞÉ¼Þ®³Î³
31'Y:1¶ÍÞ¤2Ø®³ÄËÞ×
32'Y:3ËÀÞØËÞ×¤4Ð·ÞÄËÞ×
33'Y:5»Õ³¶¸¼
34'Y:6ËÀÞØ¶¸¼¤7Ð·Þ¶¸¼
110CLEAR :CLS :DIM MX(7,7),MY(7,7),W$(20)*5,IV(30),I$(11)*11,A(15),K$(5)*11,KC$(5)*3,E$(2,5)*9,EC(2,5),DK(5),DE(2,4):Z=1,ES=0:EH=5:EO=5:AP=27:DP=5:HP=12:MHP=12:MP=0:MMP=0:LV=1:POKE &HF0,18
120RESTORE 60000:FOR I=0 TO 5:READ K$(I):NEXT :FOR I=0 TO 5:READ KC$(I):NEXT :FOR I=0 TO 2:FOR J=0 TO 4:READ E$(I,J):NEXT :NEXT :FOR I=0 TO 2:FOR J=0 TO 4:READ EC(I,J):NEXT :NEXT :FOR I=0 TO 5:READ DK(I):NEXT
151FOR I=0 TO 2:FOR J=0 TO 4:READ DE(I,J):NEXT :NEXT :FOR I=0 TO 20:READ W$(I):NEXT :GCURSOR (60,47):GPRINT "81FFFFD5ABFFFF81";"FF83A9A9A9DD83FF";"81FFFFD5ABFFFF81":GCURSOR (60,39):GPRINT "03FF4F56F493BFFF";"FFABFF57ABFFABFF";"FFBFF934564FFF03"
152GCURSOR (68,31):GPRINT "000060F98F040000":GCURSOR (68,23):GPRINT "0040E1B31E0C0000":GCURSOR (68,15):GPRINT "000060F98F040000":GCURSOR (68,7):GPRINT "0040E1B31E0C0000"
153FOR I=0 TO 6:BEEP 1,25,2:OUT &H40,&HA6:FOR T=0 TO 6:BEEP 1,127,2:NEXT :OUT &H40,&HA7:FOR T=0 TO 8:BEEP 1,64,2:NEXT :NEXT :OUT &H40,&HA7:LOCATE 11,3:PRINT "  ":WAIT 3:LOCATE 11,0:PRINT "  ":LOCATE 11,2:PRINT "  ":LOCATE 11,1:PRINT "  "
154LOCATE 4,0:PRINT "POKECOM QEST 2!!":OUT &H40,&HA7:CALL 48381
158LOCATE 7,2:PRINT ">NEW GAME":LOCATE 8,3:PRINT "LOAD GAME"
160CALL 48381:K$= INKEY$ :IF K$="" THEN 160
170C=(K$="8")
175IF K$="2" LET C=2
180IF C=-1 LOCATE 7,3:PRINT " ":LOCATE 7,2:PRINT ">":Z=1
190IF C=2 LOCATE 7,2:PRINT " ":LOCATE 7,3:PRINT ">":Z=2
195IF K$="5" WAIT 0:GOTO 210
200GOTO 160
210IF Z=1 LET G=500:CLS :GOSUB *LIN:GOTO 300
220IF Z=2 THEN 230
230IF PEEK &H90=0 LET Z=0:GOTO 160 ELSE CLS :GOSUB *LIN:LOCATE 7,2:PRINT "NOW LOADING":GOTO 240
240LV= PEEK &H90:HP= PEEK &H91:MHP= PEEK &H92:MP= PEEK &H93:MMP= PEEK &H94:AP= PEEK &H95:DP= PEEK &H96:I= PEEK &H97:ES= PEEK &H98:EO= PEEK &H99:EH= PEEK &H9A:W= PEEK &H9B:G= PEEK &H9C*256+ PEEK &H9D:EX= PEEK &H9E*256+ PEEK &H9F
250FOR J=0 TO 10:A(J)= PEEK (&HA0+J):NEXT
260FOR J=0 TO 10:IF A(J)>0 AND A(J)<10 LET I$(J)=K$(A(J)-1)
261NEXT
270FOR J=0 TO 10:FOR T=0 TO 2:FOR B=0 TO 4
280IF A(J)>100 LET A=A(J)-101:I$(J)=E$(A\10,(A/10-A\10)*10)
285NEXT :NEXT :NEXT :B=0:J=0:T=0:IF I=1 LET ST$="PO":I=0
300*CITY:GOSUB *CL :PO=0:O=0:N=0
302GCURSOR (60,7):GPRINT "7E81BDC3C3A581";"81FF81818183FF83";"81838DF98D83817E"
303LOCATE 7,1:PRINT "BAR OF FATE":LOCATE 4,2:PRINT "ADVENTURER'S INN":LOCATE 5,3:PRINT "SHOP OF GILBERD":LOCATE 10,4:PRINT "MAZE"
310GCURSOR (17,15):GPRINT "7F3E1C08"
320GOSUB *KL
340IF O=0 GOSUB *BAR:GOTO *CITY
341IF O=1 GOSUB *INN:GOTO *CITY
342IF O=2 GOSUB *SHOP:GOTO *CITY
343IF O=3 GOSUB *MAZE:GOTO *CITY
350*BAR:PO=1:O=0:N=0
351GOSUB *CL:GCURSOR (60,7):GPRINT "7E8181FFCBCBB581";"8181FD9393FD8181";"81FF8B9BED817E"
352LOCATE 10,1:PRINT "TALK":LOCATE 9,2:PRINT "STATUS":LOCATE 6,3:PRINT "DRINK [SAVE]":LOCATE 9,4:PRINT "RETURN"
355GOSUB *KL
360IF O=0 GOSUB *TALK
361IF O=1 LET O=0:P=1:GOSUB *STATUS:P=0:O=0
362IF O=2 GOSUB *SAV
363IF O=3 RETURN
370GOTO 350
380*INN:PO=2:O=0:N=0
381GOSUB *CL:GCURSOR (60,7):GPRINT "7E8181FF81818181";"FF8D99B1FF818181";"FF8D99B1FF817E"
382LOCATE 4,1:PRINT "RAGGED ROOM   10G":LOCATE 4,2:PRINT "GOOD ROOM    100G":LOCATE 4,3:PRINT "HIGHEST ROOM1000G":LOCATE 9,4:PRINT "RETURN"
385GOSUB *KL
390IF O>=0 AND O<=2 GOSUB *REST:T=5:GOSUB *STATUS:T=0
393IF O=3 RETURN
400GOTO 380
410*SHOP:PO=3
411GOSUB *CL:O=1:N=1:GCURSOR (60,7):GPRINT "7E81A5CBD3A581";"81FF89FF8181BDC3BD";"8181FF8B8B857E"
412LOCATE 7,1:PRINT "#²×¯¼¬²Ï¾#":PRINT :LOCATE 10,2:PRINT "BUY":LOCATE 10,3:PRINT "SELL":LOCATE 9,4:PRINT "RETURN"
415GOSUB *KL
420IF O=1 LET O=0:GOSUB *BUY
421IF O=2 LET O=0:GOSUB *SELL
423IF O=3 RETURN
430GOTO 410
450*MAZE:PO=5:X=0:Y=0:P=1
460GOSUB *CL:LOCATE 7,1:PRINT "YOU WENT TO":LOCATE 6,2:PRINT "THE SHRINE TO":LOCATE 7,3:PRINT "RESCUR FOR":LOCATE 4,4:PRINT "MY FIANCE SILVIA":WAIT 0:CALL 48381:GOTO 10010
2500*BUING:GOSUB *SEIRI:GOSUB *CL:LOCATE 7,2:PRINT "THANK YOU!":CALL 48381:QQ$="":RETURN
2800*SEIRI:J=5
2810FOR T=0 TO 10
2815IF I$(T)="" AND J=5 LET I$(T)=QQ$:J=1
2818NEXT :J=0
2828RETURN
3000*BUY:J=0:PO=5
3010GOSUB *CL
3020IF J=0 LOCATE 4,1:PRINT K$(0);"        8G":LOCATE 4,2:PRINT K$(1);"       15G":LOCATE 4,3:PRINT K$(2);"        80G":LOCATE 4,4:PRINT K$(3);"  200G"
3021IF J=1 LOCATE 4,1:PRINT E$(1,0);"        150G":LOCATE 4,2:PRINT E$(2,0);"        100G":LOCATE 4,3:PRINT K$(5);"    60000G":LOCATE 4,4:PRINT "RETURN           "
3030GOSUB *KL:IF I=10 IF J=2 LET J=0:GOTO 3020 ELSE IF J=-1 LET J=1:GOTO 3020
3035IF I=3 LET T=0:GOTO 3038 ELSE GOTO 3020
3038WHILE T<=10:IF I$(T)="" LET T=11:B=1
3039T=T+1:WEND
3040IF J=0 AND B=1 THEN
3041IF O=0 IF G>=8 LET QQ$=K$(0):G=G-8:GOSUB *BUING:J=0
3042IF O=1 IF G>=15 LET QQ$=K$(1):G=G-15:GOSUB *BUING:J=0
3043IF O=2 IF G>=80 LET QQ$=K$(2):G=G-80:GOSUB *BUING:J=0
3044IF O=3 IF G>=200 LET QQ$=K$(3):G=G-200:GOSUB *BUING:J=0
3099ENDIF
3100IF J=1 AND B=1 THEN
3111IF O=0 IF G>=150 LET QQ$=E$(1,0):G=G-150:GOSUB *BUING:J=0
3112IF O=1 IF G>=100 LET QQ$=E$(2,0):G=G-100:GOSUB *BUING:J=0
3113IF O=2 IF G>=60000 LET QQ$=K$(5):G=G-60000:GOSUB *BUING:J=0
3180ENDIF
3200IF J=1 AND O=3 LET O=0:N=0:RETURN
3499B=0:GOTO 3020
3500*SELL:J=0:PO=5
3510GOSUB 4525:I=0:T=0
3520IF J=0 LET QQ$=I$(O):R=O
3530IF J=1 LET QQ$=I$(O+4):R=O+4
3540IF J=2 LET QQ$=I$(O+8):R=O+8
3545IF P=1 RETURN
3550WHILE T<6
3551IF QQ$=K$(T) AND I=0 LET A=DK(T):I=1
3553T=T+1:WEND
3554T=0:Y=0:I=0
3555WHILE T<3:WHILE Y<5
3556IF QQ$=E$(T,Y) AND I=0 LET A=DE(T,Y):I=1
3558Y=Y+1:WEND :Y=0:T=T+1:WEND :T=0:Y=0:I=0
3559IF A=0 GOTO 3999
3560GOSUB *CL:LOCATE 4,1:PRINT "#³ØÈÊ"; STR$ INT (A/2);"G":LOCATE 8,2:PRINT "ÄÞ³½Ù? Y/N?#":I=0
3570IF INKEY$ ="Y" LET I$(R)="":BEEP 1,127,7:G=G+ INT (A/2):GOSUB *CL:LOCATE 7,2:PRINT "THANK YOU!":CALL 48381:GOTO 3590
3575IF INKEY$ ="N" GOTO 3590
3580GOTO 3570
3590IF G>65535 LET G=65535
3999A=0:QQ$="":R=0:IF J=2 AND O=3 LET O=0:RETURN ELSE GOTO 3510
4000*REST:I=0
4010IF O=0 IF G>=10 BEEP 1,255,90:HP=HP+25:MP=MP+5:G=G-10:I=1
4020IF O=1 IF G>=100 BEEP 1,127,180:HP=HP+100:MP=MP+50:G=G-100:I=1
4030IF O=2 IF G>=1000 BEEP 4,42,100:HP=MHP:MP=MMP:G=G-1000:I=1
4031IF HP>MHP LET HP=MHP
4032IF MP>MMP LET MP=MMP
4040IF I>0 LOCATE 8,4:PRINT "THANK YOU":CALL 48381:I=0
4199RETURN
4200*TALK:GOSUB *CL
4210ON W+1 GOTO 4220
4220LOCATE 5,2:PRINT "ºÉ ¼ÝÃÞÝ É Á¶ÆÊ":LOCATE 4,3:PRINT "Ì¼Á®³ É ¼®³ºÞ³ ¶Þ":LOCATE 5,4:PRINT "Ì³²Ý »ÚÃ²Ù Ä²³":LOCATE 3,1:PRINT "####ÊÞ- É Ï½À-####":GOTO 4499
4499CALL 48381:RETURN
4500*STATUS:PO=5
4510GOSUB *CL:LOCATE 3,1:PRINT "###STATUS###   ###":LOCATE 3,2:PRINT "HP "; STR$ HP;"/"; STR$ MHP:LOCATE 3,3:PRINT "MP "; STR$ MP;"/"; STR$ MMP:LOCATE 3,4:PRINT "EX "; STR$ EX:J=0
4515LOCATE 14,1:PRINT "LV "; STR$ LV:LOCATE 14,2:PRINT "AP "; STR$ AP:LOCATE 14,3:PRINT "DP "; STR$ DP:LOCATE 14,4:PRINT "ST ";ST$:CALL 48381
4520GOSUB *CL:LOCATE 3,1:PRINT "#######¿³ËÞ#######":LOCATE 6,2:PRINT "ÌÞ·:";E$(0,ES):LOCATE 6,3:PRINT "ÀÃ :";E$(2,EH):LOCATE 6,4:PRINT "ÖÛ²:";E$(1,EO):CALL 48381:J=0:IF T=5 RETURN
4525IF J=0 GOSUB *CL:FOR T=0 TO 3:LOCATE 7,T+1:PRINT I$(T):NEXT
4535IF J=1 GOSUB *CL:FOR T=0 TO 3:LOCATE 7,T+1:PRINT I$(T+4):NEXT
4540IF J=2 GOSUB *CL:FOR T=0 TO 2:LOCATE 7,T+1:PRINT I$(T+8):NEXT :LOCATE 7,4:PRINT "RETURN"
4550GOSUB *KL:IF J=-1 LET J=2 ELSE IF J=3 LET J=0
4560IF I=10 GOTO 4525
4562IF P=1 LET Y=O:Z=J:GOSUB 3520:IF O=3 AND J=2 GOTO 4570 ELSE IF I$(R)="" LET I=0:R=0:GOTO 4525 ELSE GOTO 4565
4565IF P=1 GOSUB *CL:LOCATE 6,1:PRINT "#ÄÞ³½Ù?#":LOCATE 8,2:PRINT "Â¶³/¿³ËÞ":LOCATE 8,3:PRINT "½ÃÙ":LOCATE 8,4:PRINT "ÓÄÞÙ":L=1:O=1:GOSUB *KL:L=0
4567IF P=1 IF O=1 LET O=0:GOTO 4570 ELSE IF O=2 LET O=0:GOTO 4568 ELSE IF O=3 LET O=0:GOTO 4525
4568IF P=1 IF I$(R)=E$(0,4) OR I$(R)=E$(1,4) OR I$(R)=E$(2,4) GOTO 4565 ELSE LOCATE 3,4:PRINT I$(R);" ¦½ÃÏ¼À":I$(R)="":CALL 48381:O=0:J=0:GOTO 4592
4570IF I=3 AND P=1 THEN
4575A=3:X=0:O=Y:J=Z:GOSUB 3520:U=0:T=0:WHILE U<=2:WHILE T<=4:IF I$(R)=E$(U,T) LET A=U:B=T:X=12:U=3:T=6
4576T=T+1:WEND :U=U+1:T=0:WEND :IF X=12 GOSUB *EQ:GOTO 4510
4580IF I$(R)=K$(0) LET QQ$=KC$(0):GOSUB *HEALA ELSE IF I$(R)=K$(1) LET QQ$=KC$(1):GOSUB *HEALC ELSE IF I$(R)=K$(2) LET QQ$=KC$(2):GOSUB *HEALA ELSE IF I$(R)=K$(3) LET QQ$=KC$(3):GOSUB *HEALB ELSE IF I$(R)=K$(4) LET QQ$=KC$(4):GOSUB *HEALD
4590ENDIF
4592IF T=7 LET T=0:O=0:J=0:GOTO 4510
4595IF I=3 AND P=1 IF J=2 AND O=3 GOTO 4599 ELSE GOTO 4525
4599Y=0:Z=0:I=0:T=0:A=0:P=0:RETURN
4600*SAV:GOSUB *CL:LOCATE 7,2:PRINT "NOW SAVING":FOR J=0 TO 10:A(J)=0:NEXT
4610FOR J=0 TO 10:FOR T=0 TO 5
4615IF I$(J)=K$(T) LET A(J)=(T+1)
4620NEXT :NEXT
4630FOR J=0 TO 10:FOR T=0 TO 2:FOR A=0 TO 4
4635IF I$(J)=E$(T,A) LET A(J)=101+T*10+A
4640NEXT :NEXT :NEXT :IF ST$="" LET I=0 ELSE I=1
4650POKE &H90,LV,HP,MHP,MP,MMP,AP,DP,I,ES,EO,EH,W,G\256,G MOD 256,EX\256,EX MOD 256:POKE &HA0,A(0),A(1),A(2),A(3),A(4),A(5),A(6),A(7),A(8),A(9),A(10)
4699A=0:B=0:I=0:RETURN
4975*KL
4978GCURSOR (17,O*8+15):GPRINT "7F3E1C08"
4979CALL 48381:N=O:K$= INKEY$ :IF K$="" THEN 4979
4981IF PO=5 IF K$="6" LET J=J+1:I=10:RETURN ELSE IF K$="4" LET J=J-1:I=10:RETURN
4982IF K$="2" LET O=O+1 ELSE IF K$="8" LET O=O-1
4983IF O=-1 LET O=3
4984IF O=4 LET O=0
4985IF PO=3 OR L=1 IF O=0 IF N=3 LET O=1 ELSE LET O=3
4986GCURSOR (16,N*8+15):GPRINT "0000000000":GCURSOR (17,O*8+15):GPRINT "7F3E1C08"
4987IF K$="5" BEEP 1,127,5:I=3:RETURN ELSE GOTO 4979
4990*LIN:LINE (16,3)-(126,3):LINE (127,3)-(127,42):LINE (15,3)-(15,42):LINE (16,42)-(126,42):RETURN
4996*CL:LOCATE 14,0:PRINT "      ":LOCATE 14,0:PRINT STR$ G:LOCATE 19,0:PRINT "G":LINE (17,4)-(17,40),R
4997LOCATE 3,1:PRINT "                  ":LOCATE 3,2:PRINT "                  "
4998LOCATE 3,3:PRINT "                  ":LOCATE 3,4:PRINT "                  ":RETURN
5000DATA 11,1,1,1,1,1,1,11
5001DATA 1,1,2,1,2,1,0,1
5002DATA 1,1,1,1,0,0,0,0
5003DATA 0,1,4,0,1,1,0,12
5004DATA 0,0,0,11,1,1,1,1
5005DATA 0,1,1,1,1,0,0,1
5006DATA 1,1,1,1,1,1,0,0
5007DATA 0,1,1,1,1,1,1,11
5010DATA 1,0,1,1,1,1,1,1
5011DATA 2,0,0,1,3,0,0,0
5012DATA 0,0,0,0,0,0,0,0
5013DATA 0,0,0,1,1,0,0,0
5014DATA 0,1,1,0,0,0,0,0
5015DATA 0,0,0,0,0,0,0,0
5016DATA 0,1,1,2,0,1,0,0
5017DATA 2,1,1,1,0,1,0,0
5020DATA 0,7,7,3,7,9
5021DATA 0,7,3,4,0,9
5022DATA 1,2,3,4,7,9
10010GOSUB *STATUS:Z=1:F=1
10020*MAIN
10030ON F GOTO 10101,10102,10103,10104,10105,10106,10107,10108,10109,10110,10111,10112,10113,10114,10115,10116,10117,10118,10119,10120
10101RESTORE 5000:GOTO 10124
10102RESTORE 5100:GOTO 10124
10103RESTORE 5200:GOTO 10124
10104RESTORE 5300:GOTO 10124
10105RESTORE 5400:GOTO 10124
10106RESTORE 5500:GOTO 10124
10107RESTORE 5600:GOTO 10124
10108RESTORE 5700:GOTO 10124
10109RESTORE 5800:GOTO 10124
10110RESTORE 5900:GOTO 10124
10111RESTORE 6000:GOTO 10124
10112RESTORE 6100:GOTO 10124
10113RESTORE 6200:GOTO 10124
10114RESTORE 6300:GOTO 10124
10115RESTORE 6400:GOTO 10124
10116RESTORE 6500:GOTO 10124
10117RESTORE 6600:GOTO 10124
10118RESTORE 6700:GOTO 10124
10119RESTORE 6800:GOTO 10124
10120RESTORE 6900:GOTO 10124
10124FOR I=0 TO 7:FOR J=0 TO 7
10125READ MX(J,I)
10130NEXT J:NEXT I
10140FOR I=0 TO 7:FOR J=0 TO 7
10150READ MY(J,I)
10160NEXT J:NEXT I
10180FOR I=0 TO 5:READ IV(I):IF IV(I)=9 LET I=10
10181NEXT :FOR I=6 TO 11:READ IV(I):IF IV(I)=9 LET I=19
10185NEXT :FOR I=12 TO 17:READ IV(I):IF IV(I)=9 LET I=29
10190NEXT :CLS :Z=1:I=0:GOTO 10210
10200*LOOP
10205GOSUB *KLM
10208D=0:I=0:J=0:T=0:L=0:R=0:B=0
10210IF Z=1 THEN
10220A(0)=X-1:A(1)=X:A(2)=X+1:A(3)=Y-1:A(4)=X:A(5)=X+1:A(6)=Y
10230FOR I=0 TO 7:IF A(I)>7 LET A(I)=0 ELSE IF A(I)<0 LET A(I)=7
10231NEXT :I=0
10235B=-(MX(A(1),A(6))>9):MX(A(1),A(6))=MX(A(1),A(6))-B*10
10240IF MX(A(1),A(6))>0 LET D=1:CALL &H2A4:T=1:IF MX(A(1),A(6))=2 OR MX(A(1),A(6))=4 LET D=2:CALL &H734
10241IF MY(A(3),A(4))>0 AND T=0 CALL &H167:L=1:IF MY(A(3),A(4))=2 OR MY(A(3),A(4))=4 CALL &H68B
10242IF MY(A(3),A(5))>0 AND T=0 CALL &H1F9:R=1:IF MY(A(3),A(5))=2 OR MY(A(3),A(5))=3 CALL &H6DF
10243IF T=0 AND L=0 IF MX(A(0),A(3))>0 CALL &H28B:IF MX(A(0),A(3))=2 OR MX(A(0),A(3))=4 CALL &H615
10244IF T=0 IF MX(A(1),A(3))>0 CALL &H293:IF MX(A(1),A(3))=2 OR MX(A(1),A(3))=4 CALL &H61D
10245IF T=0 AND R=0 IF MX(A(2),A(3))>0 CALL &H29B:IF MX(A(2),A(3))=2 OR MX(A(2),A(3))=4 CALL &H625
10246IF MY(A(6),A(4))>0 CALL &H4F1:I=1:IF MY(A(6),A(4))=2 OR MY(A(6),A(4))=4 CALL &H886
10247IF MY(A(6),A(5))>0 CALL &H583:J=1:IF MY(A(6),A(5))=2 OR MY(A(6),A(5))=3 CALL &H8FA
10248IF MX(A(0),A(6))>0 AND I=0 CALL &H4DF:IF MX(A(0),A(6))=2 OR MX(A(0),A(6))=4 CALL &H816
10249IF MX(A(2),A(6))>0 AND J=0 CALL &H4E8:IF MX(A(2),A(6))=2 OR MX(A(2),A(6))=4 CALL &H84E
10257ENDIF
10260IF Z=3 THEN
10270A(0)=X+1:A(1)=X:A(2)=X-1:A(3)=Y+2:A(4)=X+1:A(5)=X:A(6)=Y+1:A(7)=Y
10280FOR I=0 TO 7:IF A(I)>7 LET A(I)=A(I)-8 ELSE IF A(I)<0 LET A(I)=8+A(I)
10281NEXT :I=0
10285B=-(MX(A(1),A(7))>9):MX(A(1),A(7))=MX(A(1),A(7))-B*10
10287IF MX(A(1),A(6))>9 LET A(10)=1:MX(A(1),A(6))=MX(A(1),A(6))-10
10288IF MX(A(1),A(3))>9 LET A(9)=1:MX(A(1),A(3))=MX(A(1),A(3))-10
10290IF MX(A(1),A(6))>0 LET D=1:CALL &H2A4:T=1:IF MX(A(1),A(6))=2 OR MX(A(1),A(6))=3 LET D=2:CALL &H734
10291IF MY(A(6),A(4))>0 AND T=0 CALL &H167:L=1:IF MY(A(6),A(4))=2 OR MY(A(6),A(4))=3 CALL &H68B
10292IF MY(A(6),A(5))>0 AND T=0 CALL &H1F9:R=1:IF MY(A(6),A(5))=2 OR MY(A(6),A(5))=4 CALL &H6DF
10293IF T=0 AND L=0 IF MX(A(0),A(3))>0 CALL &H28B:IF MX(A(0),A(3))=2 OR MX(A(0),A(3))=4 CALL &H615
10294IF T=0 IF MX(A(1),A(3))>0 CALL &H293:IF MX(A(1),A(3))=2 OR MX(A(1),A(3))=4 CALL &H61D
10295IF T=0 AND R=0 IF MX(A(2),A(3))>0 CALL &H29B:IF MX(A(2),A(3))=2 OR MX(A(2),A(3))=4 CALL &H625
10296IF MY(A(7),A(4))>0 CALL &H4F1:I=1:IF MY(A(7),A(4))=2 OR MY(A(7),A(4))=3 CALL &H886
10297IF MY(A(7),A(5))>0 CALL &H583:J=1:IF MY(A(7),A(5))=2 OR MY(A(7),A(5))=4 CALL &H8FA
10298IF MX(A(0),A(6))>0 AND I=0 CALL &H4DF:IF MX(A(0),A(6))=2 OR MX(A(0),A(6))=3 CALL &H816
10299IF MX(A(2),A(6))>0 AND J=0 CALL &H4E8:IF MX(A(2),A(6))=2 OR MX(A(2),A(6))=3 CALL &H84E
10307ENDIF
10310IF Z=4 THEN
10320A(0)=Y+1:A(1)=Y:A(2)=Y-1:A(3)=X-1:A(4)=Y:A(5)=Y+1:A(6)=X
10330FOR I=0 TO 7:IF A(I)>7 LET A(I)=A(I)-8 ELSE IF A(I)<0 LET A(I)=8+A(I)
10331NEXT :I=0
10335B=-(MX(A(6),A(4))>9):MX(A(6),A(4))=MX(A(6),A(4))-B*10
10340IF MY(A(1),A(6))>0 LET D=1:CALL &H2A4:T=1:IF MY(A(1),A(6))=2 OR MY(A(1),A(6))=4 LET D=2:CALL &H734
10341IF MX(A(3),A(5))>0 AND T=0 CALL &H167:L=1:IF MX(A(3),A(5))=2 OR MX(A(3),A(5))=3 CALL &H68B
10342IF MX(A(3),A(4))>0 AND T=0 CALL &H1F9:R=1:IF MX(A(3),A(4))=2 OR MX(A(3),A(4))=4 CALL &H6DF
10343IF T=0 AND L=0 IF MY(A(0),A(3))>0 CALL &H28B:IF MY(A(0),A(3))=2 OR MY(A(0),A(3))=4 CALL &H615
10344IF T=0 IF MY(A(1),A(3))>0 CALL &H293:IF MY(A(1),A(3))=2 OR MY(A(1),A(3))=4 CALL &H61D
10345IF T=0 AND R=0 IF MY(A(2),A(3))>0 CALL &H29B:IF MY(A(2),A(3))=2 OR MY(A(2),A(3))=4 CALL &H625
10346IF MX(A(6),A(5))>0 CALL &H4F1:I=1:IF MX(A(6),A(5))=2 OR MX(A(6),A(5))=3 CALL &H886
10347IF MX(A(6),A(4))>0 CALL &H583:J=1:IF MX(A(6),A(4))=2 OR MX(A(6),A(4))=4 CALL &H8FA
10348IF MY(A(0),A(6))>0 AND I=0 CALL &H4DF:IF MY(A(0),A(6))=2 OR MY(A(0),A(6))=4 CALL &H816
10349IF MY(A(2),A(6))>0 AND J=0 CALL &H4E8:IF MY(A(2),A(6))=2 OR MY(A(2),A(6))=4 CALL &H84E
10357ENDIF
10360IF Z=2 THEN
10370A(0)=Y-1:A(1)=Y:A(2)=Y+1:A(3)=X+2:A(4)=Y:A(5)=Y+1:A(6)=X+1:A(7)=X
10380FOR I=0 TO 7:IF A(I)>7 LET A(I)=A(I)-8 ELSE IF A(I)<0 LET A(I)=8+A(I)
10381NEXT :I=0
10385B=-(MX(A(7),A(4))>9):MX(A(7),A(4))=MX(A(7),A(4))-B*10
10390IF MY(A(1),A(6))>0 LET D=1:CALL &H2A4:T=1:IF MY(A(1),A(6))=2 OR MY(A(1),A(6))=3 LET D=2:CALL &H734
10391IF MX(A(6),A(4))>0 AND T=0 CALL &H167:L=1:IF MX(A(6),A(4))=2 OR MX(A(6),A(4))=4 CALL &H68B
10392IF MX(A(6),A(5))>0 AND T=0 CALL &H1F9:R=1:IF MX(A(6),A(5))=2 OR MX(A(6),A(5))=3 CALL &H6DF
10393IF T=0 AND L=0 IF MY(A(0),A(3))>0 CALL &H28B:IF MY(A(0),A(3))=2 OR MY(A(0),A(3))=3 CALL &H615
10394IF T=0 IF MY(A(1),A(3))>0 CALL &H293:IF MY(A(1),A(3))=2 OR MY(A(1),A(3))=3 CALL &H61D
10395IF T=0 AND R=0 IF MY(A(2),A(3))>0 CALL &H29B:IF MY(A(2),A(3))=2 OR MY(A(2),A(3))=3 CALL &H625
10396IF MX(A(7),A(4))>0 CALL &H4F1:I=1:IF MX(A(7),A(4))=2 OR MX(A(7),A(4))=4 CALL &H886
10397IF MX(A(7),A(5))>0 CALL &H583:J=1:IF MX(A(7),A(5))=2 OR MX(A(7),A(5))=3 CALL &H8FA
10398IF MY(A(0),A(6))>0 AND I=0 CALL &H4DF:IF MY(A(0),A(6))=2 OR MY(A(0),A(6))=3 CALL &H816
10399IF MY(A(2),A(6))>0 AND J=0 CALL &H4E8:IF MY(A(2),A(6))=2 OR MY(A(2),A(6))=3 CALL &H84E
10406ENDIF
10407I=0:J=0:T=0:L=0:R=0
10408I=-(A(9)=1)*10:MX(A(1),A(3))=MX(A(1),A(3))+I
10409I=-(A(10)=1)*10:MX(A(1),A(6))=MX(A(1),A(6))+I:I=0:A(9)=0:A(10)=0
10410IF B=1 GOTO *IV
10420GOTO *LOOP
10421*KLM
10425N=X:M=Y:V=Z
10430K$= INKEY$ :IF K$="" GOTO 10430
10440IF K$="4" LET Z=Z-1:IF Z=0 LET Z=4
10441IF K$="6" LET Z=Z+1:IF Z=5 LET Z=1
10442IF K$="2" LET Z=Z+2:IF Z>4 LET Z=Z-4
10443IF (K$="8" OR K$="5") AND (D=0 OR D=2) ON Z GOTO 10444,10445,10446,10447 ELSE GOTO 10450
10444Y=Y-1:GOTO 10450
10445X=X+1:GOTO 10450
10446Y=Y+1:GOTO 10450
10447X=X-1
10450IF D=2 AND (N<>X OR M<>Y) BEEP 1,92,8
10451IF (K$="8" OR K$="5") IF (N=X AND M=Y) IF D=1 LOCATE 10,3:PRINT "²Ã!":BEEP 3,218,4
10452IF X<0 LET X=X+8 ELSE IF X>7 LET X=X-8 ELSE IF Y<0 LET Y=Y+8 ELSE IF Y>7 LET Y=Y-8
10455I=3:CLS 'GOSUB 4997:LOCATE 3,5:PRINT "                  "
10460RETURN
11000GOTO *LOOP
11010*IV:FOR I=0 TO 5:J=(IV(I)=X):O=(IV(I+6)=Y):IF J=-1 AND J=O IF (N<>X OR M<>Y) LOCATE 9,0:PRINT "IVENT":E=I+1 ELSE I=5:E=0
11020NEXT
11025IF E>0 GOSUB *IVE
11030ON Z GOTO 11140,11150,11160,11170
11140MX(A(1),A(6))=MX(A(1),A(6))+10:GOTO *LOOP
11150MX(A(7),A(4))=MX(A(7),A(4))+10:GOTO *LOOP
11160MX(A(1),A(7))=MX(A(1),A(7))+10::GOTO *LOOP
11170MX(A(6),A(4))=MX(A(6),A(4))+10:GOTO *LOOP
11200*IVE:ON IV(11+E) GOTO *UP,*DOWN,*TEL,*WARP,*TT,*##,*BSH,*SH
11210*UP:A(11)=2:A(12)=0:A(13)=1:A(14)=8:A(15)=4:GOTO 11300
11220*DOWN:A(11)=3:A(12)=0:A(13)=1:A(14)=8:A(15)=4:GOTO 11300
11230*TEL:A(11)=9:A(12)=7:A(13)=1:A(14)=8:A(15)=4
11300LOCATE 0,0:PRINT W$(A(11)):LOCATE 0,1:PRINT W$(A(12)):LOCATE 0,2:PRINT W$(A(13)):LOCATE 0,3:PRINT W$(A(14)):LOCATE 0,4:PRINT W$(A(15)):LOCATE 1,5:PRINT "Y/N":CALL 48381:RETURN
60000*ITEM
60010DATA "·½Þ¸Þ½Ø","ÄÞ¸¹¼¿³","Îß-¼®Ý","Ï¼Þ¯¸Îß-¼®Ý","´Ø¸¼¬-","·¾·É¸½Ø"
60020DATA "30","PO","120","50","255","255"
60030DATA "ÄÞ³É¹Ý","Ê¶ÞÈÉÂÙ·Þ","Ë¶ØÉ¹Ý","Ïµ³É·ÊÞ","Ê¸·ÞÝÉ¶ÀÅ"
60033DATA "¶ÜÖÛ²","Ê¶ÞÈÉÖÛ²","Ï¼Þ¯¸Ò²Ù","¹ÞÝ¼ÞÉÖÛ²","Ê¸·ÞÝÉÖÛ²"
60036DATA "¶ÜÉÀÃ","º³ÃÂÉÀÃ","Ð×-¼-ÙÄÞ","Ú½Ä¼-ÙÄÞ","Ê¸·ÞÝÉÀÃ"
60040DATA 22,51,74,115,150
60060DATA 16,25,46,69,90
60080DATA 12,24,31,42,60
60090DATA 8,15,80,200,10000,60000,200,1000,5000,15000,0,150,1200,6200,17000,0,100,1000,4400,12500,0
60100*HEALA
60110HP=HP+ VAL QQ$:IF HP>MHP LET HP=MHP
60120GOTO 60200
60130*HEALB
60140MP=MP+ VAL QQ$:IF MP>MMP LET MP=MMP
60150GOTO 60200
60160*HEALC
60170ST$="":GOTO 60200
60180*HEALD
60190HP=HP+ VAL QQ$:IF HP>MHP LET HP=MHP
60195MP=MP+ VAL QQ$:IF MP>MMP LET MP=MMP
60200I$(R)="":QQ$="":R=0:T=7:RETURN
60210*EQ
60215ON A+1 GOTO 60220,60230,60240,60250
60220AA$=E$(0,ES):AP=AP-EC(0,ES):I$(R)=AA$:ES=B:AP=AP+EC(0,B):GOTO 60250
60230AA$=E$(1,EO):DP=DP-EC(1,EO):I$(R)=AA$:EO=B:DP=DP+EC(1,B):GOTO 60250
60240AA$=E$(2,EH):DP=DP-EC(2,EH):I$(R)=AA$:EH=B:DP=DP+EC(2,B)
60250A=3:B=0:T=0:U=0:AA$="":RETURN
60300DATA "¶²ÀÞÝ","¶Þ ±Ù","ÉÎÞØ","¸ÀÞØ","Ï½¶?","ÄÞ³½Ù","Ü-Ìß","¿Þ-Ý","Â¶²","ÃÚÎß","","","","","","","","","","",""
