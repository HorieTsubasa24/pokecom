org 100h

 CALL 0BD0FH 
 ld (RANDM+1),HL
 ld B,255
ran:
 push BC
 call RAND4
 ld L,A
 ld H,0
 call ASCN
 ld DE,0
 ld HL,NMEMRY
 ld B,5
 call 0bff1h
 call 48381
 pop BC
 djnz ran
 ret

;-------RAND----------

RAND:;A∆∂¥Ω
 PUSH HL
 LD HL,0
 LD D,H
 LD E,L
 ADD HL,HL
 ADD HL,HL
 ADD HL,DE
RANDM:
 LD DE,0
 ADD HL,DE
 LD (RAND+2),HL
 LD A,H
 POP HL
 RET
RAND4:
 CALL RAND
 AND 3
 RET


NMEMRY:
 DB 0,0,0,0,0
ASCN:;HL=êîíl(2byte)Å®DEÇÃ±ƒﬁ⁄Ω
 LD DE,NMEMRY
 LD BC,10000
 CALL WARIS
 LD BC,1000
 CALL WARIS
 LD BC,100
 CALL WARIS
 LD BC,10
 CALL WARIS
 LD A,L
 LD (DE),A
 LD B,5
 LD DE,NMEMRY
ASCL:
 LD A,(DE)
 CP 0
 JR Z,ASCL2
 JR ASC2
ASCL2:
 INC DE
 DJNZ ASCL
 LD B,1
 LD DE,NMEMRY+4
ASC2:
 LD A,(DE)
 LD C,30H
 ADD A,C
 LD (DE),A
 INC DE
 DJNZ ASC2
 RET
WARIS:
 XOR A
;WARI1:
 SBC HL,BC
 JR C,WARI2
 INC A
 JR WARIS+1
WARI2:
 ADD HL,BC
 LD (DE),A
 INC DE		;
 RET

