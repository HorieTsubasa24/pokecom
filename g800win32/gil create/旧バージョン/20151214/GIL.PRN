			  Z80 ASSEMBLER - ZASM VER 1.6
  0100                	org 0100h
                      	
  0000                	overwrite:equ 0
  001E                	x0:equ 30
  008C                	xm:equ 140
  0000                	y0:equ 0
  002F                	ym:equ 47
  0080                	t:equ 80h
  0000                	f:equ 0
                      	
  BFD0                	grp:equ 0bfd0h
  BFF1                	msp:equ 0bff1h
  BCFD                	kwait:equ 0bcfdh
  BE53                	kscan:equ 0be53h
                      	
                      	
                      	
                      	;*******************Title graph********************
  0100                	start:
  0100  210000        	 ld HL,0
  0103  39            	 add HL,SP
  0104  225E0D        	 ld (retP+1),HL
  0107  CDE60D        	 call cls 
  010A  21DD17        	 ld HL,graph_title
  010D  110800        	 ld DE,0008h
  0110  0632          	 ld B,50
  0112  CD310E        	 call grp_open
  0115                	start_l:
  0115  3E01          	 ld A,1
  0117  32974A        	 ld (floor),A
  011A  CD400E        	 call keysc		;left,right,on,0,/,space,down,up
  011D  CB57          	 bit 2,A
  011F  C0            	 ret nz
  0120  CB5F          	 bit 3,A
  0122  2006          	 jr nz,before_game_c
  0124  CB6F          	 bit 5,A
  0126  2052          	 jr nz,init
  0128  18EB          	 jr start_l
                      	;*****************Continue*******************
  012A                	before_game_c:
  012A  CB6F          	 bit 5,A
  012C  28E7          	 jr z,start_l
  012E  CDE60D        	 call cls
  0131  214103        	 ld HL,continue_ms
  0134  110201        	 ld DE,0102h
  0137  0612          	 ld B,18
  0139  CDF1BF        	 call msp
  013C  2A974A        	 ld HL,(floor)
  013F  2600          	 ld H,0
  0141  CDA00D        	 call ascn
  0144                	before_game_c_floor:
  0144  2A974A        	 ld HL,(floor)
  0147  2600          	 ld H,0
  0149  CDA00D        	 call ascn
  014C  219E0D        	 ld HL,nmemry+3
  014F  110B03        	 ld DE,030bh
  0152  0602          	 ld B,2
  0154  CDF1BF        	 call msp
  0157  CDFDBC        	 call kwait
  015A  21974A        	 ld HL,floor
  015D  FE1E          	 cp 1eh
  015F  281C          	 jr z,Stating_before
  0161  FE20          	 cp 20h
  0163  280C          	 jr z,before_game_c_u
  0165  FE1F          	 cp 1fh
  0167  20DB          	 jr nz,before_game_c_floor
  0169                	before_game_c_d:
  0169  35            	 dec (HL)
  016A  AF            	 xor A
  016B  BE            	 cp (HL)
  016C  20D6          	 jr nz,before_game_c_floor
  016E  34            	 inc (HL)
  016F  18D3          	 jr before_game_c_floor
  0171                	before_game_c_u:
  0171  34            	 inc (HL)
  0172  3E3D          	 ld A,61
  0174  BE            	 cp (HL)
  0175  20CD          	 jr nz,before_game_c_floor
  0177  35            	 dec (HL)
  0178  18CA          	 jr before_game_c_floor
                      	 
                      	 
                      	 
                      	;***************init************************** 
  017A                	init:
  017A  CD4302        	 call init_c
                      	 
                      	;***************Starting game****************
                      	;***************massage*********************
                      	
  017D                	Stating_before:
  017D  CD5202        	 call stating_before_c
                      	
                      	;***********************free aria cleen****************
                      	
  0180  CD9002        	 call freecls
                      	
                      	;***********************map set************************
  0183  CD7410        	 call Map_make
                      	
                      	;********************************obj set***************************
                      	
  0186  CD2403        	 call nextck
                      	
                      	;***********************obj init************************
  0189                	stating_obj:
  0189  219E4A        	 ld HL,obj
  018C  3600          	 ld (HL),0
  018E  119F4A        	 ld DE,obj+1
  0191  015001        	 ld BC,48+48+48+96+48+48
  0194  EDB0          	 ldir
                      	;***********************obj countor**************
  0196  21591A        	 ld HL,obj_1
  0199  3A974A        	 ld A,(floor)
  019C  3D            	 dec A
  019D  280B          	 jr Z,stating_obj_1
                      	
  019F  57            	 ld D,A
                      	;*********************0=end sign****next floor data***ldi loop**********
  01A0                	stating_obj_2:
  01A0  010000        	 ld BC,0
  01A3  3E00          	 ld A,0
  01A5  EDB1          	 cpir
  01A7  15            	 dec D
  01A8  20F6          	 jr nz,stating_obj_2
  01AA                	stating_obj_1:
  01AA  119E4A        	 ld DE,obj
  01AD                	stating_obj_3:
  01AD  7E            	 ld A,(HL)
  01AE  B7            	 or A
  01AF  2804          	 jr z,stating_obj_7
  01B1  EDA0          	 ldi
  01B3  18F8          	 jr stating_obj_3
                      	
                      	;*********************obj cp= then goto mainbefore***************
                      	
  01B5                	stating_obj_7:
  01B5  219E4A        	 ld HL,obj
  01B8  110000        	 ld DE,0
  01BB                	stating_obj_4:
  01BB  AF            	 xor A
  01BC  BE            	 cp (HL)
  01BD  CA3D02        	 jp z,main_before		;stating_obj_hp
  01C0  E5            	 push HL
  01C1  D5            	 push DE
                      	
                      	;x=x+7*A
  01C2  ED5F          	 ld A,R;call rand
  01C4  E60F          	 and 0fh		;a=0~15
  01C6  211E00        	 ld HL,001eh	;30
  01C9  110700        	 ld DE,0007h
  01CC  CD940D        	 call xsan
                      	
                      	
                      	;y=y+7*A
  01CF  CD790D        	 call rand
  01D2                	stating_obj_5:
  01D2  D606          	 sub 6
  01D4  30FC          	 jr nc,stating_obj_5
  01D6  C606          	 add A,6
  01D8  110007        	 ld DE,0700h
  01DB  CD940D        	 call xsan
                      	
  01DE  D1            	 pop DE
  01DF  E5            	 push HL		;xy
                      	
  01E0  215E4B        	 ld HL,obj_xy		;address
  01E3  19            	 add HL,DE		;address+
                      	
  01E4  CDF701        	 call stating_obj_hp_wp
                      	
  01E7  19            	 add HL,DE		;address++
  01E8  22EE01        	 ld (stating_obj_6+1),HL
                      	; add HL,DE		;address++(direction)
  01EB  13            	 inc DE
                      	
  01EC  E1            	 pop HL
                      	
                      	; ld HL,151eh;(30,0)
                      	
  01ED                	stating_obj_6:
  01ED  220000        	 ld (overwrite),HL
  01F0  222B4C        	 ld (gil_xy),HL
  01F3  E1            	 pop  HL
  01F4  23            	 inc HL
  01F5  18C4          	 jr stating_obj_4
                      	
                      	;*********************obs  hp  wp set*********************
  01F7                	stating_obj_hp_wp:
  01F7  E5            	 push HL
  01F8  D5            	 push DE
  01F9  212802        	 ld HL,stating_obj_hp_wp6
  01FC  E5            	 push HL
                      	
  01FD  219E4A        	 ld HL,obj
  0200  19            	 add HL,DE
  0201  7E            	 ld A,(HL)
  0202  E60F          	 and 0fh
  0204  CB7E          	 bit 7,(HL)
  0206  201C          	 jr nz,stating_obj_hp_wp5
  0208  CB76          	 bit 6,(HL)
  020A  2014          	 jr nz,stating_obj_hp_wp4
  020C  CB6E          	 bit 5,(HL)
  020E  200C          	 jr nz,stating_obj_hp_wp3
  0210  CB66          	 bit 4,(HL)
  0212  2004          	 jr nz,stating_obj_hp_wp2
  0214                	stating_obj_hp_wp1:
  0214  215F4A        	 ld HL,hp_table1
  0217  C9            	 ret
  0218                	stating_obj_hp_wp2:
  0218  216F4A        	 ld HL,hp_table2
  021B  C9            	 ret
  021C                	stating_obj_hp_wp3:
  021C  21784A        	 ld HL,hp_table3
  021F  C9            	 ret
  0220                	stating_obj_hp_wp4:
  0220  217F4A        	 ld HL,hp_table4
  0223  C9            	 ret
  0224                	stating_obj_hp_wp5:
  0224  21874A        	 ld HL,hp_table5
  0227  C9            	 ret
  0228                	stating_obj_hp_wp6:
  0228  5F            	 ld E,A
  0229  1D            	 dec E
  022A  1600          	 ld D,0
  022C  19            	 add HL,DE
  022D  7E            	 ld A,(HL)
  022E  D1            	 pop DE
  022F  21CE4A        	 ld HL,obj_hp
  0232  19            	 add HL,DE
  0233  77            	 ld (HL),A
  0234  E1            	 pop HL
  0235  E67F          	 and 01111111b
                      	 ;********************************************************HP*******************************
  0237  3E38          	 ld A,00111000b
  0239  321F4C        	 ld (gil_hp),A
  023C  C9            	 ret	;gil is end of data.
                      	
                      	;****************before farse***pgil_xy set**************
                      	
  023D                	main_before:
  023D  CD9E02        	 call main_before_c
  0240  C3CD03        	 jp main
                      	
                      	
                      	;**************************************************************************
                      	;***************************init sub****************************************
                      	;**************************************************************************
                      	
  0243                	init_c:
  0243  21234C        	 ld HL,gil_matk
  0246  11244C        	 ld DE,gil_matk+1
  0249  011600        	 ld BC,22
  024C  3E00          	 ld A,0
  024E  77            	 ld (HL),A
  024F  EDB0          	 ldir
  0251  C9            	 ret
                      	 
                      	 
  0252                	Stating_before_c:
  0252  CDE60D        	 call cls
  0255  212903        	 ld HL,stating_ms1
  0258  110801        	 ld DE,0108h
  025B  0609          	 ld B,9
  025D  CDF1BF        	 call msp
  0260  213203        	 ld HL,stating_ms2
  0263  110802        	 ld De,0208h
  0266  060A          	 ld B,10
  0268  CDF1BF        	 call msp
  026B  213C03        	 ld HL,stating_msf
  026E  110804        	 ld De,0408h
  0271  0605          	 ld B,5
  0273  CDF1BF        	 call msp
  0276  2A974A        	 ld HL,(floor)
  0279  2600          	 ld H,0
  027B  CDA00D        	 call ascn
  027E  219E0D        	 ld HL,nmemry+3
  0281  110E04        	 ld DE,040eh
  0284  0602          	 ld B,2
  0286  CDF1BF        	 call msp
  0289  CD690D        	 call tim255
  028C  CDFDBC        	 call kwait
  028F  C9            	 ret
                      	 
  0290                	freecls:
  0290  21411A        	 ld HL,dammy
  0293  AF            	 xor A
  0294  77            	 ld (HL),A
  0295  11421A        	 ld DE,dammy+1
  0298  011700        	 ld BC,23
  029B  EDB0          	 ldir
  029D  C9            	 ret
                      	
  029E                	main_before_c:
  029E  2A2B4C        	 ld HL,(gil_xy)
  02A1  229C4A        	 ld (pgil_xy),HL 
  02A4  21591A        	 ld HL,obj_1
  02A7  3A974A        	 ld A,(floor)
  02AA  3D            	 dec A
  02AB  2810          	 jr z,main_before_15
  02AD  57            	 ld D,A
  02AE  AF            	 xor A
  02AF  010000        	 ld BC,0
  02B2                	main_before_1:
  02B2  EDB1          	 cpir
  02B4  15            	 dec D
  02B5  20FB          	 jr nz,main_before_1
  02B7  219E4A        	 ld HL,obj
  02BA  B7            	 or A
  02BB  ED42          	 sbc HL,BC		;it's start pointa**obj++
                      	
                      	
                      	;******************door set****************************
  02BD                	main_before_15:
  02BD  E5            	 push HL		;obj
  02BE  3E83          	 ld A,83h
  02C0  010000        	 ld BC,0
                      	;main_before_2:
  02C3  EDB1          	 cpir
  02C5  03            	 inc BC
  02C6  215E4B        	 ld HL,obj_xy
  02C9  B7            	 or A
  02CA  ED42          	 sbc HL,BC
  02CC  B7            	 or A
  02CD  ED42          	 sbc HL,BC
  02CF  5E            	 ld E,(HL)
  02D0  23            	 inc HL
  02D1  56            	 ld D,(HL)
  02D2  ED53984A      	 ld (pdoor_xy),DE
                      	
                      	;*****************key set*******************************
                      	
  02D6  E1            	 pop HL
  02D7  3E85          	 ld A,85h
  02D9  010000        	 ld BC,0
                      	;main_before_3:
  02DC  EDB1          	 cpir
  02DE  03            	 inc BC
  02DF  215E4B        	 ld HL,obj_xy
  02E2  B7            	 or A
  02E3  ED42          	 sbc HL,BC
  02E5  B7            	 or A
  02E6  ED42          	 sbc HL,BC
  02E8  5E            	 ld E,(HL)
  02E9  23            	 inc HL
  02EA  56            	 ld D,(HL)
  02EB  ED539A4A      	 ld (pkey_xy),DE
  02EF  AF            	 xor A
  02F0  323B4C        	 ld (key),A
                      	
                      	;*********************obj cross gil********************
                      	
  02F3  2A2B4C        	 ld HL,(gil_xy)
  02F6  4D            	 ld C,L
  02F7  44            	 ld B,H
  02F8  215E4B        	 ld HL,obj_xy
  02FB                	main_before_gil:
  02FB  E5            	 push HL
  02FC  5E            	 ld E,(HL)
  02FD  23            	 inc HL
  02FE  56            	 ld D,(HL)
  02FF  EB            	 ex DE,HL
  0300  B7            	 or A
  0301  ED42          	 sbc HL,BC
  0303  E1            	 pop HL
  0304  2804          	 jr z,main_before_gil_z
  0306  23            	 inc HL
  0307  23            	 inc HL
  0308  18F1          	 jr main_before_gil
  030A                	main_before_gil_z:
  030A  23            	 inc HL
  030B  23            	 inc HL
  030C  7E            	 ld A,(HL)
  030D  B7            	 or A
  030E  C28901        	 jp nz,stating_obj
                      	 
  0311  3AEE01        	 ld A,(stating_obj_6+1)
  0314  6F            	 ld L,A
  0315  3AEF01        	 ld A,(stating_obj_6+2)
  0318  67            	 ld H,A
  0319  3E15          	 ld A,21
  031B  77            	 ld (HL),A
  031C  23            	 inc HL
  031D  3E2A          	 ld A,42
  031F  77            	 ld (HL),A
  0320  22F000        	 ld (0f0h),HL
  0323  C9            	 ret
                      	 
                      	 
  0324                	nextck:
  0324  AF            	 xor A
  0325  323B4C        	 ld (key),A
  0328  C9            	 ret
                      	
                      	 
                      	 
  0329                	stating_ms1:
  0329  47455420524541	 db "GET READY"
  0332                	stating_ms2:
  0332  504C4159455220	 db "PLAYER ONE"
  033C                	stating_msf:
  033C  464C4F4F52    	 db "FLOOR"
  0341                	continue_ms:
  0341  53454C45435420	 db "SELECT START FLOOR"
  0353                	wall_grp:
  0353  FFFFFF        	 db 0ffh,0ffh,0ffh
  0356                	pole_grp:
  0356  01            	 db 1h
                      	 
                      	 
                      	;*************************************************************************************
                      	;********************************recover**********************************************
  0357                	stating_rec:
  0357  CD5202        	 call Stating_before_c
  035A  CD7410        	 call map_make
  035D  CD9002        	 call freecls
  0360  AF            	 xor A
  0361  323B4C        	 ld (key),A
  0364  ED5B9C4A      	 ld DE,(pgil_xy)
  0368  ED532B4C      	 ld (gil_xy),DE
  036C                	stating_rec1:
  036C  DD21CE4A      	 ld IX,obj_hp
  0370  215E4B        	 ld HL,obj_xy
  0373                	stating_rec2:
  0373  DD7ED0        	 ld A,(IX-48)
  0376  FE8F          	 cp 8fh
  0378  CABB03        	 jp z,stating_rec3
  037B  CD250F        	 call cross_ck_a
  037E  DA8703        	 jp c,obj_of
  0381  23            	 inc HL
  0382  23            	 inc HL
  0383  DD23          	 inc IX
  0385  18EC          	 jr  stating_rec2
                      	 
  0387                	obj_of:
  0387  E5            	 push HL
  0388  110700        	 ld DE,7
  038B  210000        	 ld HL,0
  038E  CD790D        	 call rand
  0391  E60E          	 and 0eh
  0393  CD940D        	 call xsan
  0396  111E00        	 ld DE,30
  0399  19            	 add HL,DE
  039A  7D            	 ld A,L
  039B  E1            	 pop HL
  039C  77            	 ld (HL),A
  039D  E5            	 push HL
  039E  110700        	 ld DE,7
  03A1  210000        	 ld HL,0
  03A4  ED5F          	 ld A,R
  03A6  E606          	 and 06
  03A8  CD940D        	 call xsan
  03AB  7D            	 ld A,L
  03AC  E1            	 pop HL
  03AD  23            	 inc HL
  03AE  77            	 ld (HL),A
  03AF  2B            	 dec HL
  03B0  AF            	 xor A
  03B1  DD7730        	 ld (IX+48),A
  03B4  AF            	 xor A
  03B5  DD7760        	 ld (IX+96),A
  03B8  C36C03        	 jp stating_rec1
                      	 
  03BB                	stating_rec3:
  03BB  3E01          	 ld A,1
  03BD  DD77FF        	 ld (IX-1),A
  03C0  DD77FE        	 ld (IX-2),A
  03C3  DD77FD        	 ld (IX-3),A
  03C6  AF            	 xor A
  03C7  DD772E        	 ld (IX+46),A
  03CA  C3CD03        	 jp main
                      	 
                      	 
                      	;**************************************************************************************
                      	;************************************Main*********************************************
                      	;**************************************************************************************
  03CD                	main:
  03CD  CD1A0E        	 call grp_o
                      	; call tim30
  03D0  3E30          	 ld A,48
  03D2  32E103        	 ld (count+1),A
  03D5  215E4B        	 ld HL,obj_xy
  03D8  DD21CE4A      	 ld IX,obj_hp
  03DC  FD21BE4B      	 ld IY,obj_st2
  03E0                	mains:
                      	
  03E0                	count:
  03E0  3E00          	 ld A,overwrite
  03E2  B7            	 or A
  03E3  CACD03        	 jp z,main
                      	;unknown_ID_throght(0)
  03E6  DD7ED0        	 ld A,(IX-48)
  03E9  B7            	 or A
  03EA  CA450D        	 jp z,mains_end
                      	;count out then main
                      	
                      	;graph_delete
                      	
  03ED  E5            	 push HL		;>
  03EE  5E            	 ld E,(HL)
  03EF  23            	 inc HL
  03F0  56            	 ld D,(HL)
  03F1  CDEC12        	 call grp_del
  03F4  E1            	 pop HL		;<
                      	;hp_zero_throght
                      	
  03F5  DD7E00        	 ld A,(IX)
  03F8  B7            	 or A
  03F9  CA450D        	 jp z,mains_end
                      	
                      	
                      	
                      	
                      	;******************************ivent action **********************
                      	 
  03FC  DD7ED0        	 ld A,(IX-48)
  03FF  47            	 ld B,A
  0400  E6E0          	 and 0e0h
  0402  C28204        	 jp nz,st_action
  0405  78            	 ld A,B
  0406  FE0A          	 cp 0ah
  0408  CA8707        	 jp z,spells_action
  040B  FE0B          	 cp 0bh
  040D  CA8707        	 jp z,spells_action
                      	
                      	;wp
  0410  DD7E30        	 ld A,(IX+48)
  0413  B7            	 or A
                      	
                      	;wp=0
  0414  CA2604        	 jp z,st_check
                      	
                      	
                      	
                      	;wp>0
  0417  3D            	 dec A
  0418  DD7730        	 ld (IX+48),A
  041B  DD7ED0        	 ld A,(IX-48);(Syubetsu)
  041E  CB67          	 bit 4,A
  0420  CA4005        	 jp z,sraim_move3_e;(suraimuGPRINT)
  0423  C3DA05        	 jp wizard_move_e_wpp
                      	; jp wizard_act_e
                      	; jp nz,mains_end
                      	; jp st_check
  0426                	st_check:
  0426  DD7E60        	 ld A,(IX+96)
  0429  B7            	 or A
  042A  C27B04        	 jp nz,st_dec
                      	
                      	;wp=0,st=0
                      	;wp setting((di)=move lutin)
                      	
  042D  DD7ED0        	 ld A,(IX-48);(Syurui)
  0430  CB67          	 bit 4,A
  0432  2808          	 jr z,wp_str_b
  0434  ED5F          	 ld A,R;		(wizard)
  0436  E61F          	 and 00011111b
  0438  CBEF          	 set 5,A
  043A  182A          	 jr wp_str
  043C                	wp_str_b:
  043C  F5            	 push AF
  043D  ED5F          	 ld A,R
  043F  E67F          	 and 7fh
  0441  47            	 ld B,A
  0442  ED5F          	 ld A,R
  0444  E67F          	 and 7fh
  0446  80            	 add A,B
  0447  47            	 ld B,A
  0448  F1            	 pop AF
  0449  FE02          	 cp 2
  044B  3816          	 jr c,wp_G
  044D  280F          	 jr z,wp_B
  044F  FE04          	 cp 4
  0451  78            	 ld A,B
  0452  3806          	 jr c,wp_R
  0454  2804          	 jr z,wp_BL
  0456                	wp_D:
  0456                	wp_DY:
  0456  E608          	 and 8
  0458  180C          	 jr wp_str
  045A                	wp_BL:
  045A                	wp_R:
  045A  E610          	 and 16
  045C  1808          	 jr wp_str
  045E                	wp_B:
  045E  78            	 ld A,B
  045F  E608          	 and 8
  0461  1803          	 jr wp_str
  0463                	wp_G:
  0463  78            	 ld A,B
  0464  E610          	 and 16
  0466                	wp_str:
  0466  C608          	 add A,8
  0468  DD7730        	 ld (IX+48),A
  046B  3E19          	 ld A,25
  046D  DD7760        	 ld (IX+96),A
                      	
  0470  DD7ED0        	 ld A,(IX-48);(Syubetsu)
  0473  CB67          	 bit 4,A
  0475  CA4005        	 jp z,sraim_move3_e;(suraimuGPRINT)
  0478  C3DA05        	 jp wizard_move_e_wpp;(wizard not print)mains_end
                      	; jp Egraph;
                      	
                      	
                      	
                      	;wp=0,st=x
  047B                	st_dec:
  047B  3D            	 dec A
  047C  DD7760        	 ld (IX+96),A
  047F  C3C904        	 jp sraim_or_wiz_action
                      	 
                      	 
                      	;***********************************knight,quox,ivent*********************************
  0482                	st_action:;Individual action
                      	; call bls
  0482  DD7ED0        	 ld A,(IX-48)
  0485  FE45          	 cp 45h
  0487  CA5A06        	 jp z,goast_action
  048A  FE46          	 cp 46h
  048C  CA5A06        	 jp z,goast_action
  048F  CB6F          	 bit 5,A
  0491  C28708        	 jp nz,knight_action
  0494  FE83          	 cp 83h
  0496  CA500B        	 jp z,door_action
  0499  FE84          	 cp 84h
  049B  CACD0A        	 jp z,box_action
  049E  FE85          	 cp 85h
  04A0  CAAD0A        	 jp z,key_action
  04A3  FE8F          	 cp 8fh
  04A5  CAAB0B        	 jp z,gil_action
  04A8  C3450D        	 jp mains_end
                      	
  04AB  32F000        	 ld (0f0h),A
  04AE  DD7ED0        	 ld A,(IX-48)
  04B1  32F400        	 ld (0f4h),A
  04B4  DD7E00        	 ld A,(IX-0)
  04B7  32F500        	 ld (0f5h),A
  04BA  DD7E30        	 ld A,(IX+48)
  04BD  32F600        	 ld (0f6h),A
  04C0  DD7E60        	 ld A,(IX+96)
  04C3  32F700        	 ld (0f7h),A
  04C6  C35D0D        	 jp retP
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	;****************************************************************************
                      	;*********************************sraim or wiz*******************************
                      	
  04C9                	sraim_or_wiz_action:;HL=obj_xy++
  04C9  DDCBD066      	 bit 4,(IX-48);(NO.)
  04CD  C27505        	 jp nz,wiz_action
                      	
                      	 ;;;;
                      	 ;;;;
  04D0  DD7E60        	 ld A,(IX+96);(st)
                      	 
                      	; ld (0f0h),A
                      	; jp retP
                      	
  04D3  FE09          	 cp 9
  04D5  280B          	 jr z,sraim_move1_B
  04D7  FE05          	 cp 5
  04D9  2823          	 jr z,sraim_move1
  04DB  FE01          	 cp 1
  04DD  283F          	 jr z,sraim_move3
  04DF  C34005        	 jp sraim_move3_e;mains_end
                      	
                      	
  04E2                	sraim_move1_B:
  04E2  CD5A0F        	 call wall_ck
  04E5  2817          	 jr z,sraim_move1
  04E7  23            	 inc HL
  04E8  CBBE          	 res 7,(HL)
  04EA  CBB6          	 res 6,(HL)
  04EC  ED5F          	 ld A,R
                      	; rla
  04EE  1F            	 rra
  04EF  1F            	 rra
  04F0  1F            	 rra
  04F1  E6C0          	 and 0c0h
  04F3  B6            	 or (HL)
  04F4  77            	 ld (HL),A
  04F5  2B            	 dec HL
  04F6  3E50          	 ld A,80
  04F8  DD7760        	 ld (IX+96),A
  04FB  C34005        	 jp sraim_move3_e
  04FE                	sraim_move1:
                      	;graph_delete
                      	
                      	; push HL		;>
                      	; call bls
                      	; ld E,(HL)
                      	; inc HL
                      	; ld D,(HL)
                      	; call grp_del
                      	; pop HL		;<
                      	
                      	
  04FE  23            	 inc HL
  04FF  7E            	 ld A,(HL)
  0500  E6C0          	 and 0c0h
  0502  280B          	 jr z,sraim_move1_u
  0504  FE80          	 cp 80h
  0506  380C          	 jr c,sraim_move1_r
  0508  280F          	 jr z,sraim_move1_d
  050A                	sraim_move1_l:
  050A  2B            	 dec HL
  050B  35            	 dec (HL)
  050C  35            	 dec (HL)
  050D  1831          	 jr sraim_move3_e
  050F                	sraim_move1_u:
  050F  35            	 dec (HL)
  0510  35            	 dec (HL)
  0511  2B            	 dec HL
  0512  182C          	 jr sraim_move3_e
  0514                	sraim_move1_r:
  0514  2B            	 dec HL
  0515  34            	 inc (HL)
  0516  34            	 inc (HL)
  0517  1827          	 jr sraim_move3_e
  0519                	sraim_move1_d:
  0519  34            	 inc (HL)
  051A  34            	 inc (HL)
  051B  2B            	 dec HL
                      	
  051C  1822          	 jr sraim_move3_e
                      	
                      	
  051E                	sraim_move3:
                      	
  051E  23            	 inc HL
  051F  7E            	 ld A,(HL)
  0520  E6C0          	 and 0c0h
  0522  280C          	 jr z,sraim_move3_u
  0524  FE80          	 cp 80h
  0526  380E          	 jr c,sraim_move3_r
  0528  2812          	 jr z,sraim_move3_d
  052A                	sraim_move3_l:
  052A  2B            	 dec HL
  052B  35            	 dec (HL)
  052C  35            	 dec (HL)
  052D  35            	 dec (HL)
  052E  1810          	 jr sraim_move3_e
  0530                	sraim_move3_u:
  0530  35            	 dec (HL)
  0531  35            	 dec (HL)
  0532  35            	 dec (HL)
  0533  2B            	 dec HL
  0534  180A          	 jr sraim_move3_e
  0536                	sraim_move3_r:
  0536  2B            	 dec HL
  0537  34            	 inc (HL)
  0538  34            	 inc (HL)
  0539  34            	 inc (HL)
  053A  1804          	 jr sraim_move3_e
  053C                	sraim_move3_d:
  053C  34            	 inc (HL)
  053D  34            	 inc (HL)
  053E  34            	 inc (HL)
  053F  2B            	 dec HL
  0540                	sraim_move3_e:
  0540  119919        	 ld DE,graph_sraimd
  0543                	Egraph:;(DE=)
  0543  ED534C05      	 ld (Egraph_put+1),DE
  0547  E5            	 push HL		;>
  0548  5E            	 ld E,(HL)
  0549  23            	 inc HL
  054A  56            	 ld D,(HL)
  054B                	Egraph_put:
  054B  210000        	 ld HL,overwrite
  054E  CD6012        	 call grp_set
  0551  E1            	 pop HL			;<
  0552  DD7ED0        	 ld A,(IX-48)
  0555  E6F8          	 and 11111000b
  0557  CA5B05        	 jp z,sraim_cross_ck;
  055A  C9            	 ret
                      	 
  055B                	sraim_cross_ck:
  055B  3A224C        	 ld A,(gil_st2)
  055E  CB7F          	 bit 7,A		;(gil sworud MIRU)
  0560  2808          	 jr z,s1
  0562  CD250F        	 call cross_ck_a;s
  0565  DC470F        	 call c,cha_kill;(suraim HP=0)
  0568  1808          	 jr s2
  056A                	s1:;(gil_st=0-x)
  056A  CD250F        	 call cross_ck_a
  056D  3003          	 jr nc,s2
  056F  C3290D        	 jp gil_killing
                      	 
  0572                	s2:
                      	; jp c,retP
  0572  C3450D        	 jp mains_end
                      	
                      	
                      	;******************wiz actions**Main***********************
  0575                	wiz_action:
  0575  DD7E60        	 ld A,(IX+96)
  0578  FE18          	 cp 24
  057A  CAA605        	 jp z,wiz_ap
  057D  FE0C          	 cp 12
  057F  CAC805        	 jp z,wiz_sp
  0582  FD7E00        	 ld A,(IY)
  0585  B7            	 or A
  0586  C2CE05        	 jp nz,wiz_dec
  0589                	wiz_dec2:
  0589  11B119        	 ld DE,magic
  058C  CD4305        	 call Egraph
                      	;********************cross chack wiz*******************
  058F                	wizard_cross_ck;
  058F  3A224C        	 ld A,(gil_st2)
  0592  CB7F          	 bit 7,A		;(gil sworud MIRU)
  0594  2808          	 jr z,ss1
  0596  CD250F        	 call cross_ck_a;s
  0599  DC470F        	 call c,cha_kill;(suraim HP=0)
  059C  1805          	 jr ss2
  059E                	ss1:;(gil_st=0-x)
  059E  CD250F        	 call cross_ck_a
  05A1  3000          	 jr nc,wizard_end
                      	; jp gil_killing
  05A3                	ss2:
  05A3                	wizard_end:
                      	;********************wiz end***************************
  05A3  C3450D        	 jp mains_end
                      	
  05A6                	wiz_ap:
                      	
  05A6                	gil_notaction_f:
  05A6  3A1E4C        	 ld A,(gil_button)
  05A9  DD3430        	 inc (IX+48)
  05AC  DD3460        	 inc (IX+96)
  05AF  E6C3          	 and 11000011b
  05B1  CAA305        	 jp z,wizard_end
  05B4  DD3530        	 dec (IX+48)
  05B7  DD3560        	 dec (IX+96)
                      	 
  05BA  DD7E60        	 ld A,(IX+96)
  05BD  3E0A          	 ld A,10
  05BF  FD7700        	 ld (IY),A
  05C2  CDDD05        	 call wiz_locate
  05C5  C38905        	 jp wiz_dec2
  05C8                	wiz_sp:
  05C8  CD4107        	 call spell_create
  05CB  C38905        	 jp wiz_dec2
  05CE                	wiz_dec:
  05CE  DD3460        	 inc (IX+96)
  05D1  FD3500        	 dec (IY)
  05D4  FD7E00        	 ld A,(IY)
  05D7  C38905        	 jp wiz_dec2
                      	
                      	;***********************wp>0 then noting*********************
  05DA                	wizard_move_e_wpp;wp>0
  05DA  C3450D        	 jp mains_end
                      	
                      	;***********************wiz_locate**************************
  05DD                	wiz_locate:
                      	
  05DD  E5            	 push HL	;>
  05DE  212B4C        	 ld HL,gil_xy
  05E1  5E            	 ld E,(HL);x
  05E2  23            	 inc HL
  05E3  56            	 ld D,(HL);y
                      	
                      	; ld A,E
                      	; ld (0f0h),A
                      	; ld A,D
                      	; ld (0f1h),A
                      	 
  05E4  E1            	 pop HL		;<
  05E5  ED5F          	 ld A,R
  05E7  4F            	 ld C,A
  05E8  ED5F          	 ld A,R
  05EA  E603          	 and 00000011b
  05EC  B7            	 or A
  05ED  CA0B06        	 jp z,wiz_locate_left
  05F0  FE02          	 cp 2
  05F2  DA2206        	 jp c,wiz_locate_down
  05F5  CA3606        	 jp z,wiz_locate_right
  05F8                	wiz_locate_up:
  05F8  7A            	 ld A,D
  05F9  E63F          	 and 00111111b
  05FB  D60E          	 sub 14
  05FD  38DE          	 jr c,wiz_locate
  05FF  F680          	 or 10000000b
  0601  57            	 ld D,A
                      	 
  0602  7B            	 ld A,E
  0603  77            	 ld (HL),A
  0604  23            	 inc HL
  0605  7A            	 ld A,D
  0606  77            	 ld (HL),A
  0607  2B            	 dec HL
                      	 
  0608  C34E06        	 jp wiz_locate_end
  060B                	wiz_locate_left;
  060B  7B            	 ld A,E
  060C  D60E          	 sub 14
  060E  FE1E          	 cp 30
  0610  38CB          	 jr c,wiz_locate
  0612  5F            	 ld E,A
                      	 
  0613  7A            	 ld A,D
  0614  E63F          	 and 00111111b
  0616  F640          	 or 01000000b
  0618  57            	 ld D,A
                      	 
  0619  7B            	 ld A,E
  061A  77            	 ld (HL),A
  061B  23            	 inc HL
  061C  7A            	 ld A,D
  061D  77            	 ld (HL),A
  061E  2B            	 dec HL
                      	 
  061F  C34E06        	 jp wiz_locate_end
  0622                	wiz_locate_down;
  0622  7A            	 ld A,D
  0623  E63F          	 and 00111111b
  0625  7A            	 ld A,D
  0626  C60E          	 add A,14
  0628  FE30          	 cp 47+1
  062A  30B1          	 jr nc,wiz_locate
  062C  57            	 ld D,A
                      	 
  062D  7B            	 ld A,E
  062E  77            	 ld (HL),A
  062F  23            	 inc HL
  0630  7A            	 ld A,D
  0631  77            	 ld (HL),A
  0632  2B            	 dec HL
                      	 
  0633  C34E06        	 jp wiz_locate_end
  0636                	wiz_locate_right;
  0636  7B            	 ld A,E
  0637  C60E          	 add A,14
  0639  FE88          	 cp 135+1
  063B  D2DD05        	 jp nc,wiz_locate
  063E  5F            	 ld E,A
                      	 
  063F  7A            	 ld A,D
  0640  E63F          	 and 00111111b
  0642  F6C0          	 or 11000000b
  0644  57            	 ld D,A
                      	 
  0645  7B            	 ld A,E
  0646  77            	 ld (HL),A
  0647  23            	 inc HL
  0648  7A            	 ld A,D
  0649  77            	 ld (HL),A
  064A  2B            	 dec HL
                      	 
  064B  C34E06        	 jp wiz_locate_end
                      	 
                      	;
  064E                	wiz_locate_end:
  064E  CDED0F        	 call wall_mod
  0651  7E            	 ld A,(HL)
  0652  91            	 sub C
  0653  77            	 ld (HL),A 
  0654  23            	 inc HL		;>
  0655  7E            	 ld A,(HL)
  0656  90            	 sub B
  0657  77            	 ld (HL),A
  0658  2B            	 dec HL		;<
  0659  C9            	 ret
                      	 
                      	;******************************goast action***************************
  065A                	goast_action:
  065A  DD7E60        	 ld A,(IX+96)
  065D  47            	 ld B,A
  065E  DD7E00        	 ld A,(IX)
  0661  B8            	 cp B
  0662  3803          	 jr c,goast_action_b
  0664  DD7760        	 ld (IX+96),A
  0667                	goast_action_b:
  0667  DD7E30        	 ld A,(IX+48)
  066A  B7            	 or A
  066B  CA7806        	 jp z,goast_action_a
  066E  3D            	 dec A
  066F  DD7730        	 ld (IX+48),A
  0672  CA1507        	 jp z,goast_warp_ap
  0675  C3E506        	 jp goast_end
  0678                	goast_action_a:
  0678  CDED0F        	 call wall_mod
  067B  79            	 ld A,C
  067C  B7            	 or A
  067D  C2E206        	 jp nz,goast_move
  0680  78            	 ld A,B
  0681  B7            	 or A
  0682  C2E206        	 jp nz,goast_move 
                      	 
  0685                	goast_action_0:
  0685  CD8E0D        	 call rand4
  0688  FE80          	 cp 80h
  068A  3803          	 jr c,goast_action_1
  068C  CD4107        	 call spell_create
  068F                	goast_action_1:
  068F  CD3A0A        	 call xyload
  0692  3A2B4C        	 ld A,(gil_xy)
  0695  93            	 sub E
  0696  3004          	 jr nc,goast_cp1
  0698  2812          	 jr z,goast_y
  069A  ED44          	 neg
  069C                	goast_cp1:
  069C  4F            	 ld C,A
  069D  3A2C4C        	 ld A,(gil_xy+1)
  06A0  E63F          	 and 00111111b
  06A2  92            	 sub D
  06A3  3004          	 jr nc,goast_cp2
  06A5  280C          	 jr z,goast_x
  06A7  ED44          	 neg
  06A9                	goast_cp2:
  06A9  B9            	 cp C
  06AA  3807          	 jr c,goast_x 
  06AC                	goast_y:
  06AC  CD2D0A        	 call y_ck
  06AF  3819          	 jr c,goast_up
  06B1  181F          	 jr goast_do
  06B3                	goast_x:
  06B3  CD250A        	 call x_ck
  06B6  3802          	 jr c,goast_le
  06B8  1808          	 jr goast_ri
  06BA                	goast_le:
  06BA  23            	 inc HL
  06BB  CBFE          	 set 7,(HL)
  06BD  CBF6          	 set 6,(HL)
  06BF  2B            	 dec HL
  06C0  1818          	 jr goast_wc
  06C2                	goast_ri:
  06C2  23            	 inc HL
  06C3  CBBE          	 res 7,(HL)
  06C5  CBF6          	 set 6,(HL)
  06C7  2B            	 dec HL
  06C8  1810          	 jr goast_wc
  06CA                	goast_up:
  06CA  23            	 inc HL
  06CB  CBBE          	 res 7,(HL)
  06CD  CBB6          	 res 6,(HL)
  06CF  2B            	 dec HL
  06D0  1808          	 jr goast_wc
  06D2                	goast_do:
  06D2  23            	 inc HL
  06D3  CBFE          	 set 7,(HL)
  06D5  CBB6          	 res 6,(HL)
  06D7  2B            	 dec HL
  06D8  1800          	 jr goast_wc
  06DA                	goast_wc:
  06DA  CD5A0F        	 call wall_ck
  06DD  2803          	 jr z,goast_move
  06DF  C30D07        	 jp goast_warp
  06E2                	goast_move:
  06E2  CD3C09        	 call empty_move
  06E5                	goast_end:
                      	 
                      	;*****************************cross ck goast*****************************
  06E5  3A224C        	 ld A,(gil_st2)
  06E8  B7            	 or A
  06E9  2811          	 jr z,sssss1
  06EB  CB7F          	 bit 7,A
  06ED  2808          	 jr z,sssss0
  06EF  CD250F        	 call cross_ck_a;s
  06F2  DC780A        	 call c,HP_decB;
  06F5  280D          	 jr z,sssss2
  06F7                	sssss0:
  06F7  CD250F        	 call cross_ck_a;
  06FA  1808          	 jr sssss2
  06FC                	sssss1:;(gil_st=0-x)
  06FC  CD250F        	 call cross_ck_a
  06FF  3003          	 jr nc,sssss2
  0701  C3290D        	 jp gil_killing
  0704                	sssss2:
                      	 
  0704  11C919        	 ld DE,graph_goast
  0707  CD4305        	 call Egraph
  070A  C3450D        	 jp mains_end
                      	 
                      	;****************************goast sub*********************************** 
  070D                	goast_warp:
  070D  3E12          	 ld A,18
  070F  DD7730        	 ld (IX+48),A
  0712  C3E506        	 jp goast_end
                      	 
  0715                	goast_warp_ap:
  0715  23            	 inc HL
  0716  7E            	 ld A,(HL)
  0717  2B            	 dec HL
  0718  E6C0          	 and 11000000b
  071A  280C          	 jr z,goast_warp_ap_u
  071C  FE80          	 cp 80h
  071E  3810          	 jr c,goast_warp_ap_r
  0720  2814          	 jr z,goast_warp_ap_d
  0722                	goast_warp_ap_l:
  0722  7E            	 ld A,(HL)
  0723  D607          	 sub 7
  0725  77            	 ld (HL),A
  0726  1816          	 jr goast_warp_ap_e
  0728                	goast_warp_ap_u:
  0728  23            	 inc HL
  0729  7E            	 ld A,(HL)
  072A  D607          	 sub 7
  072C  77            	 ld (HL),A
  072D  2B            	 dec HL
  072E  180E          	 jr goast_warp_ap_e
  0730                	goast_warp_ap_r:
  0730  7E            	 ld A,(HL)
  0731  C607          	 add A,7
  0733  77            	 ld (HL),A
  0734  1808          	 jr goast_warp_ap_e
  0736                	goast_warp_ap_d:
  0736  23            	 inc HL
  0737  7E            	 ld A,(HL)
  0738  C607          	 add A,7
  073A  77            	 ld (HL),A
  073B  2B            	 dec HL
  073C  1800          	 jr goast_warp_ap_e
  073E                	goast_warp_ap_e:
  073E  C3E506        	 jp goast_end
                      	 
                      	;******************************spell create*************************** 
                      	;******************************spell create*************************** 
  0741                	spell_create:
  0741  E5            	 push HL
  0742  AF            	 xor A
  0743  219E4A        	 ld HL,obj
  0746  AF            	 xor A
  0747  010000        	 ld BC,0
  074A  EDB1          	 cpir		;BC<0
  074C  03            	 inc BC
                      	 
                      	 
                      	; ld (HL),0	;chr clr
  074D  2B            	 dec HL		;spell address
  074E  DD7ED0        	 ld A,(IX-48)
  0751  FE13          	 cp 13h
  0753  2808          	 jr z,spellB
  0755  FE46          	 cp 46h
  0757  2804          	 jr z,spellB
  0759  360A          	 ld (HL),0Ah
  075B  1802          	 jr spellsetok
  075D                	spellB:
  075D  360B          	 ld (HL),0Bh
  075F                	spellsetok:
                      			;hp
  075F  113000        	 ld DE,48
  0762  19            	 add HL,DE
  0763  3601          	 ld (HL),1
                      	 		;st2
  0765  11F000        	 ld DE,48*5
  0768  19            	 add HL,DE
  0769  3600          	 ld (HL),0
                      	 
  076B  E1            	 pop HL
                      	 
                      	; ld (0f4h),HL
                      	
  076C  7E            	 ld A,(HL)
  076D  5F            	 ld E,A
  076E  23            	 inc HL
  076F  7E            	 ld A,(HL)
  0770  57            	 ld D,A
  0771  2B            	 dec HL
                      	 
  0772  E5            	 push HL
  0773  210000        	 ld HL,0
  0776  B7            	 or A
  0777  ED42          	 sbc HL,BC;xy_countor
  0779  B7            	 or A
  077A  ED42          	 sbc HL,BC
  077C  015E4B        	 ld BC,obj_xy
  077F  09            	 add HL,BC
                      	 
                      	 
  0780  7B            	 ld A,E
  0781  77            	 ld (HL),A
  0782  23            	 inc HL
  0783  7A            	 ld A,D
  0784  77            	 ld (HL),A
                      	 
                      	; ld (0f0h),HL
                      	; ld (0f2h),BC
                      	 
                      	 
  0785  E1            	 pop HL
  0786  C9            	 ret
                      	;******************************spell action****************************
  0787                	spells_action:
  0787  FD7E00        	 ld A,(IY)
  078A  FE01          	 cp 1
  078C  CAD007        	 jp z,spells_action1
  078F  FE02          	 cp 2
  0791  CAF907        	 jp z,spells_action2
                      	
  0794  CDED0F        	 call wall_mod
  0797  78            	 ld A,B
  0798  B7            	 or A
  0799  C27408        	 jp nz,spells_action_delete
  079C  79            	 ld A,C
  079D  B7            	 or A
  079E  C27408        	 jp nz,spells_action_delete
                      	 
  07A1  CD5A0F        	 call wall_ck
  07A4  C22608        	 jp nz,spells_action_dol
  07A7                	spells_action_wiz:
  07A7  23            	 inc HL
  07A8  7E            	 ld A,(HL)
  07A9  2B            	 dec HL
  07AA  E6C0          	 and 11000000b
  07AC  280A          	 jr z,spells_action_u
  07AE  FE80          	 cp 80h
  07B0  380C          	 jr c,spells_action_r
  07B2  280E          	 jr z,spells_action_d
  07B4                	spells_action_l:
  07B4  35            	 dec (HL)
  07B5  35            	 dec (HL)
  07B6  1810          	 jr spells_action_urdl
  07B8                	spells_action_u:
  07B8  23            	 inc HL
  07B9  35            	 dec (HL)
  07BA  35            	 dec (HL)
  07BB  2B            	 dec HL
  07BC  180A          	 jr spells_action_urdl
  07BE                	spells_action_r:
  07BE  34            	 inc (HL)
  07BF  34            	 inc (HL)
  07C0  1806          	 jr spells_action_urdl
  07C2                	spells_action_d:
  07C2  23            	 inc HL
  07C3  34            	 inc (HL)
  07C4  34            	 inc (HL)
  07C5  2B            	 dec HL
  07C6  1800          	 jr spells_action_urdl
  07C8                	spells_action_urdl:
  07C8  3E01          	 ld A,1
  07CA  FD7700        	 ld (IY),A
  07CD  C33308        	 jp spells_actionend
                      	 
                      	 
                      	 
  07D0                	spells_action1:
  07D0  23            	 inc HL
  07D1  7E            	 ld A,(HL)
  07D2  2B            	 dec HL
  07D3  E6C0          	 and 11000000b
  07D5  280A          	 jr z,spells_action1_u
  07D7  FE80          	 cp 80h
  07D9  380C          	 jr c,spells_action1_r
  07DB  280E          	 jr z,spells_action1_d
  07DD                	spells_action1_l:
  07DD  35            	 dec (HL)
  07DE  35            	 dec (HL)
  07DF  1810          	 jr spells_action1_urdl
  07E1                	spells_action1_u:
  07E1  23            	 inc HL
  07E2  35            	 dec (HL)
  07E3  35            	 dec (HL)
  07E4  2B            	 dec HL
  07E5  180A          	 jr spells_action1_urdl
  07E7                	spells_action1_r:
  07E7  34            	 inc (HL)
  07E8  34            	 inc (HL)
  07E9  1806          	 jr spells_action1_urdl
  07EB                	spells_action1_d:
  07EB  23            	 inc HL
  07EC  34            	 inc (HL)
  07ED  34            	 inc (HL)
  07EE  2B            	 dec HL
  07EF  1800          	 jr spells_action1_urdl
  07F1                	spells_action1_urdl:
  07F1  3E02          	 ld A,2
  07F3  FD7700        	 ld (IY),A
  07F6  C33308        	 jp spells_actionend
                      	 
                      	 
                      	
  07F9                	spells_action2:
  07F9  23            	 inc HL
  07FA  7E            	 ld A,(HL)
  07FB  2B            	 dec HL
  07FC  E6C0          	 and 11000000b
  07FE  280B          	 jr z,spells_action2_u
  0800  FE80          	 cp 80h
  0802  380E          	 jr c,spells_action2_r
  0804  2811          	 jr z,spells_action2_d
  0806                	spells_action2_l:
  0806  35            	 dec (HL)
  0807  35            	 dec (HL)
  0808  35            	 dec (HL)
  0809  1813          	 jr spells_action2_urdl
  080B                	spells_action2_u:
  080B  23            	 inc HL
  080C  35            	 dec (HL)
  080D  35            	 dec (HL)
  080E  35            	 dec (HL)
  080F  2B            	 dec HL
  0810  180C          	 jr spells_action2_urdl
  0812                	spells_action2_r:
  0812  34            	 inc (HL)
  0813  34            	 inc (HL)
  0814  34            	 inc (HL)
  0815  1807          	 jr spells_action2_urdl
  0817                	spells_action2_d:
  0817  23            	 inc HL
  0818  34            	 inc (HL)
  0819  34            	 inc (HL)
  081A  34            	 inc (HL)
  081B  2B            	 dec HL
  081C  1800          	 jr spells_action2_urdl
  081E                	spells_action2_urdl:
  081E  3E00          	 ld A,0
  0820  FD7700        	 ld (IY),A
  0823  C33308        	 jp spells_actionend
  0826                	spells_action_dol:
  0826  DD7ED0        	 ld A,(IX-48)
  0829  FE0B          	 cp 0bh
  082B  E5            	 push HL
  082C  CC1C10        	 call z,matk_action
  082F  E1            	 pop HL
  0830  C37408        	 jp spells_action_delete
                      	 
  0833                	spells_actionend:
  0833                	spells_action_cross
                      	 
                      	
                      	;********************cross chack spell*******************
  0833                	spell_cross_ck;
  0833  CD250F        	 call cross_ck_a;s
  0836  3033          	 jr nc,spell_cross_ck_end
  0838                	spell_cross_ck_1:
                      	
  0838  3A2C4C        	 ld A,(gil_xy+1)
  083B  E6C0          	 and 11000000b
  083D  17            	 rla
  083E  17            	 rla
  083F  17            	 rla
  0840  47            	 ld B,A
  0841  23            	 inc HL
  0842  7E            	 ld A,(HL)
  0843  2B            	 dec HL
  0844  E6C0          	 and 11000000b
  0846  17            	 rla
  0847  17            	 rla
  0848  17            	 rla
  0849  3C            	 inc A
  084A  3C            	 inc A
  084B  E603          	 and 00000011b
  084D  4F            	 ld C,A
  084E  C5            	 push BC
                      	
  084F  3A224C        	 ld A,(gil_st2)
  0852  CB7F          	 bit 7,A		;(gil sworud MIRU)
  0854  2009          	 jr nz,spell_cross_ck_s
  0856                	spell_cross_ck_n:
  0856  C1            	 pop BC
  0857  79            	 ld A,C
  0858  A8            	 xor B				;urdl = turdl
  0859  CA7408        	 jp z,spells_action_delete
  085C  C3290D        	 jp gil_killing
  085F                	spell_cross_ck_s:
  085F  C1            	 pop BC
  0860  79            	 ld A,C
  0861  3C            	 inc A
  0862  E603          	 and 00000011b
  0864  A8            	 xor B				;urdl = turdl
  0865  CA7408        	 jp z,spells_action_delete
  0868  C3290D        	 jp gil_killing
  086B                	spell_cross_ck_end:
  086B  11E119        	 ld DE,graph_spell
  086E  CD4305        	 call Egraph;call Egraph
  0871  C3450D        	 jp mains_end
                      	 
  0874                	spells_action_delete:
  0874  AF            	 xor A
  0875  DD77D0        	 ld (IX-48),A
  0878  DD7700        	 ld (IX),A
  087B  FD7700        	 ld (IY),A
  087E  3600          	 ld (HL),0
  0880  23            	 inc HL
  0881  3600          	 ld (HL),0
  0883  2B            	 dec HL
  0884  C3450D        	 jp mains_end
                      	 
                      	 
                      	
                      	 
                      	;***************************************************************
                      	;**************************knight action************************
  0887                	knight_action:;HL=obj_xy++
                      	;******************ricaba*******************
  0887  DD7E60        	 ld A,(IX+96)
  088A  47            	 ld B,A
  088B  DD7E00        	 ld A,(IX)
  088E  B8            	 cp B
  088F  3803          	 jr c,knight_actiona
  0891  DD7760        	 ld (IX+96),A
  0894                	knight_actiona:
  0894  DD7ED0        	 ld A,(IX-48)
  0897  FE23          	 cp 23h
  0899  2807          	 jr z,knight_action1
  089B  DD7E30        	 ld A,(IX+48)
  089E  B7            	 or A
  089F  CA5509        	 jp z,knight_action_end
                      	
  08A2                	knight_action1:
  08A2  CDED0F        	 call wall_mod
  08A5  78            	 ld A,B
  08A6  B7            	 or A
  08A7  C23809        	 jp nz,knight_move
  08AA  79            	 ld A,C
  08AB  B7            	 or A
  08AC  C23809        	 jp nz,knight_move
                      	 
  08AF  CD160A        	 call xy_ck
  08B2  CAF108        	 jp z,knight_xy
  08B5  CD250A        	 call x_ck
  08B8  CA0009        	 jp z,knight_x
  08BB  CD2D0A        	 call y_ck
  08BE  CA1C09        	 jp z,knight_y
  08C1                	kight_accel:
                      	
                      	 
  08C1  CD420A        	 call right_turn
  08C4  CD5A0F        	 call wall_ck
                      	; call z,48381
  08C7  CA3809        	 jp z,knight_move
  08CA  CD500A        	 call left_turn
                      	 
  08CD  CD5A0F        	 call wall_ck
  08D0  C2D608        	 jp nz,rndurdl
  08D3  C33809        	 jp knight_move
  08D6                	kight_accel_2:
  08D6                	rndurdl:
  08D6  CD420A        	 call right_turn
  08D9  CD5A0F        	 call wall_ck
  08DC  CA3809        	 jp z,knight_move
                      	
  08DF  CD420A        	 call right_turn 
  08E2  CD420A        	 call right_turn
  08E5  CD5A0F        	 call wall_ck
  08E8  CA3809        	 jp z,knight_move
                      	 
  08EB  CD500A        	 call left_turn 
  08EE  C33809        	 jp knight_move
                      	
                      	
  08F1                	knight_xy:
  08F1  23            	 inc HL
  08F2  7E            	 ld A,(HL)
  08F3  F6C0          	 or 11000000b
  08F5  77            	 ld (HL),A
  08F6  2B            	 dec HL
  08F7  CD5A0F        	 call wall_ck
  08FA  CA3809        	 jp z,knight_move
  08FD  C3D608        	 jp kight_accel_2 
                      	 
  0900                	knight_x:
  0900  CD2D0A        	 call y_ck
  0903  3808          	 jr c,knight_x_1
  0905  23            	 inc HL
  0906  CBFE          	 set 7,(HL)
  0908  CBB6          	 res 6,(HL)
  090A  2B            	 dec HL
  090B  1806          	 jr knight_x_2
  090D                	knight_x_1:
  090D  23            	 inc HL
  090E  CBBE          	 res 7,(HL)
  0910  CBB6          	 res 6,(HL)
  0912  2B            	 dec HL
  0913                	knight_x_2:
  0913  CD5A0F        	 call wall_ck
  0916  CA3809        	 jp z,knight_move
  0919  C3D608        	 jp kight_accel_2 
                      	 
  091C                	knight_y:
  091C  CD250A        	 call x_ck
  091F  3808          	 jr c,knight_y_1
  0921  23            	 inc HL
  0922  CBBE          	 res 7,(HL)
  0924  CBF6          	 set 6,(HL)
  0926  2B            	 dec HL
  0927  1806          	 jr knight_y_2
  0929                	knight_y_1:
  0929  23            	 inc HL
  092A  CBFE          	 set 7,(HL)
  092C  CBF6          	 set 6,(HL)
  092E  2B            	 dec HL
  092F                	knight_y_2:
  092F  CD5A0F        	 call wall_ck
  0932  CA3809        	 jp z,knight_move
  0935  C3D608        	 jp kight_accel_2 
                      	 
                      	
                      	
                      	
                      	
                      	
                      	
  0938                	knight_move:;a=0~3
  0938  115509        	 ld DE, knight_action_end
  093B  D5            	 push DE
  093C                	empty_move:
  093C  23            	 inc HL
  093D  7E            	 ld A,(HL)
  093E  2B            	 dec HL
  093F  E6C0          	 and 11000000b
  0941  2808          	 jr z,knight_action_up
  0943  FE80          	 cp 80h
  0945  3808          	 jr c,knight_action_ri
  0947  2808          	 jr z,knight_action_do
  0949                	knight_action_le:
  0949  35            	 dec (HL)
  094A  C9            	 ret
  094B                	knight_action_up:
  094B  23            	 inc HL
  094C  35            	 dec (HL)
  094D  2B            	 dec HL
  094E  C9            	 ret
  094F                	knight_action_ri:
  094F  34            	 inc (HL)
  0950  C9            	 ret
  0951                	knight_action_do:
  0951  23            	 inc HL
  0952  34            	 inc (HL)
  0953  2B            	 dec HL
  0954  C9            	 ret
                      	
                      	 
                      	 
                      	
                      	
  0955                	knight_action_end:
  0955  FD7E30        	 ld A,(IY+48)
  0958  EE01          	 xor 1
  095A  FD7730        	 ld (IY+48),A
  095D  B7            	 or A
  095E  2805          	 jr z,knight_action_end2
                      	 
  0960  11F919        	 ld DE,graph_n_knightu
  0963  1803          	 jr knight_action_end3
  0965                	knight_action_end2:
  0965  11111A        	 ld DE,graph_n_knightu+24
  0968                	knight_action_end3:
  0968  CD4305        	 call Egraph
                      	 
                      	 
                      	;********************cross chack kight*******************
                      	; call kwait
                      	
  096B  3A224C        	 ld A,(gil_st2)
  096E  B7            	 or A
  096F  2814          	 jr z,ssss1
  0971  CB7F          	 bit 7,A	;(gil sworud MIRU) 
  0973  2808          	 jr z,ssss0
  0975  CD250F        	 call cross_ck_a;s
  0978  DC5A0A        	 call c,HP_dec;(suraim HP=0)
  097B  1810          	 jr ssss2
  097D                	ssss0:
  097D  CD250F        	 call cross_ck_a;s
  0980  DC6D0A        	 call c,HP_dec_swdbc
  0983  1808          	 jr ssss2
  0985                	ssss1:;(gil_st=0-x)
  0985  CD250F        	 call cross_ck_a
  0988  3003          	 jr nc,ssss2
  098A  C3290D        	 jp gil_killing
  098D                	ssss2:
  098D  DD7E30        	 ld A,(IX+48)
  0990  EEFF          	 xor 0ffh
  0992  DD7730        	 ld (IX+48),A
  0995  C3450D        	 jp mains_end
                      	 
                      	
                      	
  0998                	knight_front_ck:
  0998  CD3A0A        	 call xyload
  099B  F5            	 push AF
  099C  32090A        	 ld (knight_front_ck_end+3),A
  099F  7B            	 ld A,E
  09A0  32070A        	 ld (knight_front_ck_end+1),A 
  09A3  F1            	 pop AF
  09A4  E6C0          	 and 11000000b
  09A6  2810          	 jr z,knight_front_ck_u
  09A8  FE02          	 cp 2
  09AA  3814          	 jr c,knight_front_ck_r
  09AC  281C          	 jr z,knight_front_ck_d
  09AE                	knight_front_ck_l:
  09AE  7B            	 ld A,E
  09AF  D607          	 sub 7
  09B1  FE1E          	 cp 30
  09B3  DA130A        	 jp c,knight_front_outerwall
  09B6  181C          	 jr knight_front_ck_e
  09B8                	knight_front_ck_u:
  09B8  7A            	 ld A,D
  09B9  D607          	 sub 7
  09BB  DA130A        	 jp c,knight_front_outerwall
  09BE  1814          	 jr knight_front_ck_e
  09C0                	knight_front_ck_r:
  09C0  7B            	 ld A,E
  09C1  C607          	 add A,7
  09C3  FE88          	 cp 136
  09C5  D2130A        	 jp nc,knight_front_outerwall
  09C8  180A          	 jr knight_front_ck_e
  09CA                	knight_front_ck_d:
  09CA  7A            	 ld A,D
  09CB  C607          	 add A,7
  09CD  FE2B          	 cp 43
  09CF  D2130A        	 jp nc,knight_front_outerwall
  09D2  1800          	 jr knight_front_ck_e
  09D4                	knight_front_ck_e:
  09D4  CD420A        	 call right_turn
  09D7  CD5A0F        	 call wall_ck
  09DA  CA060A        	 jp z,knight_front_ck_end
                      	
  09DD  CD500A        	 call left_turn
  09E0  CD5A0F        	 call wall_ck
  09E3  CA060A        	 jp z,knight_front_ck_end
                      	
  09E6  CD500A        	 call left_turn
  09E9  CD5A0F        	 call wall_ck
  09EC  CA060A        	 jp z,knight_front_ck_end
                      	 
  09EF  CD420A        	 call right_turn
  09F2  CD420A        	 call right_turn
                      	 
  09F5  23            	 inc HL
  09F6  7E            	 ld A,(HL)
  09F7  E6C0          	 and 11000000b
  09F9  47            	 ld B,A
  09FA  3A090A        	 ld A,(knight_front_ck_end+3)
  09FD  E63F          	 and 00111111b
  09FF  B0            	 or B
  0A00  32090A        	 ld (knight_front_ck_end+3),A
  0A03  2B            	 dec HL
                      	 
  0A04  18CE          	 jr knight_front_ck_e
                      	 
  0A06                	knight_front_ck_end:
  0A06  1E00          	 ld E,overwrite
  0A08  1600          	 ld D,overwrite
  0A0A  7B            	 ld A,E
  0A0B  77            	 ld (HL),A
  0A0C  23            	 inc HL
  0A0D  7A            	 ld A,D
  0A0E  77            	 ld (HL),A
  0A0F  2B            	 dec HL
  0A10  C33809        	 jp knight_move
                      	
  0A13                	knight_front_outerwall:
  0A13  C3D608        	 jp kight_accel_2
                      	
                      	
                      	
                      	;***************************ckeck sub****************************
                      	
  0A16                	xy_ck:;chr cp
  0A16  CD3A0A        	 call xyload
  0A19  E5            	 push HL		;>
  0A1A  2A2B4C        	 ld HL,(gil_xy)
  0A1D  7C            	 ld A,H
  0A1E  E63F          	 and 00111111b
  0A20  67            	 ld H,A
  0A21  ED52          	 sbc HL,DE
  0A23  E1            	 pop HL			;<
  0A24  C9            	 ret
  0A25                	x_ck:
  0A25  CD3A0A        	 call xyload
  0A28  3A2B4C        	 ld A,(gil_xy)
  0A2B  93            	 sub E
  0A2C  C9            	 ret
  0A2D                	y_ck:
  0A2D  CD3A0A        	 call xyload
  0A30  7A            	 ld A,D
  0A31  E63F          	 and 00111111b
  0A33  3A2C4C        	 ld A,(gil_xy+1)
  0A36  E63F          	 and 00111111b
  0A38  92            	 sub D
  0A39  C9            	 ret
                      	
                      	
  0A3A                	xyload:;A=urdl D=none
  0A3A  5E            	 ld E,(HL)
  0A3B  23            	 inc HL
  0A3C  7E            	 ld A,(HL)
  0A3D  E63F          	 and 00111111b
  0A3F  57            	 ld D,A
  0A40  2B            	 dec HL
  0A41  C9            	 ret
                      	
  0A42                	right_turn:
  0A42  23            	 inc HL
  0A43  7E            	 ld A,(HL)
  0A44  E6C0          	 and 11000000b
  0A46  C640          	 add A,40H
  0A48  47            	 ld B,A
  0A49  7E            	 ld A,(HL)
  0A4A  E63F          	 and 00111111b
  0A4C  B0            	 or B
  0A4D  77            	 ld (HL),A
  0A4E  2B            	 dec HL
  0A4F  C9            	 ret
                      	 
  0A50                	left_turn:
  0A50  CD420A        	 call right_turn
  0A53  CD420A        	 call right_turn
  0A56  CD420A        	 call right_turn
  0A59  C9            	 ret
                      	
                      	;*************************hp dec*****************************
  0A5A                	HP_dec:
  0A5A  3A264C        	 ld A,(gil_sword)
  0A5D  FE02          	 cp 2
  0A5F  DD7E00        	 ld A,(IX)
  0A62  2003          	 jr nz,HP_dec1
  0A64  3D            	 dec A
  0A65  2801          	 jr z,HP_dec2
  0A67                	HP_dec1:
  0A67  3D            	 dec A
  0A68                	HP_dec2:
  0A68  DD7700        	 ld (IX),A
  0A6B  281F          	 jr z,HP_rec
  0A6D                	HP_dec_swdbc:
  0A6D                	gil_HP_dec:
  0A6D  3A1F4C        	 ld A,(gil_hp)
  0A70  3D            	 dec A
  0A71  321F4C        	 ld (gil_hp),A
  0A74  CA290D        	 jp z,gil_killing
  0A77  C9            	 ret
                      	 
  0A78                	HP_decB:
  0A78  3A264C        	 ld A,(gil_sword)
  0A7B  FE02          	 cp 2
  0A7D  DD7E00        	 ld A,(IX)
  0A80  2003          	 jr nz,HP_decb1
  0A82  3D            	 dec A
  0A83  2801          	 jr z,HP_decb2
  0A85                	HP_decb1:
  0A85  3D            	 dec A
  0A86                	HP_decb2:
  0A86  DD7700        	 ld (IX),A
  0A89  2814          	 jr z,HP_rec2
  0A8B  C9            	 ret
                      	
                      	 
  0A8C                	HP_rec:
  0A8C  DD7E60        	 ld A,(IX+96)
  0A8F  47            	 ld B,A
  0A90  AF            	 xor A
  0A91  DD7760        	 ld (IX+96),A
  0A94  3A1F4C        	 ld A,(gil_HP)
  0A97  80            	 add A,B
  0A98  3002          	 jr nc,H_recP2
  0A9A  3EFF          	 ld A,255
  0A9C                	H_recP2:
  0A9C  321F4C        	 ld (gil_HP),A
  0A9F                	HP_rec2:
  0A9F  AF            	 xor A
  0AA0  DD7700        	 ld (IX),A
  0AA3  DD7730        	 ld (IX+48),A
  0AA6  DD7760        	 ld (IX+96),A
  0AA9  FD7700        	 ld (IY),A
  0AAC  C9            	 ret
                      	
                      	;*************************key actions************************
  0AAD                	key_action:
  0AAD  3A3B4C        	 ld A,(key)
  0AB0  B7            	 or A
  0AB1  2807          	 jr z,key_action_1
  0AB3  AF            	 xor A
  0AB4  DD7700        	 ld (IX),A
  0AB7  C3450D        	 jp mains_end
  0ABA                	key_action_1:
  0ABA  CD250F        	 call cross_ck_a
  0ABD  3005          	 jr nc,key_action_end
  0ABF  3E01          	 ld A,1
  0AC1  323B4C        	 ld (key),A
  0AC4                	key_action_end:
  0AC4  11291A        	 ld DE,graph_key
  0AC7  CD4305        	 call Egraph
  0ACA  C3450D        	 jp mains_end
                      	
                      	;**************************box action*************************
  0ACD                	box_action:
                      	
  0ACD  DD7E30        	 ld A,(IX+48)
  0AD0  B7            	 or A
  0AD1  3A974A        	 ld A,(floor)
  0AD4  200F          	 jr nz,box_actiont
                      	 
  0AD6  3D            	 dec A
  0AD7  D9            	 exx
  0AD8  87            	 add A,A
  0AD9  5F            	 ld E,A
  0ADA  1600          	 ld D,0
  0ADC  21F00A        	 ld HL,box_action_table_farse
  0ADF                	box_action2:
  0ADF  19            	 add HL,DE
  0AE0  5E            	 ld E,(HL)
  0AE1  23            	 inc HL
  0AE2  56            	 ld D,(HL)
  0AE3  EB            	 ex DE,HL
                      	 
                      	; ld (0f0h),HL
                      	; ret
                      	 
  0AE4  E9            	 jp (HL)
  0AE5                	box_actiont:
  0AE5  3D            	 dec A
  0AE6  D9            	 exx
  0AE7  87            	 add A,A
  0AE8  5F            	 ld E,A
  0AE9  1600          	 ld D,0
  0AEB  21F40A        	 ld HL,box_action_table_true
  0AEE  18EF          	 jr box_action2
                      	 
                      	 
  0AF0                	box_action_table_farse:
  0AF0  F80A220B      	 dw floor1,floor2
  0AF4                	box_action_table_true:
  0AF4  070B310B      	 dw floor1t,floor2t
                      	
                      	
                      	;***********************floor1******************************
  0AF8                	floor1:
  0AF8  D9            	 exx
                      	 
  0AF9  3A411A        	 ld A,(dammy)
  0AFC  FE03          	 cp 3
  0AFE  DA450D        	 jp c,mains_end
  0B01  DD7730        	 ld (IX+48),A
  0B04  C3450D        	 jp mains_end
  0B07                	floor1t
  0B07  D9            	 exx
  0B08  3A2F4C        	 ld A,(matk)
  0B0B  B7            	 or A
  0B0C  C2450D        	 jp nz,mains_end
  0B0F  CD250F        	 call cross_ck_a
  0B12  D2470B        	 jp nc,box_action_end
  0B15  3E01          	 ld A,1
  0B17  322F4C        	 ld (matk),A
  0B1A  3E02          	 ld A,2
  0B1C  32244C        	 ld (gil_matk_count),A
  0B1F  C3450D        	 jp mains_end
                      	 
                      	 
                      	
                      	;***********************floor2******************************
  0B22                	floor2:
  0B22  D9            	 exx
                      	 
  0B23  3A411A        	 ld A,(dammy)
  0B26  FE02          	 cp 2
  0B28  DA450D        	 jp c,mains_end
  0B2B  DD7730        	 ld (IX+48),A
  0B2E  C3450D        	 jp mains_end
  0B31                	floor2t
  0B31  D9            	 exx
  0B32  3A304C        	 ld A,(boot)
  0B35  B7            	 or A
  0B36  C2450D        	 jp nz,mains_end
  0B39  CD250F        	 call cross_ck_a
  0B3C  D2470B        	 jp nc,box_action_end
  0B3F  3E01          	 ld A,1
  0B41  32304C        	 ld (boot),A
  0B44  C3450D        	 jp mains_end
                      	
  0B47                	box_action_end:
  0B47  113B1A        	 ld DE,graph_box
  0B4A  CD4305        	 call Egraph
  0B4D  C3450D        	 jp mains_end
                      	
                      	
                      	;*************************door actions************************
  0B50                	door_action:
  0B50  3A3B4C        	 ld A,(key)
  0B53  B7            	 or A
  0B54  2002          	 jr nz,door_action_1
  0B56  1812          	 jr door_action_end
  0B58                	door_action_1:
  0B58  11351A        	 ld DE,graph_door+6
  0B5B  CD4305        	 call Egraph
  0B5E  CD250F        	 call cross_ck_a
  0B61  CD160A        	 call xy_ck
  0B64  CA730B        	 jp z,next_floor
  0B67  C3450D        	 jp mains_end
  0B6A                	door_action_end:
  0B6A  112F1A        	 ld DE,graph_door
  0B6D  CD4305        	 call Egraph
  0B70  C3450D        	 jp mains_end
                      	
  0B73                	next_floor:
  0B73  110601        	 ld DE,0106h
  0B76  060B          	 ld B,11
  0B78  21960B        	 ld HL,next_floorms
  0B7B  CDF1BF        	 call msp
  0B7E  110802        	 ld DE,0208h
  0B81  060A          	 ld B,10
  0B83  21A10B        	 ld HL,next_floorms+11
  0B86  CDF1BF        	 call msp
  0B89  CD690D        	 call tim255
  0B8C  CDFDBC        	 call kwait
  0B8F  21974A        	 ld HL,floor
  0B92  34            	 inc (HL)
  0B93  C37D01        	 jp Stating_before
  0B96                	next_floorms:
  0B96  464C4F4F522043	 db "FLOOR CLEAR"
  0BA1  4E45585420464C	 db "NEXT FLOOR"
                      	
                      	;*************************gil actions*************************
  0BAB                	gil_action:
  0BAB  E5            	 push HL
                      	
                      	
  0BAC  3A2B4C        	 ld A,(gil_xy)
  0BAF  5F            	 ld E,A
  0BB0  3A2C4C        	 ld A,(gil_xy+1)
  0BB3  57            	 ld D,A
  0BB4  CDEC12        	 call grp_del
                      	; call kwait
                      	
                      	;*************************key scanf**************************
  0BB7  CD400E        	 call keysc
  0BBA  321E4C        	 ld (gil_button),A
  0BBD  08            	 ex AF,AF'
                      	
                      	;************************sword back***************************
  0BBE  3A224C        	 ld A,(gil_st2)
  0BC1  B7            	 or A
  0BC2  C2F20C        	 jp nz,gil_sword_f2
                      	;***********************sword atack****************************
  0BC5                	gil_action_l_b:
  0BC5  08            	 ex AF,AF'
  0BC6  CB6F          	 bit 5,A
  0BC8  C2B90C        	 jp nz,gil_sword_f
  0BCB  CDDC0C        	 call gil_sword_reset
                      	
  0BCE  210919        	 ld HL,graph_gil_ulf
  0BD1  228B0C        	 ld (gil_action_end-2),HL
                      	;************************urdl move*****************************
  0BD4                	gil_action_l:
  0BD4  08            	 ex AF,AF'
  0BD5  3A304C        	 ld A,(boot)
  0BD8  B7            	 or A
  0BD9  200B          	 jr nz,gil_action_l2
  0BDB  3A254C        	 ld A,(gil_bt)
  0BDE  EEFF          	 xor 0ffh
  0BE0  32254C        	 ld (gil_bt),A
  0BE3  CA8A0C        	 jp z,gil_action_end-3
  0BE6                	gil_action_l2:
  0BE6  08            	 ex AF,AF'
  0BE7  CB47          	 bit 0,A
  0BE9  200F          	 jr nz,gil_left
  0BEB  CB4F          	 bit 1,A
  0BED  202D          	 jr nz,gil_right
  0BEF  CB77          	 bit 6,A
  0BF1  204C          	 jr nz,gil_down
  0BF3  CB7F          	 bit 7,A
  0BF5  206C          	 jr nz,gil_up
                      	;*****************************noting************************
  0BF7  C38A0C        	 jp gil_action_end-3
                      	 ;************************move farse*************************
  0BFA                	gil_left:
  0BFA  3A2C4C        	 ld A,(gil_xy+1);y
  0BFD  E63F          	 and 00111111b
  0BFF  CA090C        	 jp z,gil_left_l
  0C02                	gil_left_s:
  0C02  D607          	 sub 7
  0C04  DAA60C        	 jp c,direction_p
  0C07  20F9          	 jr nz,gil_left_s
  0C09                	gil_left_l:
  0C09  3EC0          	 ld A,11000000b
  0C0B  212C4C        	 ld HL,gil_xy+1
  0C0E  B6            	 or (HL)
  0C0F  77            	 ld (HL),A
  0C10  2B            	 dec HL;ld HL,gil_xy
  0C11  CD5A0F        	 call wall_ck
  0C14  B7            	 or A;
  0C15  C28A0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0C18  35            	 dec (HL)
  0C19  C3830C        	 jp gil_walk
                      	
  0C1C                	gil_right:
  0C1C  3A2C4C        	 ld A,(gil_xy+1);y
  0C1F  E63F          	 and 00111111b
  0C21  CA2B0C        	 jp z,gil_right_l
  0C24                	gil_right_s:
  0C24  D607          	 sub 7
  0C26  DAA60C        	 jp c,direction_p
  0C29  20F9          	 jr nz,gil_right_s
  0C2B                	gil_right_l:
  0C2B  3E3F          	 ld A,00111111b
  0C2D  212C4C        	 ld HL,gil_xy+1
  0C30  A6            	 and (HL)
  0C31  77            	 ld (HL),A
  0C32  CBF6          	 set 6,(HL)
  0C34  2B            	 dec HL;ld HL,gil_xy
  0C35  CD5A0F        	 call wall_ck
  0C38  B7            	 or A;
  0C39  C28A0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0C3C  34            	 inc (HL)
  0C3D  1844          	 jr gil_walk
                      	
  0C3F                	gil_down:
  0C3F  3A2B4C        	 ld A,(gil_xy);x
  0C42  D61E          	 sub 30
  0C44  CA4E0C        	 jp z,gil_down_l
  0C47                	gil_down_s:
  0C47  D607          	 sub 7
  0C49  DAA60C        	 jp c,direction_p
  0C4C  20F9          	 jr nz,gil_down_s
  0C4E                	gil_down_l:
  0C4E  3E3F          	 ld A,00111111b
  0C50  212C4C        	 ld HL,gil_xy+1
  0C53  A6            	 and (HL)
  0C54  77            	 ld (HL),A
  0C55  CBFE          	 set 7,(HL)
  0C57  2B            	 dec HL;ld HL,gil_xy
  0C58  CD5A0F        	 call wall_ck
  0C5B  B7            	 or A;
  0C5C  C28A0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0C5F  23            	 inc HL
  0C60  34            	 inc (HL)
  0C61  1820          	 jr gil_walk
                      	
  0C63                	gil_up:
  0C63  3A2B4C        	 ld A,(gil_xy);x
  0C66  D61E          	 sub 30
  0C68  CA720C        	 jp z,gil_up_l
  0C6B                	gil_up_s:
  0C6B  D607          	 sub 7
  0C6D  DAA60C        	 jp c,direction_p
  0C70  20F9          	 jr nz,gil_up_s
  0C72                	gil_up_l:
  0C72  3E3F          	 ld A,00111111b
  0C74  212C4C        	 ld HL,gil_xy+1
  0C77  A6            	 and (HL)
  0C78  77            	 ld (HL),A
  0C79  2B            	 dec HL;ld HL,gil_xy
  0C7A  CD5A0F        	 call wall_ck
  0C7D  B7            	 or A;
  0C7E  C28A0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0C81  23            	 inc HL
  0C82  35            	 dec (HL)
                      	; jr gil_walk
                      	
                      	
  0C83                	gil_walk:
  0C83  21214C        	 ld HL,gil_st1
  0C86  3EFF          	 ld A,0ffh
  0C88  AE            	 xor (HL)
  0C89  77            	 ld (HL),A
                      	
  0C8A  210919        	 ld HL,graph_gil_ulf
  0C8D                	gil_action_end:
  0C8D  3A214C        	 ld A,(gil_st1)
  0C90  3C            	 inc A
  0C91  111800        	 ld DE,24
  0C94  CD940D        	 call xsan
  0C97                	gil_action_end_l:
  0C97  3A2B4C        	 ld A,(gil_xy)
  0C9A  5F            	 ld E,A
  0C9B  3A2C4C        	 ld A,(gil_xy+1)
  0C9E  57            	 ld D,A
  0C9F  CD6012        	 call grp_set
  0CA2  E1            	 pop HL
  0CA3  C3450D        	 jp mains_end
                      	
  0CA6                	direction_p:
  0CA6  3A2C4C        	 ld A,(gil_xy+1)
  0CA9  E6C0          	 and 11000000b
  0CAB  CA720C        	 jp z,gil_up_l
  0CAE  FE80          	 cp 80h
  0CB0  DA2B0C        	 jp c,gil_right_l
  0CB3  CA4E0C        	 jp z,gil_down_l
  0CB6  C3FA0B        	 jp gil_left
                      	
  0CB9                	gil_sword_f:;key_action
  0CB9  08            	 ex AF,AF'
  0CBA  B7            	 or A
  0CBB  C2D10C        	 jp nz,gil_sword_set 
                      	;************************sword atack***************************
  0CBE  3E0A          	 ld A,10		;back flame
  0CC0  32224C        	 ld (gil_st2),A
                      	;***********************matk action****************************
  0CC3  CD1010        	 call matk_action_gil
                      	;*************************************************************
  0CC6  113919        	 ld DE,graph_gilsw_ulf	;gil_sw
  0CC9  ED538B0C      	 ld (gil_action_end-2),DE
  0CCD  08            	 ex AF,AF'
  0CCE  C3D40B        	 jp gil_action_l
  0CD1                	gil_sword_set:
  0CD1  116919        	 ld DE,graph_gilsword_ulf	;gil_swd
  0CD4  ED538B0C      	 ld (gil_action_end-2),DE
  0CD8                	gil_sword_set_l:
  0CD8  08            	 ex AF,AF'
  0CD9  C3D40B        	 jp gil_action_l
  0CDC                	gil_sword_reset:
  0CDC  08            	 ex AF,AF'
  0CDD  3A224C        	 ld A,(gil_st2)
  0CE0  47            	 ld B,A
  0CE1  08            	 ex AF,AF'
  0CE2  CB78          	 bit 7,B
  0CE4  C8            	 ret z
  0CE5  08            	 ex AF,AF'
  0CE6  E1            	 pop HL
  0CE7  3E80          	 ld A,10000000b
                      	;************************sword back***************************
  0CE9  F60A          	 or 10			;back flame
  0CEB  32224C        	 ld (gil_st2),A
  0CEE  08            	 ex AF,AF'
  0CEF  C3D40B        	 jp gil_action_l
  0CF2                	gil_sword_f2:;auto_action
  0CF2  FE80          	 cp 80h
  0CF4  CAC50B        	 jp z,gil_action_l_b
  0CF7  E680          	 and 10000000b
  0CF9  C2110D        	 jp nz,gil_sword_f_decB;A=1nnnnnnnb
  0CFC                	gil_sword_f_decA:;A=0nnnnnnnb
  0CFC  21224C        	 ld HL,gil_st2
  0CFF  7E            	 ld A,(HL)
  0D00  3D            	 dec A
  0D01  77            	 ld (HL),A
  0D02  113919        	 ld DE,graph_gilsw_ulf	;gil_sw
  0D05  ED538B0C      	 ld (gil_action_end-2),DE
  0D09  C2250D        	 jp nz,gil_action_l_r
  0D0C  CBFE          	 set 7,(HL)
  0D0E  C3250D        	 jp gil_action_l_r
  0D11                	gil_sword_f_decB:;A=1nnnnnnnb
  0D11  21224C        	 ld HL,gil_st2
  0D14  7E            	 ld A,(HL)
  0D15  3D            	 dec A
  0D16  77            	 ld (HL),A
  0D17  E67F          	 and 01111111b
  0D19  113919        	 ld DE,graph_gilsw_ulf	;gil_sw
  0D1C  ED538B0C      	 ld (gil_action_end-2),DE
  0D20  C2250D        	 jp nz,gil_action_l_r
  0D23  CBBE          	 res 7,(HL)
  0D25                	gil_action_l_r:
  0D25  08            	 ex AF,AF'
  0D26  C3D40B        	 jp gil_action_l
                      	
                      	
  0D29                	gil_killing:
  0D29  CD1A0E        	 call grp_o
  0D2C  213A0D        	 ld HL,killingm
  0D2F  110000        	 ld DE,0
  0D32  060B          	 ld B,11
  0D34  CDF1BF        	 call msp
  0D37  C35703        	 jp stating_rec
                      	
                      	
                      	
  0D3A                	killingm:
  0D3A  6265656E206B69	 db "been killed"
                      	
                      	
  0D45                	mains_end:
                      	; ld A,(IX+48)
                      	; ld (0f0h),A
                      	; ld (0f2h),IX
                      	
  0D45  3AE103        	 ld A,(count+1)
  0D48  3D            	 dec A
  0D49  32E103        	 ld (count+1),A
  0D4C  23            	 inc HL
  0D4D  23            	 inc HL
  0D4E  DD23          	 inc IX
  0D50  FD23          	 inc IY
  0D52  D9            	 exx
  0D53  CD400E        	 call keysc
  0D56  CB57          	 bit 2,A
  0D58  C0            	 ret nz
  0D59  D9            	 exx
  0D5A  C3E003        	 jp mains
                      	
                      	
  0D5D                	retP:
  0D5D  310000        	 ld SP,0
  0D60  C9            	 ret
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	;*********************************************************
  0D61                	TIMBTL:
  0D61  3E32          	 LD A,50
  0D63  1806          	 JR TIMER
  0D65                	TIM30:
  0D65  3E25          	 LD A,37
  0D67  1802          	 JR TIMER
  0D69                	TIM255:
  0D69  3EFF          	 LD A,255
  0D6B                	TIMER:
  0D6B  010000        	 LD BC,0
  0D6E  03            	 INC BC;LOOP
  0D6F  000000000000  	 DB 0,0,0,0,0,0
  0D75  A8            	 XOR B
  0D76  C8            	 RET Z
  0D77  18F5          	 JR TIMER+3
  0D79                	RAND:;A
  0D79  E5            	 PUSH HL
  0D7A  D5            	 push DE
  0D7B  210000        	 LD HL,0
  0D7E  54            	 LD D,H
  0D7F  5D            	 LD E,L
  0D80  29            	 ADD HL,HL
  0D81  29            	 ADD HL,HL
  0D82  19            	 ADD HL,DE
  0D83  11475D        	 LD DE,5D47H
  0D86  19            	 ADD HL,DE
  0D87  227C0D        	 LD (RAND+3),HL
  0D8A  7C            	 LD A,H
  0D8B  D1            	 pop DE
  0D8C  E1            	 POP HL
  0D8D  C9            	 RET
  0D8E                	RAND4:
                      	; ld A,R
                      	; rra
                      	; rra
                      	; rra
                      	; and 11000000b
                      	; ret
  0D8E  CD790D        	 CALL RAND
  0D91  E6C0          	 AND 11000000b
  0D93  C9            	 RET
  0D94                	XSAN:
  0D94  B7            	 OR A
  0D95  C8            	 RET Z
  0D96                	XSANL:
  0D96  19            	 ADD HL,DE
  0D97  3D            	 DEC A
  0D98  20FC          	 JR NZ,XSANL
  0D9A  C9            	 RET
  0D9B                	NMEMRY:
  0D9B  0000000000    	 DB 0,0,0,0,0
  0DA0                	ASCN:;HL=l(2byte)DE
  0DA0  119B0D        	 LD DE,NMEMRY
  0DA3  011027        	 LD BC,10000
  0DA6  CDDA0D        	 CALL WARIS
  0DA9  01E803        	 LD BC,1000
  0DAC  CDDA0D        	 CALL WARIS
  0DAF  016400        	 LD BC,100
  0DB2  CDDA0D        	 CALL WARIS
  0DB5  010A00        	 LD BC,10
  0DB8  CDDA0D        	 CALL WARIS
  0DBB  7D            	 LD A,L
  0DBC  12            	 LD (DE),A
  0DBD  0605          	 LD B,5
  0DBF  119B0D        	 LD DE,NMEMRY
  0DC2                	ASCL:
  0DC2  1A            	 LD A,(DE)
  0DC3  FE00          	 CP 0
  0DC5  2802          	 JR Z,ASCL2
  0DC7  1808          	 JR ASC2
  0DC9                	ASCL2:
  0DC9  13            	 INC DE
  0DCA  10F6          	 DJNZ ASCL
  0DCC  0601          	 LD B,1
  0DCE  119F0D        	 LD DE,NMEMRY+4
  0DD1                	ASC2:
  0DD1  1A            	 LD A,(DE)
  0DD2  0E30          	 LD C,30H
  0DD4  81            	 ADD A,C
  0DD5  12            	 LD (DE),A
  0DD6  13            	 INC DE
  0DD7  10F8          	 DJNZ ASC2
  0DD9  C9            	 RET
  0DDA                	WARIS:
  0DDA  AF            	 XOR A
                      	;WARI1:
  0DDB  ED42          	 SBC HL,BC
  0DDD  3803          	 JR C,WARI2
  0DDF  3C            	 INC A
  0DE0  18F9          	 JR WARIS+1
  0DE2                	WARI2:
  0DE2  09            	 ADD HL,BC
  0DE3  12            	 LD (DE),A
  0DE4  13            	 INC DE		;
  0DE5  C9            	 RET
  0DE6                	cls:
  0DE6  F5            	 push AF
  0DE7  D5            	 push DE
  0DE8  E5            	 push HL
  0DE9  C5            	 push BC
  0DEA  3E00          	 ld A,0
  0DEC  21ED13        	 ld HL,grapu_area
  0DEF  11EE13        	 ld DE,grapu_area+1
  0DF2  77            	 ld (HL),A
  0DF3  015F03        	 ld BC,144*6-1
  0DF6  EDB0          	 ldir
  0DF8  CD1A0E        	 call grp_o
  0DFB  C1            	 pop BC
  0DFC  E1            	 pop HL
  0DFD  D1            	 pop DE
  0DFE  F1            	 pop AF
  0DFF  C9            	 ret
                      	
  0E00                	bls:
  0E00  F5            	 push AF
  0E01  D5            	 push DE
  0E02  E5            	 push HL
  0E03  C5            	 push BC
  0E04  21ED13        	 LD HL,grapu_area
  0E07  36FF          	 LD (HL),0FFH
  0E09  11EE13        	 LD DE,grapu_area+1
  0E0C  015F03        	 LD BC,863
  0E0F  EDB0          	 LDIR
  0E11  CD1A0E        	 CALL grp_o
  0E14  D9            	 EXX
  0E15  C1            	 pop BC
  0E16  E1            	 pop HL
  0E17  D1            	 pop DE
  0E18  F1            	 pop AF
  0E19  C9            	 RET
  0E1A                	grp_o:
  0E1A  3E06          	 ld A,6
  0E1C  110000        	 ld DE,0
  0E1F  21ED13        	 ld HL,grapu_area
  0E22                	grp_o_l:
  0E22  D5            	 push DE
  0E23  F5            	 push AF
  0E24  0690          	 ld B,144
  0E26  CDD0BF        	 call grp
  0E29  23            	 inc HL
  0E2A  F1            	 pop AF
  0E2B  D1            	 pop DE
  0E2C  14            	 inc D
  0E2D  3D            	 dec A
  0E2E  20F2          	 jr nz,grp_o_l
  0E30  C9            	 ret
                      	
  0E31                	grp_open:
  0E31  0E06          	 ld C,6
  0E33                	grp_open_l
  0E33  C5            	 push BC
  0E34  D5            	 push DE
  0E35  CDD0BF        	 call grp
  0E38  D1            	 pop DE
  0E39  14            	 inc D
  0E3A  23            	 inc HL
  0E3B  C1            	 pop BC
  0E3C  0D            	 dec C
  0E3D  20F4          	 jr nz,grp_open_l
  0E3F  C9            	 ret
                      	
  0E40                	keysc:
  0E40  F3            	 di
  0E41  AF            	 xor A
  0E42  D311          	 out (11h),A
  0E44  3E08          	 ld A,08h
  0E46  D311          	 out (11h),A
  0E48  CDAD8A        	 call 8aadh
  0E4B  DB10          	 in A,(10h)
  0E4D  E6E0          	 and 0e0h
  0E4F  47            	 ld B,A
  0E50  AF            	 xor A
  0E51  D311          	 out (11h),A
  0E53  3E10          	 ld A,10h
  0E55  D311          	 out (11h),A
  0E57  CDAD8A        	 call 8aadh
  0E5A  DB10          	 in A,(10h)
  0E5C  E60F          	 and 0fh
  0E5E  B0            	 or B
  0E5F  FB            	 ei
  0E60  C9            	 ret
                      	
                      	
                      	
  0E61                	charReput:;HL=obj_xy++
  0E61                	charReput_x:
  0E61  7E            	 ld A,(HL);x
  0E62  4F            	 ld C,A
  0E63  D61E          	 sub 30
  0E65  CA7D0E        	 jp z,charReput_y
  0E68                	charReput_x_lp:
  0E68  D607          	 sub 7
  0E6A  CA7D0E        	 jp z,charReput_y
  0E6D  30F9          	 jr nc,charReput_x_lp
  0E6F  FEFD          	 cp 0fch+1;cy=-4~-6 left
  0E71  3804          	 jr c,charReput_x_1
  0E73  ED44          	 neg;(right+)
  0E75  1804          	 jr charReput_x_2
  0E77                	charReput_x_1:
  0E77  C607          	 add A,7
  0E79  ED44          	 neg;(left-)
  0E7B                	charReput_x_2:
  0E7B  81            	 add A,C
  0E7C  77            	 ld (HL),A
                      	
  0E7D                	charReput_y:
  0E7D  23            	 inc HL
  0E7E  7E            	 ld A,(HL)
  0E7F  2B            	 dec HL
  0E80  4F            	 ld C,A
  0E81  E63F          	 and 00111111b
  0E83  C8            	 ret z
  0E84                	charReput_y_lp:
  0E84  D607          	 sub 7
  0E86  C8            	 ret z
  0E87  30FB          	 jr nc,charReput_y_lp
  0E89  FEFD          	 cp 0fch+1;cy=-4~-6 up
  0E8B  3804          	 jr c,charReput_y_1
  0E8D  ED44          	 neg;(down+)
  0E8F  1804          	 jr charReput_y_2
  0E91                	charReput_y_1:
  0E91  C607          	 add A,7
  0E93  ED44          	 neg;(up-)
  0E95                	charReput_y_2:
  0E95  81            	 add A,C
  0E96  23            	 inc HL
  0E97  77            	 ld (HL),A
  0E98  2B            	 dec HL
  0E99  C9            	 ret 
                      	
                      	
  0E9A                	cross_ck_s:;HL=obj_xy+
  0E9A  5E            	 ld E,(HL)
  0E9B  23            	 inc HL
  0E9C  56            	 ld D,(HL)
  0E9D  2B            	 dec HL
  0E9E  3A2C4C        	 ld A,(gil_xy+1)
  0EA1  E6C0          	 and 11000000b
  0EA3  CACC0E        	 jp z,cross_ck_s_up
  0EA6  FE80          	 cp 80h
  0EA8  DAEA0E        	 jp c,cross_ck_s_right
  0EAB  CA070F        	 jp z,cross_ck_s_down
  0EAE                	cross_ck_s_left:
  0EAE  3A2C4C        	 ld A,(gil_xy+1)
  0EB1  E63F          	 and 3fh
  0EB3  92            	 sub D	;x-x1
  0EB4  FE03          	 cp 3
  0EB6  3805          	 jr c,cross_ck_s_left_2
  0EB8  2F            	 cpl
  0EB9  3C            	 inc A
  0EBA  FE03          	 cp 3
  0EBC  D0            	 ret nc
  0EBD                	cross_ck_s_left_2:
  0EBD  3A2B4C        	 ld A,(gil_xy)
  0EC0  93            	 sub E
  0EC1  FE06          	 cp 6		;when (a-d)>0 is that empty at left.
  0EC3  D8            	 ret c
  0EC4  2F            	 cpl
  0EC5  3C            	 inc A
  0EC6  FE03          	 cp 3
  0EC8  DA290D        	 jp c,gil_killing
  0ECB  C9            	 ret
  0ECC                	cross_ck_s_up:
  0ECC  3A2B4C        	 ld A,(gil_xy)
  0ECF  93            	 sub E	;x-x1
  0ED0  FE03          	 cp 3
  0ED2  3805          	 jr c,cross_ck_s_up_2
  0ED4  2F            	 cpl
  0ED5  3C            	 inc A
  0ED6  FE03          	 cp 3
  0ED8  D0            	 ret nc
  0ED9                	cross_ck_s_up_2:
  0ED9  3A2C4C        	 ld A,(gil_xy+1)
  0EDC  E63F          	 and 3fh
  0EDE  92            	 sub D
  0EDF  FE03          	 cp 3		;when (a-d)>0 is that empty at up.
  0EE1  D8            	 ret c
  0EE2  2F            	 cpl
  0EE3  3C            	 inc A
  0EE4  FE03          	 cp 3
  0EE6  DA290D        	 jp c,gil_killing
  0EE9  C9            	 ret
  0EEA                	cross_ck_s_right:
  0EEA  3A2C4C        	 ld A,(gil_xy+1)
  0EED  E63F          	 and 3fh
  0EEF  92            	 sub D	;x-x1
  0EF0  FE03          	 cp 3
  0EF2  3805          	 jr c,cross_ck_s_right_2
  0EF4  2F            	 cpl
  0EF5  3C            	 inc A
  0EF6  FE03          	 cp 3
  0EF8  C9            	 ret ;c or nc
  0EF9                	cross_ck_s_right_2:
  0EF9  3A2B4C        	 ld A,(gil_xy)
  0EFC  93            	 sub E
  0EFD  FE03          	 cp 3		;when (a-d)<0 is that empty at right.
  0EFF  DA290D        	 jp c,gil_killing
  0F02  2F            	 cpl
  0F03  3C            	 inc A
  0F04  FE06          	 cp 6
  0F06  C9            	 ret ;c or nc
  0F07                	cross_ck_s_down:
  0F07  3A2B4C        	 ld A,(gil_xy)
  0F0A  93            	 sub E	;x-x1
  0F0B  FE03          	 cp 3
  0F0D  3805          	 jr c,cross_ck_s_down_2
  0F0F  2F            	 cpl
  0F10  3C            	 inc A
  0F11  FE03          	 cp 3
  0F13  D0            	 ret nc
  0F14                	cross_ck_s_down_2:
  0F14  3A2C4C        	 ld A,(gil_xy+1)
  0F17  E63F          	 and 3fh
  0F19  92            	 sub D
  0F1A  FE03          	 cp 3		;when (a-d)<0 is that empty at down.
  0F1C  DA290D        	 jp c,gil_killing
  0F1F  D8            	 ret c
  0F20  2F            	 cpl
  0F21  3C            	 inc A
  0F22  FE06          	 cp 6
  0F24  C9            	 ret
                      	
                      	
  0F25                	cross_ck_a:;HL=obj_xy+
  0F25  5E            	 ld E,(HL);x
  0F26  23            	 inc HL
  0F27  7E            	 ld A,(HL)
  0F28  2B            	 dec HL
  0F29  E63F          	 and 3fh
  0F2B  57            	 ld D,A	;y
                      	; ld HL,(gil_xy)
  0F2C  3A2B4C        	 ld A,(gil_xy)
  0F2F  93            	 sub E	;x-x1
  0F30  FE03          	 cp 3
  0F32  3805          	 jr c,cross_ck_al
  0F34  2F            	 cpl
  0F35  3C            	 inc A
  0F36  FE03          	 cp 3
  0F38  D0            	 ret nc
  0F39                	cross_ck_al:
  0F39  3A2C4C        	 ld A,(gil_xy+1)
  0F3C  E63F          	 and 3fh
  0F3E  92            	 sub D
  0F3F  FE03          	 cp 3
  0F41  D8            	 ret c
  0F42  2F            	 cpl
  0F43  3C            	 inc A
  0F44  FE03          	 cp 3
  0F46  C9            	 ret ;nc or cy
                      	;cy is crosses.
                      	
  0F47                	cha_kill:;HL=obj_xy++,IX=obj_hp
  0F47  E5            	 push HL
  0F48  5E            	 ld E,(HL)
  0F49  23            	 inc HL
  0F4A  56            	 ld D,(HL)
  0F4B  CDEC12        	 call grp_del
  0F4E  21411A        	 ld HL,dammy
  0F51  7E            	 ld A,(HL)
  0F52  3C            	 inc A
  0F53  77            	 ld (HL),A
  0F54  E1            	 pop HL
  0F55  AF            	 xor A
  0F56  DD7700        	 ld (IX),A
  0F59  C9            	 ret
                      	
                      	
  0F5A                	wall_ck:
  0F5A  E5            	 push HL
  0F5B  CD600F        	 call wall_cks
  0F5E  E1            	 pop HL
  0F5F  C9            	 ret
                      	
  0F60                	wall_cks:;HL,obj_xy+;non zero=don't pass, zero=pass and A=0, cy=not block
  0F60  E5            	 push HL
                      	;HL=(y,x)
  0F61  5E            	 ld E,(HL);x
  0F62  23            	 inc HL
  0F63  56            	 ld D,(HL);y
  0F64  2B            	 dec HL
  0F65  EB            	 ex DE,HL
  0F66  3E3F          	 ld A,00111111b
  0F68  A4            	 and H
  0F69  010000        	 ld BC,0
  0F6C  2808          	 jr z,wall_ck_lc
  0F6E                	wall_ck_lb:
  0F6E  04            	 inc B
  0F6F  D607          	 sub 7
  0F71  DAEA0F        	 jp c,wall_ck_end
  0F74  20F8          	 jr nz,wall_ck_lb
  0F76                	wall_ck_lc:
  0F76  7D            	 ld A,L
  0F77  D61E          	 sub 30
  0F79  2808          	 jr z,wall_ck_le
  0F7B                	wall_ck_ld:
  0F7B  0C            	 inc C
  0F7C  D607          	 sub 7
  0F7E  DAEA0F        	 jp c,wall_ck_end
  0F81  20F8          	 jr nz,wall_ck_ld
  0F83                	wall_ck_le:
  0F83  7C            	 ld A,H
  0F84  E6C0          	 and 11000000b
  0F86  CAD40F        	 jp z,wall_ck_lu
  0F89  FE80          	 cp 80h
  0F8B  DABD0F        	 jp c,wall_ck_lr
  0F8E  CAA70F        	 jp z,wall_ck_ldd
                      	
  0F91                	wall_ck_ll:
  0F91  21BB11        	 ld HL,map_memry_left-17
                      	;x+C
  0F94  59            	 ld E,C
  0F95  1600          	 ld D,0
  0F97  19            	 add HL,DE
                      	;y+17*B
  0F98  111100        	 ld DE,17
  0F9B  04            	 inc B
  0F9C                	wall_ck_ll_2:
  0F9C  19            	 add HL,DE
  0F9D  10FD          	 djnz wall_ck_ll_2
                      	; or A
                      	; sbc HL,DE
  0F9F  222D10        	 ld (block_pointaP+1),HL
  0FA2  7E            	 ld A,(HL)
  0FA3  E680          	 and t;t(80h) or f(0)
  0FA5  E1            	 pop HL
                      	
                      	; ld A,"l"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0FA6  C9            	 ret
                      	
                      	
  0FA7                	wall_ck_ldd:
  0FA7  213C11        	 ld HL,map_memry_top-16
                      	;x+C
  0FAA  59            	 ld E,C
  0FAB  1600          	 ld D,0
  0FAD  19            	 add HL,DE
                      	;y+16*B
  0FAE  111000        	 ld DE,16
  0FB1  04            	 inc B
  0FB2                	wall_ck_ld2:
  0FB2  19            	 add HL,DE
  0FB3  10FD          	 djnz wall_ck_ld2
                      	; sub HL,DE
  0FB5  222D10        	 ld (block_pointaP+1),HL
  0FB8  7E            	 ld A,(HL)
  0FB9  E680          	 and t;t(80h) or f(0)
  0FBB  E1            	 pop HL
                      	
                      	; ld A,"d"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0FBC  C9            	 ret
                      	
                      	
  0FBD                	wall_ck_lr:
  0FBD  21BB11        	 ld HL,map_memry_left-17
                      	;x+C
  0FC0  59            	 ld E,C
  0FC1  1600          	 ld D,0
  0FC3  19            	 add HL,DE
  0FC4  23            	 inc HL
                      	;y+17*B
  0FC5  111100        	 ld DE,17
  0FC8  04            	 inc B
  0FC9                	wall_ck_lr_2:
  0FC9  19            	 add HL,DE
  0FCA  10FD          	 djnz wall_ck_lr_2
                      	; or A
                      	; sbc HL,DE
  0FCC  222D10        	 ld (block_pointaP+1),HL
  0FCF  7E            	 ld A,(HL)
  0FD0  E680          	 and t;t(80h) or f(0)
  0FD2  E1            	 pop HL
                      	
                      	; ld A,"r"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0FD3  C9            	 ret
                      	
                      	
                      	
                      	
  0FD4                	wall_ck_lu:
  0FD4  212C11        	 ld HL,map_memry_top-16-16
                      	;x+C
  0FD7  59            	 ld E,C
  0FD8  1600          	 ld D,0
  0FDA  19            	 add HL,DE
                      	;y+16*B
  0FDB  111000        	 ld DE,16
  0FDE  04            	 inc B
  0FDF                	wall_ck_lu2:
  0FDF  19            	 add HL,DE
  0FE0  10FD          	 djnz wall_ck_lu2
                      	; or A
                      	; sbc HL,DE
  0FE2  222D10        	 ld (block_pointaP+1),HL
  0FE5  7E            	 ld A,(HL)
  0FE6  E680          	 and t;t(80h) or f(0)
  0FE8  E1            	 pop HL
                      	
                      	; ld A,"u"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0FE9  C9            	 ret
  0FEA                	wall_ck_end:
  0FEA  E1            	 pop HL
  0FEB  AF            	 xor A
  0FEC  C9            	 ret
                      	
                      	
                      	;******************************wall mod block**************************
                      	;********************wall mod****HL=obj_xy************************
  0FED                	wall_mod:
  0FED  010000        	 ld BC,0
  0FF0  7E            	 ld A,(HL) 
  0FF1  5F            	 ld E,A
  0FF2  23            	 inc HL
  0FF3  7E            	 ld A,(HL)
  0FF4  E63F          	 and 00111111b
  0FF6  57            	 ld D,A
  0FF7  2B            	 dec HL
                      	 
  0FF8  7B            	 ld A,E
  0FF9  D61E          	 sub 30
  0FFB  2807          	 jr z,wall_mod_l2
  0FFD                	wall_mod_l1:
  0FFD  D607          	 sub 7
  0FFF  2803          	 jr z,wall_mod_l2
  1001  30FA          	 jr nc,wall_mod_l1
  1003  4F            	 ld C,A
                      	
  1004                	wall_mod_l2
  1004  7A            	 ld A,D
  1005  B7            	 or A
  1006  2807          	 jr z,wall_mod_l4
  1008                	wall_mod_l3:
  1008  D607          	 sub 7
  100A  2803          	 jr z,wall_mod_l4
  100C  30FA          	 jr nc,wall_mod_l3
  100E  47            	 ld B,A
  100F                	wall_mod_l4
                      	; ld A,E
                      	; ld (0f0h),A
                      	; ld A,D
                      	; ld (0f1h),A
                      	; ld A,C
                      	; ld (0f4h),A
                      	; ld A,B
                      	; ld (0f5h),A
  100F  C9            	 ret
                      	 
                      	 
                      	 
                      	;*************************************matk action******************************
                      	
  1010                	matk_action_gil:
  1010  21244C        	 ld HL,gil_matk_count
  1013  5E            	 ld E,(HL)
  1014  1C            	 inc E
  1015  1D            	 dec E
  1016  C8            	 ret z
  1017  1D            	 dec E
  1018  73            	 ld (HL),E
                      	
  1019  212B4C        	 ld HL,gil_xy
  101C                	matk_action:;HL=obj address+ let push pop
  101C  08            	 ex AF,AF'
  101D  326E10        	 ld (matk_action_gil_ret+1),A
  1020  223710        	 ld (matk_action_HLP+1),HL
  1023  CD5A0F        	 call wall_ck
  1026  DA6D10        	 jp c,matk_action_gil_ret
  1029  CA6D10        	 jp z,matk_action_gil_ret
  102C                	block_pointaP:
  102C  210000        	 ld HL,overwrite		;block address
  102F  4E            	 ld C,(HL)
  1030  0C            	 inc C
  1031  CA6210        	 jp z,gil_matk_break 
  1034  3600          	 ld (HL),0
                      	 
                      	; call bls
                      	
  1036                	matk_action_HLP:
  1036  210000        	 ld HL,overwrite
  1039  227010        	 ld (matk_action_gil_ret+3),HL
                      	
  103C  5E            	 ld E,(HL)
  103D  23            	 inc HL
  103E  56            	 ld D,(HL)
  103F  7A            	 ld A,D
  1040  E6C0          	 and 11000000b
  1042  2818          	 jr z,matk_action_u
  1044  FE80          	 cp 80h
  1046  380E          	 jr c,matk_action_r
  1048  2806          	 jr z,matk_action_d
  104A                	matk_action_l:
  104A  1D            	 dec E
  104B  CDEC12        	 call grp_del
  104E  181D          	 jr matk_action_gil_ret
  1050                	matk_action_d:
  1050  14            	 inc D
  1051  CDEC12        	 call grp_del
  1054  1817          	 jr matk_action_gil_ret
  1056                	matk_action_r:
  1056  1C            	 inc E
  1057  CDEC12        	 call grp_del
  105A  1811          	 jr matk_action_gil_ret
  105C                	matk_action_u:
  105C  15            	 dec D
  105D  CDEC12        	 call grp_del
  1060  180B          	 jr matk_action_gil_ret
                      	
  1062                	gil_matk_break:
  1062  DD7ED0        	 ld A,(IX-48)
  1065  FE8F          	 cp 8fh
  1067  2004          	 jr nz,matk_action_gil_ret
  1069  AF            	 xor A
  106A  32244C        	 ld (gil_matk_count),A
  106D                	matk_action_gil_ret:
  106D  3E00          	 ld A,overwrite
  106F  210000        	 ld HL,overwrite
  1072  08            	 ex AF,AF'
  1073  C9            	 ret
                      	
                      	
                      	
  1074                	Map_make:
  1074  CDE60D        	 call cls
  1077  217A1A        	 ld HL,Map_data
  107A  3A974A        	 ld A,(floor)
  107D  3D            	 dec A
  107E  11C900        	 ld DE,96+105
  1081  CD940D        	 call xsan
  1084  114C11        	 ld DE,map_memry_top
  1087  016000        	 ld BC,96
  108A  EDB0          	 ldir
  108C  11CC11        	 ld DE,map_memry_left
  108F  3E07          	 ld A,7
  1091  13            	 inc DE
  1092                	map_make_l:
  1092  F5            	 push AF
  1093  010F00        	 ld BC,15
  1096  EDB0          	 ldir
  1098  13            	 inc DE
  1099  13            	 inc DE
  109A  F1            	 pop AF
  109B  3D            	 dec A
  109C  20F4          	 jr nz,map_make_l
  109E  111E06        	 ld DE,061eh
  10A1  DD214C11      	 ld IX,map_memry_top
  10A5  FD21CC11      	 ld IY,map_memry_left
                      	
  10A9                	map_make_l_l:
  10A9  DD7E00        	 ld A,(IX)
  10AC  E680          	 and t
  10AE  2808          	 jr z,map_make_Xe
  10B0  D5            	 push DE
  10B1  215412        	 ld HL,graph_wall+0
  10B4  CD6012        	 call grp_set
  10B7  D1            	 pop DE
  10B8                	map_make_Xe:
  10B8  DD23          	 inc IX
                      	
  10BA  FD7E00        	 ld A,(IY)
  10BD  E680          	 and t
  10BF  280F          	 jr z,map_make_Ye
  10C1  D5            	 push DE
  10C2  215A12        	 ld HL,graph_wall+6
  10C5  15            	 dec D
  10C6  15            	 dec D
  10C7  15            	 dec D
  10C8  15            	 dec D
  10C9  15            	 dec D
  10CA  15            	 dec D
  10CB  1D            	 dec E
  10CC  CD6012        	 call grp_set
  10CF  D1            	 pop DE
  10D0                	map_make_Ye:
  10D0  FD23          	 inc IY
                      	
  10D2  3E07          	 ld A,7
  10D4  83            	 add A,E
  10D5  5F            	 ld E,A
  10D6  FE8E          	 cp 142
  10D8  C2A910        	 jp nz,map_make_l_l
                      	 
  10DB  3E07          	 ld A,7
  10DD  82            	 add A,D
  10DE  57            	 ld D,A
  10DF  FE37          	 cp 55
  10E1  2807          	 jr z,map_make_end
  10E3  1E1E          	 ld E,1eh
  10E5  FD23          	 inc IY
  10E7  C3A910        	 jp map_make_l_l
  10EA                	map_make_end:
                      	;**********************left right wall***********************
  10EA  0E02          	 ld c,2
  10EC  3E1B          	 ld A,27
  10EE  32F610        	 ld (Stating_before_mkwall1+1),A
  10F1                	Stating_before_mkwall2
  10F1  1600          	 ld D,0
  10F3  0606          	 ld B,6
  10F5                	Stating_before_mkwall1:
  10F5  1E00          	 ld E,overwrite
  10F7  C5            	 push BC
  10F8  D5            	 push DE
  10F9  215303        	 ld HL,wall_grp
  10FC  0603          	 ld B,3
  10FE  CD6212        	 call grp_set+2
  1101  D1            	 pop DE
  1102  C1            	 pop BC
  1103  3E08          	 ld A,8
  1105  82            	 add A,D
  1106  57            	 ld D,A
  1107  10EC          	 djnz Stating_before_mkwall1
  1109  3E8D          	 ld A,141
  110B  32F610        	 ld (Stating_before_mkwall1+1),A
  110E  0D            	 dec C
  110F  20E0          	 jr nz,Stating_before_mkwall2
                      	
                      	;**************************wall dot set***********************
                      	
  1111  0E0F          	 ld c,15
  1113  3E24          	 ld A,36
  1115  321D11        	 ld (Stating_before_mkwall11+1),A
  1118                	Stating_before_mkwall21
  1118  1606          	 ld D,6
  111A  0606          	 ld B,6
  111C                	Stating_before_mkwall11:
  111C  1E00          	 ld E,overwrite
  111E  C5            	 push BC
  111F  D5            	 push DE
  1120  215603        	 ld HL,pole_grp
  1123  0601          	 ld B,1
  1125  CD6212        	 call grp_set+2
  1128  D1            	 pop DE
  1129  C1            	 pop BC
  112A  3E07          	 ld A,7
  112C  82            	 add A,D
  112D  57            	 ld D,A
  112E  10EC          	 djnz Stating_before_mkwall11
  1130  3A1D11        	 ld A,(Stating_before_mkwall11+1)
  1133  C607          	 add A,7
  1135  321D11        	 ld (Stating_before_mkwall11+1),A
  1138  0D            	 dec C
  1139  20DD          	 jr nz,Stating_before_mkwall21
  113B  C9            	 ret
                      	
                      	
                      	
                      	
  113C  FFFFFFFFFFFFFF	 db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh;16
  114C                	map_memry_top:;1(ture or false)0000000(loop count,7fh=Outer wall)b
  114C                	 ds 16
  115C                	 ds 16
  116C                	 ds 16
  117C                	 ds 16
  118C                	 ds 16
  119C                	 ds 16
  11AC  FFFFFFFFFFFFFF	 db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh;16
  11BC  FFFFFFFFFFFFFF	 db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh;16
                      	
                      	
                      	
  11CC                	map_memry_left:;1(ture or false)0000000(loop count,7fh=Outer wall)b
  11CC  FF            	 db 0ffh
  11CD                	 ds 15
  11DC  FF            	 db 0ffh
  11DD  FF            	 db 0ffh
  11DE                	 ds 15
  11ED  FF            	 db 0ffh
  11EE  FF            	 db 0ffh
  11EF                	 ds 15
  11FE  FF            	 db 0ffh
  11FF  FF            	 db 0ffh
  1200                	 ds 15
  120F  FF            	 db 0ffh
  1210  FF            	 db 0ffh
  1211                	 ds 15
  1220  FF            	 db 0ffh
  1221  FF            	 db 0ffh
  1222                	 ds 15
  1231  FF            	 db 0ffh
  1232  FF            	 db 0ffh
  1233                	 ds 15
  1242  FF            	 db 0ffh
  1243  FF            	 db 0ffh
                      	 
  1244                	 ds 15
  1253  FF            	 db 0ffh
  1254                	graph_wall:
  1254  010101010101  	 db 1,1,1,1,1,1
  125A  3F0000000000  	 db 3fh,0,0,0,0,0
                      	
                      	
                      	
  1260                	grp_set:;HL_data,DE_(y,x),B_databit
  1260  0606          	 ld B,6
                      	;
                      	
  1262  7A            	 ld A,D
  1263  E6C0          	 and 11000000b
  1265  281F          	 jr z,grp_set_0
  1267  FE80          	 cp 80h
  1269  3814          	 jr c,grp_set_1
  126B  2809          	 jr z,grp_set_2
                      	;left
  126D  3E12          	 ld A,18
  126F  85            	 add A,L
  1270  6F            	 ld L,A
  1271  3013          	 jr nc,grp_set_0
  1273  24            	 inc H
  1274  1810          	 jr grp_set_0
                      	;dowm
  1276                	grp_set_2:
  1276  3E0C          	 ld A,12
  1278  85            	 add A,L
  1279  6F            	 ld L,A
  127A  300A          	 jr nc,grp_set_0
  127C  24            	 inc H
  127D  1807          	 jr grp_set_0
                      	;right
  127F                	grp_set_1:
  127F  3E06          	 ld A,6
  1281  85            	 add A,L
  1282  6F            	 ld L,A
  1283  3001          	 jr nc,grp_set_0
  1285  24            	 inc H
                      	
                      	;up,non direction
  1286                	grp_set_0:
  1286  7B            	 ld A,E
  1287  32AD12        	 ld (grp_set_or1+1),A
  128A  7A            	 ld A,D
  128B  E63F          	 and 3fh
  128D  1600          	 ld D,0
  128F                	grp_set_set1:
  128F  14            	 inc D
  1290  D608          	 sub 8
  1292  30FB          	 jr nc,grp_set_set1
  1294  15            	 dec D
  1295  C608          	 add A,8
  1297                	grp_set_set2:
  1297  32B612        	 ld (grp_set_shiftd_bit+1),A
  129A  4F            	 ld C,A
  129B  3E08          	 ld A,8
  129D  91            	 sub C
  129E  32DC12        	 ld (grp_set_shiftu_bit+1),A
                      	
  12A1                	grp_set_shiftd:
  12A1  7A            	 ld A,D			;line number
  12A2  E5            	 push HL					;HL
  12A3  21ED13        	 ld HL,grapu_area
  12A6  119000        	 ld DE,144
  12A9  CD940D        	 call xsan		;y+
  12AC                	grp_set_or1:
  12AC  1E00          	 ld E,overwrite
  12AE  1600          	 ld D,0
  12B0  19            	 add HL,DE		;x+
  12B1  EB            	 ex DE,HL
  12B2  E1            	 pop HL			;data
  12B3  E5            	 push HL					;HL
  12B4  C5            	 push BC						;BC
  12B5                	grp_set_shiftd_bit:
  12B5  0E00          	 ld C,overwrite		;shift bit count
  12B7  7E            	 ld A,(HL)
  12B8  08            	 ex AF,AF'
  12B9  79            	 ld A,C
  12BA  B7            	 or A
  12BB  2807          	 jr z,grp_set_shiftd_bit_2
  12BD  08            	 ex AF,AF'
  12BE                	grp_set_shiftd_bit_l:
  12BE  CB27          	 sla A
  12C0  0D            	 dec C
  12C1  20FB          	 jr nz,grp_set_shiftd_bit_l
  12C3  08            	 ex AF,AF'
  12C4                	grp_set_shiftd_bit_2:
  12C4  08            	 ex AF,AF'
  12C5  4F            	 ld C,A
  12C6  1A            	 ld A,(DE)
  12C7                	grp_set_change1:
  12C7  B1            	 or C
  12C8  12            	 ld (DE),A
  12C9                	grp_set_shiftd_l:
  12C9  23            	 inc HL
  12CA  13            	 inc DE
  12CB  10E8          	 djnz grp_set_shiftd_bit
                      	
                      	; dec DE
                      	
  12CD  EB            	 ex DE,HL
  12CE  119000        	 ld DE,144
  12D1  19            	 add HL,DE
                      	
                      	
  12D2  C1            	 pop BC						;HL
  12D3  7D            	 ld A,L
  12D4  90            	 sub B
  12D5  3001          	 jr nc,grp_set_shiftu_bit_b
  12D7  25            	 dec H
  12D8                	grp_set_shiftu_bit_b:
  12D8  6F            	 ld L,A
  12D9  EB            	 ex DE,HL
                      	
  12DA  E1            	 pop HL			;data2
  12DB                	grp_set_shiftu_bit:
  12DB  0E00          	 ld C,overwrite		;shift bit count
  12DD  7E            	 ld A,(HL)
  12DE                	grp_set_shiftu_bit_l
  12DE  CB3F          	 srl A
  12E0  0D            	 dec C
  12E1  20FB          	 jr nz,grp_set_shiftu_bit_l
  12E3  4F            	 ld C,A
  12E4  1A            	 ld A,(DE)
  12E5                	grp_set_change2:
  12E5  B1            	 or C
  12E6  12            	 ld (DE),A
  12E7                	grp_set_shiftu_l:
  12E7  23            	 inc HL
  12E8  13            	 inc DE
  12E9  10F0          	 djnz grp_set_shiftu_bit
                      	
                      	; call grp_o;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  12EB  C9            	 ret
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
  12EC                	grp_del:;HL_data,DE_(y,x),B_databit
  12EC  215713        	 ld HL,del_graph
  12EF  0606          	 ld B,6
  12F1  7B            	 ld A,E
  12F2  321813        	 ld (grp_set_or1d+1),A
  12F5  7A            	 ld A,D
  12F6  E63F          	 and 3fh
  12F8  1600          	 ld D,0
  12FA                	grp_set_set1d:
  12FA  14            	 inc D
  12FB  D608          	 sub 8
  12FD  30FB          	 jr nc,grp_set_set1d
  12FF  15            	 dec D
  1300  C608          	 add A,8
  1302                	grp_set_set2d:
  1302  322113        	 ld (grp_set_shiftd_bitd+1),A
  1305  4F            	 ld C,A
  1306  3E08          	 ld A,8
  1308  91            	 sub C
  1309  324713        	 ld (grp_set_shiftu_bitd+1),A
                      	
  130C                	grp_set_shiftdd:
  130C  7A            	 ld A,D			;line number
  130D  E5            	 push HL					;HL
  130E  21ED13        	 ld HL,grapu_area
  1311  119000        	 ld DE,144
  1314  CD940D        	 call xsan		;y+
  1317                	grp_set_or1d:
  1317  1E00          	 ld E,overwrite
  1319  1600          	 ld D,0
  131B  19            	 add HL,DE		;x+
  131C  EB            	 ex DE,HL
  131D  E1            	 pop HL			;data
  131E  E5            	 push HL					;HL
  131F  C5            	 push BC						;BC
  1320                	grp_set_shiftd_bitd:
  1320  0E00          	 ld C,overwrite		;shift bit count
  1322  7E            	 ld A,(HL)
  1323  08            	 ex AF,AF'
  1324  79            	 ld A,C
  1325  B7            	 or A
  1326  2807          	 jr z,grp_set_shiftd_bit_2d
  1328  08            	 ex AF,AF'
  1329                	grp_set_shiftd_bit_ld:
  1329  37            	 scf
  132A  17            	 rla
  132B  0D            	 dec C
  132C  20FB          	 jr nz,grp_set_shiftd_bit_ld
  132E  08            	 ex AF,AF'
  132F                	grp_set_shiftd_bit_2d:
  132F  08            	 ex AF,AF'
  1330  4F            	 ld C,A
  1331  1A            	 ld A,(DE)
  1332                	grp_set_change1d:
  1332  A1            	 and C
  1333  12            	 ld (DE),A
  1334                	grp_set_shiftd_ld:
  1334  23            	 inc HL
  1335  13            	 inc DE
  1336  10E8          	 djnz grp_set_shiftd_bitd
                      	
                      	; dec DE
                      	
  1338  EB            	 ex DE,HL
  1339  119000        	 ld DE,144
  133C  19            	 add HL,DE
                      	
                      	
  133D  C1            	 pop BC						;HL
  133E  7D            	 ld A,L
  133F  90            	 sub B
  1340  3001          	 jr nc,grp_set_shiftu_bit_bd
  1342  25            	 dec H
  1343                	grp_set_shiftu_bit_bd:
  1343  6F            	 ld L,A
  1344  EB            	 ex DE,HL
                      	
  1345  E1            	 pop HL			;data2
  1346                	grp_set_shiftu_bitd:
  1346  0E00          	 ld C,overwrite		;shift bit count
  1348  7E            	 ld A,(HL)
  1349                	grp_set_shiftu_bit_ld
  1349  37            	 scf
  134A  1F            	 rra
  134B  0D            	 dec C
  134C  20FB          	 jr nz,grp_set_shiftu_bit_ld
  134E  4F            	 ld C,A
  134F  1A            	 ld A,(DE)
  1350                	grp_set_change2d:
  1350  A1            	 and C
  1351  12            	 ld (DE),A
  1352                	grp_set_shiftu_ld:
  1352  23            	 inc HL
  1353  13            	 inc DE
  1354  10F0          	 djnz grp_set_shiftu_bitd
  1356  C9            	 ret
                      	
  1357                	del_graph:
  1357  C0C0C0C0C0C0  	 db 0c0h,0c0h,0c0h,0c0h,0c0h,0c0h
                      	
                      	
                      	; ds 144
                      	; ds 144
                      	
  135D                	 ds 144
  13ED                	grapu_area:
  13ED                	 ds 144*6
  174D                	 ds 144
                      	 
                      	; ds 144
                      	; ds 144
                      	;********************************Graphics**********************************
  17DD                	graph_title:
  17DD  00000000000000	 db 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,80h,60h,80h,00,00,0C0h,30h,0Ch,08h,30h,0C0h,0C0h,30h,08h,10h,0E0h,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
  180F  00000000000000	 db 00,00,00,00,00,00,00,00,00,80h,0C0h,00,00,80h,60h,10h,18h,06h,01h,00h,01h,0Eh,03h,00,00,00,00,00,00,01,00,00,00,03,0Ch,30h,40h,080h,00,80h,0E0h,00,00,00,00,00,00,00,00,00
  1841  000000000000C0	 db 00,00,00,00,00,00,0C0h,30h,0Eh,01h,4Fh,66h,0F1h,0E0h,0F0h,58h,58h,40h,20h,80h,0E0h,0F8h,80h,0F0h,0C0h,0E0h,0F0h,0D8h,68h,0A9h,0C3h,42h,82h,86h,84h,0Ch,18h,79h,0F6h,0E1h,0C1h,86h,38h,0C0h,00,00,00,00,00,00
  1873  00804020180601	 db 00,80h,40h,20h,18h,06h,01h,00,00,00,00,0Fh,3Fh,7Fh,0FEh,0F8h,0F8h,0F0h,0FEh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,7Eh,7Eh,7Dh,7Dh,78h,7Dh,3Fh,1Fh,0Fh,00,00,03h,0Ch,70h,80h,00,00
  18A5  00FF0000000000	 db 00,0FFh,00,00,00,00,00,00,00,0F8h,08,08,0F0h,00,0FCh,02Eh,06Fh,0D7h,07,7Fh,80h,00,0F8h,00,0F0h,50h,4Ch,4Eh,0FFh,07,0F7h,0Fh,4Eh,4Ch,0D4h,00,0F0h,50h,48h,48h,0F8h,00,00,00,00,00,00,0Fh,30h,0C0h
  18D7  78474040404044	 db 78h,47h,40h,40h,40h,40h,44h,44h,44h,45h,45h,45h,44h,44h,45h,44h,44h,45h,44h,44h,45h,45h,45h,44h,45h,44h,44h,44h,45h,44h,44h,45h,45h,45h,45h,44h,45h,44h,44h,44h,45h,44h,44h,44h,40h,40h,40h,40h,40h,7Fh
                      	
  1909                	graph_gil_ulf:
  1909  000C3F1F0C00  	 db 00,0Ch,3Fh,1Fh,0Ch,00
  190F                	graph_gil_rlf:
  190F  00003F3F0C00  	 db 00,00,3Fh,3Fh,0Ch,00
  1915                	graph_gil_dlf:
  1915  000C1F370C00  	 db 00,0Ch,1Fh,37h,0Ch,00
  191B                	graph_gil_llf:
  191B  000C3F3F0000  	 db 00,0Ch,3Fh,3Fh,00,00
                      	
  1921                	graph_gil_urf:
  1921  000C1F3F0C00  	 db 00,0Ch,1Fh,3Fh,0Ch,00
  1927                	graph_gil_rrf:
  1927  00201F1F2C00  	 db 00,20h,1Fh,1Fh,2Ch,00
  192D                	graph_gil_drf:
  192D  000C3F170C00  	 db 00,0Ch,3Fh,17h,0Ch,00
  1933                	graph_gil_lrf:
  1933  002C1F1F2000  	 db 00,2Ch,1Fh,1Fh,20h,00
                      	
  1939                	graph_gilsw_ulf:
  1939  000C3F1F0C08  	 db 00,0Ch,3Fh,1Fh,0Ch,08
  193F  080C3F3F0C00  	 db 08h,0Ch,3Fh,3Fh,0Ch,00
  1945  080C1F370C00  	 db 08,0Ch,1Fh,37h,0Ch,00
  194B  000C3F3F0C08  	 db 00,0Ch,3Fh,3Fh,0Ch,08
                      	;graph_gilsw_urf:
  1951  000C1F3F0C08  	 db 00,0Ch,1Fh,3Fh,0Ch,08
  1957  082C1F1F2C00  	 db 08,2Ch,1Fh,1Fh,2Ch,00
  195D  080C3F170C00  	 db 08,0Ch,3Fh,17h,0Ch,00
  1963  002C1F1F2C08  	 db 00,2Ch,1Fh,1Fh,2Ch,08
                      	
  1969                	graph_gilsword_ulf:
  1969  1E0C3F1F0407  	 db 1Eh,0Ch,3Fh,1Fh,04h,07h
  196F  000E3F3F0808  	 db 00,0Eh,3Fh,3Fh,08,08
  1975  38041F3F0C1E  	 db 38h,04h,1Fh,3Fh,0Ch,1Eh
  197B  08083F3F0E00  	 db 08,08,3Fh,3Fh,0Eh,00
                      	;graph_gilsword_ulf:
  1981  1E0C1F3F0407  	 db 1Eh,0Ch,1Fh,3Fh,04,07
  1987  002E1F1F2808  	 db 00,2Eh,1Fh,1Fh,28h,08
  198D  38043F1F0C1E  	 db 38h,04h,3Fh,1Fh,0Ch,1Eh
  1993  08281F1F2E00  	 db 08,28h,1Fh,1Fh,2Eh,00
                      	
                      	
  1999                	graph_sraimd:
  1999  00181C1C1800  	 db 00,18h,1Ch,1Ch,18h,00
  199F                	graph_sraimu:
  199F  00181C1C1800  	 db 00,18h,1Ch,1Ch,18h,00
  19A5                	graph_sraimd1:
  19A5  000C1A1E0C00  	 db 00,0Ch,1Ah,1Eh,0Ch,00
  19AB                	graph_sraimu2:
  19AB  000C1A1E0C00  	 db 00,0Ch,1Ah,1Eh,0Ch,00
                      	
  19B1                	magic:
  19B1  032E3F3F2E03  	 db 03,2Eh,3Fh,3Fh,2Eh,03
  19B7                	magicr:
  19B7  00203F3F2E18  	 db 00,20h,3Fh,3Fh,2Eh,18h
  19BD                	magic3:
  19BD  182E3F3F2E18  	 db 18h,2Eh,3Fh,3Fh,2Eh,18h
  19C3                	magic4:
  19C3  182E3F3F2000  	 db 18h,2Eh,3Fh,3Fh,20h,00
                      	 
  19C9                	graph_goast:
  19C9  030E1F1F0E03  	 db 03,0Eh,1Fh,1Fh,0Eh,03
  19CF  10181E1F0F1A  	 db 10h,18h,1Eh,1Fh,0Fh,1Ah
  19D5  180E1F1F0E18  	 db 18h,0Eh,1Fh,1Fh,0Eh,18h
  19DB  1A0F1F1E1810  	 db 1Ah,0Fh,1Fh,1Eh,18h,10h
                      	 
  19E1                	graph_spell:
  19E1  000018180000  	 db 00,00,18h,18h,00,00
  19E7  000018180000  	 db 00,00,18h,18h,00,00
  19ED  000018180000  	 db 00,00,18h,18h,00,00
  19F3  000018180000  	 db 00,00,18h,18h,00,00
                      	 
                      	
  19F9                	graph_n_knightu:;r foot
  19F9  000C1F3F0407  	 db 00,0Ch,1Fh,3Fh,04,07
  19FF                	graph_n_knightr:
  19FF  00201F1F2808  	 db 00,20h,1Fh,1Fh,28h,08
  1A05                	graph_n_knightd:
  1A05  38043F1F0C00  	 db 38h,04h,3Fh,1Fh,0Ch,00
  1A0B                	graph_n_knightl:
  1A0B  08281F1F2000  	 db 08,28h,1Fh,1Fh,20h,00
                      	 
                      	;graph_n_knightu:;l foot
  1A11  000C3F1F0407  	 db 00,0Ch,3Fh,1Fh,04h,07h
                      	;graph_n_knightr:
  1A17  00003F3F0808  	 db 00,00,3Fh,3Fh,08h,08
                      	;graph_n_knightd:
  1A1D  38041F3F0C00  	 db 38h,04h,1Fh,3Fh,0Ch,00
                      	;graph_n_knightl:
  1A23  08083F3F0000  	 db 08,08,3Fh,3Fh,00,00
                      	
  1A29                	graph_key:
  1A29  20283A0D0200  	 db 20h,28h,3Ah,0Dh,02,00
  1A2F                	graph_door:
  1A2F  3E29293D293E  	 db 3Eh,29h,29h,3Dh,29h,3Eh
  1A35  3E3F3F3F3F3E  	 db 3Eh,3Fh,3Fh,3Fh,3Fh,3Eh
  1A3B                	graph_box:
  1A3B  1C161A161E0E  	 db 1Ch,16h,1Ah,16h,1Eh,0Eh
                      	
  1A41                	dammy:
  1A41  000000000000  	 db 0,0,0,0,0,0
  1A47  000000000000  	 db 0,0,0,0,0,0
  1A4D  000000000000  	 db 0,0,0,0,0,0
  1A53  000000000000  	 db 0,0,0,0,0,0
                      	;************************************Data**************************************
  1A59                	obj_1:
  1A59  01010101010183	 db 1,1,1,1,1,1,83h,84h,85h,8fh,0
  1A64  01010102020183	 db 1,1,1,2,2,1,83h,84h,85h,8fh,0
  1A6F  01010102020183	 db 1,1,1,2,2,1,83h,84h,85h,8fh,0
                      	
                      	
  1A7A                	Map_data:;96+105=201byte
                      	 
                      	 
  1A7A  00008080800000	 db f,f,t,t,t,f,f,f,f,f,f,t,f,t,f,f
  1A8A  00000080008000	 db f,f,f,t,f,t,f,t,f,t,t,f,t,t,f,t
  1A9A  80008080000080	 db t,f,t,t,f,f,t,f,f,f,f,f,t,f,f,t
  1AAA  00008080808000	 db f,f,t,t,t,t,f,t,f,t,f,f,f,t,f,f
  1ABA  00008080808000	 db f,f,t,t,t,t,f,t,t,f,f,t,f,t,f,t
  1ACA  80008000008000	 db t,f,t,f,f,t,f,f,t,t,f,t,t,t,f,t
                      	
  1ADA  80000000000080	 db t,f,f,f,f,f,t,f,t,t,f,f,f,f,t
  1AE9  00800000808000	 db f,t,f,f,t,t,f,t,f,f,f,t,f,t,f
  1AF8  80800080800000	 db t,t,f,t,t,f,f,t,t,t,t,f,t,t,f
  1B07  80800000008080	 db t,t,f,f,f,t,t,t,f,f,t,t,f,t,f
  1B16  80000000800080	 db t,f,f,f,t,f,t,f,t,t,t,t,t,f,t
  1B25  00008000000000	 db f,f,t,f,f,f,f,f,f,t,f,f,t,f,f
  1B34  00800080008080	 db f,t,f,t,f,t,t,f,f,f,f,f,t,f,f
                      	 
  1B43  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f;d
  1B53  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1B63  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1B73  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1B83  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1B93  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	
  1BA3  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1BB2  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1BC1  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1BD0  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1BDF  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1BEE  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1BFD  00000000000000	 db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
  1C0C                	 ds 201*59
                      	 
  4A5F                	hp_table1:
  4A5F  01010101010101	 db 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  4A6F                	hp_table2:
  4A6F  01010101181818	 db 1,1,1,1,24,24,24,1,1
  4A78                	hp_table3:
  4A78  18303060609060	 db 24,48,48,96,96,144,96
  4A7F                	hp_table4:
  4A7F  30507001181818	 db 48,80,112,1,24,24,24,96
  4A87                	hp_table5:
  4A87  01010101010101	 db 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10110000b
                      	 
                      	;**********************************Variable**************************************
  4A97  00            	floor:db 0
  4A98  0000          	pdoor_xy:dw 0		;83h
  4A9A  0000          	pkey_xy:dw 0		;85h
  4A9C  0000          	pgil_xy:dw 0		;84h,8fh
  4A9E                	obj:ds 48
  4ACE                	obj_hp:ds 48
  4AFE                	obj_wp:ds 48
  4B2E                	obj_st:ds 48
  4B5E                	obj_xy:ds 96;(x,y&d)
  4BBE                	obj_st2:ds 48
  4BEE                	obj_st3:ds 48
                      	
  4C1E  00            	gil_button:db 0
  4C1F  00            	gil_hp:db 0
  4C20  00            	gil_wp:db 0
  4C21  00            	gil_st1:db 0	;00 or ffh:right foot or left foot
  4C22  00            	gil_st2:db 0	;bit 0-6:counter,bit 7:sword set,if bit 7 enable and bit 0-6 > 0 dec (st2)
                      			;
  4C23  00            	gil_matk:db 0	;1:c,2:s,3:g,0:none
  4C24  00            	gil_matk_count:db 0	;matk use count.it is deced when use a matk.
  4C25  00            	gil_bt:db 0	;0ffh is dash enable.
  4C26  00            	gil_sword:db 0	;1:dragon,2:ex
  4C27  00            	gil_armor:db 0	;1 is hyper.
  4C28  00            	gil_gunt:db 0	;1 is hyper.
  4C29  00            	gil_shield:db 0	;1 is hyper.
  4C2A  00            	gil_neck:db 0	;1:g,2:r,3:b.
                      	
  4C2B                	gil_xy:ds 2
  4C2D                	gil_dblock:ds 2
                      	
  4C2F                	Item:
  4C2F                	matk:
  4C2F  00            	 db 0
  4C30                	boot:
  4C30  00            	 db 0
  4C31                	sword
  4C31  00            	 db 0:
  4C32                	armor
  4C32  00            	 db 0:
  4C33                	gntrt
  4C33  00            	 db 0:
  4C34                	shield:
  4C34  00            	 db 0
  4C35                	hlmt:
  4C35  00            	 db 0
  4C36                	rod:
  4C36  00            	 db 0
  4C37                	book:
  4C37  00            	 db 0
  4C38                	cndl:
  4C38  00            	 db 0
  4C39                	brns:
  4C39  00            	 db 0
  4C3A                	posion:
  4C3A  00            	 db 0
  4C3B                	key:
  4C3B  00            	 db 0
                      	
                      	
  4C3C                	end
