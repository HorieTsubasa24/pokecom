			  Z80 ASSEMBLER - ZASM VER 1.6
  0100                	org 0100h
                      	
  0000                	overwrite:equ 0
  001E                	x0:equ 30
  008C                	xm:equ 140
  0000                	y0:equ 0
  002F                	ym:equ 47
  0080                	t:equ 80h
  0000                	f:equ 0
                      	
  BFD0                	grp:equ 0bfd0h
  BFF1                	msp:equ 0bff1h
  BCFD                	kwait:equ 0bcfdh
  BE53                	kscan:equ 0be53h
                      	
                      	
                      	
                      	;*******************Title graph********************
  0100                	start:
  0100  210000        	 ld HL,0
  0103  39            	 add HL,SP
  0104  22270D        	 ld (retP+1),HL
  0107  CDAF0D        	 call cls 
  010A  215817        	 ld HL,graph_title
  010D  110800        	 ld DE,0008h
  0110  0632          	 ld B,50
  0112  CDFA0D        	 call grp_open
  0115                	start_l:
  0115  3E01          	 ld A,1
  0117  324949        	 ld (floor),A
  011A  CD090E        	 call keysc		;left,right,on,0,/,space,down,up
  011D  CB57          	 bit 2,A
  011F  C0            	 ret nz
  0120  CB5F          	 bit 3,A
  0122  2006          	 jr nz,before_game_c
  0124  CB6F          	 bit 5,A
  0126  2052          	 jr nz,init
  0128  18EB          	 jr start_l
                      	;*****************Continue*******************
  012A                	before_game_c:
  012A  CB6F          	 bit 5,A
  012C  28E7          	 jr z,start_l
  012E  CDAF0D        	 call cls
  0131  217A03        	 ld HL,continue_ms
  0134  110201        	 ld DE,0102h
  0137  0612          	 ld B,18
  0139  CDF1BF        	 call msp
  013C  2A4949        	 ld HL,(floor)
  013F  2600          	 ld H,0
  0141  CD690D        	 call ascn
  0144                	before_game_c_floor:
  0144  2A4949        	 ld HL,(floor)
  0147  2600          	 ld H,0
  0149  CD690D        	 call ascn
  014C  21670D        	 ld HL,nmemry+3
  014F  110B03        	 ld DE,030bh
  0152  0602          	 ld B,2
  0154  CDF1BF        	 call msp
  0157  CDFDBC        	 call kwait
  015A  214949        	 ld HL,floor
  015D  FE1E          	 cp 1eh
  015F  2827          	 jr z,Stating_before
  0161  FE20          	 cp 20h
  0163  280C          	 jr z,before_game_c_u
  0165  FE1F          	 cp 1fh
  0167  20DB          	 jr nz,before_game_c_floor
  0169                	before_game_c_d:
  0169  35            	 dec (HL)
  016A  AF            	 xor A
  016B  BE            	 cp (HL)
  016C  20D6          	 jr nz,before_game_c_floor
  016E  34            	 inc (HL)
  016F  18D3          	 jr before_game_c_floor
  0171                	before_game_c_u:
  0171  34            	 inc (HL)
  0172  3E3D          	 ld A,61
  0174  BE            	 cp (HL)
  0175  20CD          	 jr nz,before_game_c_floor
  0177  35            	 dec (HL)
  0178  18CA          	 jr before_game_c_floor
                      	 
                      	 
                      	 
                      	;***************init************************** 
                      	
  017A                	init:
  017A  21D54A        	 ld HL,gil_matk
  017D  11D64A        	 ld DE,gil_matk+1
  0180  011600        	 ld BC,22
  0183  3E00          	 ld A,0
  0185  77            	 ld (HL),A
  0186  EDB0          	 ldir
                      	 
                      	 
                      	;***************Starting game****************
                      	;***************massage*********************
  0188                	Stating_before:
  0188  CDAF0D        	 call cls
  018B  216203        	 ld HL,stating_ms1
  018E  110801        	 ld DE,0108h
  0191  0609          	 ld B,9
  0193  CDF1BF        	 call msp
  0196  216B03        	 ld HL,stating_ms2
  0199  110802        	 ld De,0208h
  019C  060A          	 ld B,10
  019E  CDF1BF        	 call msp
  01A1  217503        	 ld HL,stating_msf
  01A4  110804        	 ld De,0408h
  01A7  0605          	 ld B,5
  01A9  CDF1BF        	 call msp
  01AC  2A4949        	 ld HL,(floor)
  01AF  2600          	 ld H,0
  01B1  CD690D        	 call ascn
  01B4  21670D        	 ld HL,nmemry+3
  01B7  110E04        	 ld DE,040eh
  01BA  0602          	 ld B,2
  01BC  CDF1BF        	 call msp
  01BF  CD320D        	 call tim255
  01C2  CDFDBC        	 call kwait
                      	
                      	
                      	;***********************free aria cleen****************
  01C5  21BC19        	 ld HL,dammy
  01C8  AF            	 xor A
  01C9  77            	 ld (HL),A
  01CA  11BD19        	 ld DE,dammy+1
  01CD  011700        	 ld BC,23
  01D0  EDB0          	 ldir
                      	
                      	;***********************map set************************
  01D2  CD3D10        	 call Map_make
                      	
                      	
                      	;**********************left right wall***********************
  01D5  0E02          	 ld c,2
  01D7  3E1B          	 ld A,27
  01D9  32E101        	 ld (Stating_before_mkwall1+1),A
  01DC                	Stating_before_mkwall2
  01DC  1600          	 ld D,0
  01DE  0606          	 ld B,6
  01E0                	Stating_before_mkwall1:
  01E0  1E00          	 ld E,overwrite
  01E2  C5            	 push BC
  01E3  D5            	 push DE
  01E4  218C03        	 ld HL,wall_grp
  01E7  0603          	 ld B,3
  01E9  CDDA11        	 call grp_set+2
  01EC  D1            	 pop DE
  01ED  C1            	 pop BC
  01EE  3E08          	 ld A,8
  01F0  82            	 add A,D
  01F1  57            	 ld D,A
  01F2  10EC          	 djnz Stating_before_mkwall1
  01F4  3E8D          	 ld A,141
  01F6  32E101        	 ld (Stating_before_mkwall1+1),A
  01F9  0D            	 dec C
  01FA  20E0          	 jr nz,Stating_before_mkwall2
                      	
                      	;**************************wall dot set***********************
                      	
  01FC  0E0F          	 ld c,15
  01FE  3E24          	 ld A,36
  0200  320802        	 ld (Stating_before_mkwall11+1),A
  0203                	Stating_before_mkwall21
  0203  1606          	 ld D,6
  0205  0606          	 ld B,6
  0207                	Stating_before_mkwall11:
  0207  1E00          	 ld E,overwrite
  0209  C5            	 push BC
  020A  D5            	 push DE
  020B  218F03        	 ld HL,pole_grp
  020E  0601          	 ld B,1
  0210  CDDA11        	 call grp_set+2
  0213  D1            	 pop DE
  0214  C1            	 pop BC
  0215  3E07          	 ld A,7
  0217  82            	 add A,D
  0218  57            	 ld D,A
  0219  10EC          	 djnz Stating_before_mkwall11
  021B  3A0802        	 ld A,(Stating_before_mkwall11+1)
  021E  C607          	 add A,7
  0220  320802        	 ld (Stating_before_mkwall11+1),A
  0223  0D            	 dec C
  0224  20DD          	 jr nz,Stating_before_mkwall21
                      	
                      	
                      	;********************************obj set***************************
                      	
                      	;***********************init************************
  0226                	stating_obj:
  0226  215049        	 ld HL,obj
  0229  3600          	 ld (HL),0
  022B  115149        	 ld DE,obj+1
  022E  015001        	 ld BC,48+48+48+96+48+48
  0231  EDB0          	 ldir
                      	;***********************obj countor**************
  0233  21D419        	 ld HL,obj_1
  0236  3A4949        	 ld A,(floor)
  0239  3D            	 dec A
  023A  280B          	 jr Z,stating_obj_1
                      	
  023C  57            	 ld D,A
                      	;*********************0=end sign****next floor data***ldi loop**********
  023D                	stating_obj_2:
  023D  010000        	 ld BC,0
  0240  3E00          	 ld A,0
  0242  EDB1          	 cpir
  0244  15            	 dec D
  0245  20F6          	 jr nz,stating_obj_2
  0247                	stating_obj_1:
  0247  115049        	 ld DE,obj
  024A                	stating_obj_3:
  024A  7E            	 ld A,(HL)
  024B  B7            	 or A
  024C  2804          	 jr z,stating_obj_7
  024E  EDA0          	 ldi
  0250  18F8          	 jr stating_obj_3
                      	
                      	;*********************obj cp= then goto mainbefore***************
                      	
  0252                	stating_obj_7:
  0252  215049        	 ld HL,obj
  0255  110000        	 ld DE,0
  0258                	stating_obj_4:
  0258  AF            	 xor A
  0259  BE            	 cp (HL)
  025A  CADA02        	 jp z,main_before		;stating_obj_hp
  025D  E5            	 push HL
  025E  D5            	 push DE
                      	
                      	;x=x+7*A
  025F  ED5F          	 ld A,R;call rand
  0261  E60F          	 and 0fh		;a=0~15
  0263  211E00        	 ld HL,001eh	;30
  0266  110700        	 ld DE,0007h
  0269  CD5D0D        	 call xsan
                      	
                      	
                      	;y=y+7*A
  026C  CD420D        	 call rand
  026F                	stating_obj_5:
  026F  D606          	 sub 6
  0271  30FC          	 jr nc,stating_obj_5
  0273  C606          	 add A,6
  0275  110007        	 ld DE,0700h
  0278  CD5D0D        	 call xsan
                      	
  027B  D1            	 pop DE
  027C  E5            	 push HL		;xy
                      	
  027D  21104A        	 ld HL,obj_xy		;address
  0280  19            	 add HL,DE		;address+
                      	
  0281  CD9402        	 call stating_obj_hp_wp
                      	
  0284  19            	 add HL,DE		;address++
  0285  228B02        	 ld (stating_obj_6+1),HL
                      	; add HL,DE		;address++(direction)
  0288  13            	 inc DE
                      	
  0289  E1            	 pop HL
                      	
                      	; ld HL,151eh;(30,0)
                      	
  028A                	stating_obj_6:
  028A  220000        	 ld (overwrite),HL
  028D  22DD4A        	 ld (gil_xy),HL
  0290  E1            	 pop  HL
  0291  23            	 inc HL
  0292  18C4          	 jr stating_obj_4
                      	
                      	;*********************obs  hp  wp set*********************
  0294                	stating_obj_hp_wp:
  0294  E5            	 push HL
  0295  D5            	 push DE
  0296  21C502        	 ld HL,stating_obj_hp_wp6
  0299  E5            	 push HL
                      	
  029A  215049        	 ld HL,obj
  029D  19            	 add HL,DE
  029E  7E            	 ld A,(HL)
  029F  E60F          	 and 0fh
  02A1  CB7E          	 bit 7,(HL)
  02A3  201C          	 jr nz,stating_obj_hp_wp5
  02A5  CB76          	 bit 6,(HL)
  02A7  2014          	 jr nz,stating_obj_hp_wp4
  02A9  CB6E          	 bit 5,(HL)
  02AB  200C          	 jr nz,stating_obj_hp_wp3
  02AD  CB66          	 bit 4,(HL)
  02AF  2004          	 jr nz,stating_obj_hp_wp2
  02B1                	stating_obj_hp_wp1:
  02B1  211149        	 ld HL,hp_table1
  02B4  C9            	 ret
  02B5                	stating_obj_hp_wp2:
  02B5  212149        	 ld HL,hp_table2
  02B8  C9            	 ret
  02B9                	stating_obj_hp_wp3:
  02B9  212A49        	 ld HL,hp_table3
  02BC  C9            	 ret
  02BD                	stating_obj_hp_wp4:
  02BD  213149        	 ld HL,hp_table4
  02C0  C9            	 ret
  02C1                	stating_obj_hp_wp5:
  02C1  213949        	 ld HL,hp_table5
  02C4  C9            	 ret
  02C5                	stating_obj_hp_wp6:
  02C5  5F            	 ld E,A
  02C6  1D            	 dec E
  02C7  1600          	 ld D,0
  02C9  19            	 add HL,DE
  02CA  7E            	 ld A,(HL)
  02CB  D1            	 pop DE
  02CC  218049        	 ld HL,obj_hp
  02CF  19            	 add HL,DE
  02D0  77            	 ld (HL),A
  02D1  E1            	 pop HL
  02D2  E67F          	 and 01111111b
                      	 ;********************************************************HP*******************************
  02D4  3E38          	 ld A,00111000b
  02D6  32D14A        	 ld (gil_hp),A
  02D9  C9            	 ret	;gil is end of data.
                      	
                      	
                      	
                      	;wall
                      	
                      	
                      	
                      	
                      	;****************before farse***pgil_xy set**************
                      	
  02DA                	main_before:
  02DA  2ADD4A        	 ld HL,(gil_xy)
  02DD  224E49        	 ld (pgil_xy),HL 
  02E0  21D419        	 ld HL,obj_1
  02E3  3A4949        	 ld A,(floor)
  02E6  3D            	 dec A
  02E7  2810          	 jr z,main_before_15
  02E9  57            	 ld D,A
  02EA  AF            	 xor A
  02EB  010000        	 ld BC,0
  02EE                	main_before_1:
  02EE  EDB1          	 cpir
  02F0  15            	 dec D
  02F1  20FB          	 jr nz,main_before_1
  02F3  215049        	 ld HL,obj
  02F6  B7            	 or A
  02F7  ED42          	 sbc HL,BC		;it's start pointa**obj++
                      	
                      	
                      	;******************door set****************************
  02F9                	main_before_15:
  02F9  E5            	 push HL		;obj
  02FA  3E83          	 ld A,83h
  02FC  010000        	 ld BC,0
                      	;main_before_2:
  02FF  EDB1          	 cpir
  0301  03            	 inc BC
  0302  21104A        	 ld HL,obj_xy
  0305  B7            	 or A
  0306  ED42          	 sbc HL,BC
  0308  B7            	 or A
  0309  ED42          	 sbc HL,BC
  030B  5E            	 ld E,(HL)
  030C  23            	 inc HL
  030D  56            	 ld D,(HL)
  030E  ED534A49      	 ld (pdoor_xy),DE
                      	
                      	;*****************key set*******************************
                      	
  0312  E1            	 pop HL
  0313  3E85          	 ld A,85h
  0315  010000        	 ld BC,0
                      	;main_before_3:
  0318  EDB1          	 cpir
  031A  03            	 inc BC
  031B  21104A        	 ld HL,obj_xy
  031E  B7            	 or A
  031F  ED42          	 sbc HL,BC
  0321  B7            	 or A
  0322  ED42          	 sbc HL,BC
  0324  5E            	 ld E,(HL)
  0325  23            	 inc HL
  0326  56            	 ld D,(HL)
  0327  ED534C49      	 ld (pkey_xy),DE
  032B  AF            	 xor A
  032C  32ED4A        	 ld (key),A
                      	
                      	;*********************obj cross gil********************
                      	
  032F  2ADD4A        	 ld HL,(gil_xy)
  0332  4D            	 ld C,L
  0333  44            	 ld B,H
  0334  21104A        	 ld HL,obj_xy
  0337                	main_before_gil:
  0337  E5            	 push HL
  0338  5E            	 ld E,(HL)
  0339  23            	 inc HL
  033A  56            	 ld D,(HL)
  033B  EB            	 ex DE,HL
  033C  B7            	 or A
  033D  ED42          	 sbc HL,BC
  033F  E1            	 pop HL
  0340  2804          	 jr z,main_before_gil_z
  0342  23            	 inc HL
  0343  23            	 inc HL
  0344  18F1          	 jr main_before_gil
  0346                	main_before_gil_z:
  0346  23            	 inc HL
  0347  23            	 inc HL
  0348  7E            	 ld A,(HL)
  0349  B7            	 or A
  034A  C22602        	 jp nz,stating_obj
                      	 
  034D  3A8B02        	 ld A,(stating_obj_6+1)
  0350  6F            	 ld L,A
  0351  3A8C02        	 ld A,(stating_obj_6+2)
  0354  67            	 ld H,A
  0355  3E15          	 ld A,21
  0357  77            	 ld (HL),A
  0358  23            	 inc HL
  0359  3E2A          	 ld A,42
  035B  77            	 ld (HL),A
  035C  22F000        	 ld (0f0h),HL
                      	
  035F  C39003        	 jp main
                      	
                      	
                      	
                      	
                      	
                      	
                      	
  0362                	stating_ms1:
  0362  47455420524541	 db "GET READY"
  036B                	stating_ms2:
  036B  504C4159455220	 db "PLAYER ONE"
  0375                	stating_msf:
  0375  464C4F4F52    	 db "FLOOR"
  037A                	continue_ms:
  037A  53454C45435420	 db "SELECT START FLOOR"
  038C                	wall_grp:
  038C  FFFFFF        	 db 0ffh,0ffh,0ffh
  038F                	pole_grp:
  038F  01            	 db 1h
                      	;**************************************************************************************
                      	;************************************Main*********************************************
                      	;**************************************************************************************
  0390                	main:
  0390  CDE30D        	 call grp_o
                      	; call tim30
  0393  3E30          	 ld A,48
  0395  32A403        	 ld (count+1),A
  0398  21104A        	 ld HL,obj_xy
  039B  DD218049      	 ld IX,obj_hp
  039F  FD21704A      	 ld IY,obj_st2
  03A3                	mains:
                      	
  03A3                	count:
  03A3  3E00          	 ld A,overwrite
  03A5  B7            	 or A
  03A6  CA9003        	 jp z,main
                      	;unknown_ID_throght(0)
  03A9  DD7ED0        	 ld A,(IX-48)
  03AC  B7            	 or A
  03AD  CA0E0D        	 jp z,mains_end
                      	;count out then main
                      	
                      	;graph_delete
                      	
  03B0  E5            	 push HL		;>
  03B1  5E            	 ld E,(HL)
  03B2  23            	 inc HL
  03B3  56            	 ld D,(HL)
  03B4  CD6712        	 call grp_del
  03B7  E1            	 pop HL		;<
                      	;hp_zero_throght
                      	
  03B8  DD7E00        	 ld A,(IX)
  03BB  B7            	 or A
  03BC  CA0E0D        	 jp z,mains_end
                      	
                      	
                      	
                      	
                      	;******************************ivent action **********************
                      	 
  03BF  DD7ED0        	 ld A,(IX-48)
  03C2  47            	 ld B,A
  03C3  E6E0          	 and 0e0h
  03C5  C24504        	 jp nz,st_action
  03C8  78            	 ld A,B
  03C9  FE0A          	 cp 0ah
  03CB  CA4A07        	 jp z,spells_action
  03CE  FE0B          	 cp 0bh
  03D0  CA4A07        	 jp z,spells_action
                      	
                      	;wp
  03D3  DD7E30        	 ld A,(IX+48)
  03D6  B7            	 or A
                      	
                      	;wp=0
  03D7  CAE903        	 jp z,st_check
                      	
                      	
                      	
                      	;wp>0
  03DA  3D            	 dec A
  03DB  DD7730        	 ld (IX+48),A
  03DE  DD7ED0        	 ld A,(IX-48);(Syubetsu)
  03E1  CB67          	 bit 4,A
  03E3  CA0305        	 jp z,sraim_move3_e;(suraimuGPRINT)
  03E6  C39D05        	 jp wizard_move_e_wpp
                      	; jp wizard_act_e
                      	; jp nz,mains_end
                      	; jp st_check
  03E9                	st_check:
  03E9  DD7E60        	 ld A,(IX+96)
  03EC  B7            	 or A
  03ED  C23E04        	 jp nz,st_dec
                      	
                      	;wp=0,st=0
                      	;wp setting((di)=move lutin)
                      	
  03F0  DD7ED0        	 ld A,(IX-48);(Syurui)
  03F3  CB67          	 bit 4,A
  03F5  2808          	 jr z,wp_str_b
  03F7  ED5F          	 ld A,R;		(wizard)
  03F9  E61F          	 and 00011111b
  03FB  CBEF          	 set 5,A
  03FD  182A          	 jr wp_str
  03FF                	wp_str_b:
  03FF  F5            	 push AF
  0400  ED5F          	 ld A,R
  0402  E67F          	 and 7fh
  0404  47            	 ld B,A
  0405  ED5F          	 ld A,R
  0407  E67F          	 and 7fh
  0409  80            	 add A,B
  040A  47            	 ld B,A
  040B  F1            	 pop AF
  040C  FE02          	 cp 2
  040E  3816          	 jr c,wp_G
  0410  280F          	 jr z,wp_B
  0412  FE04          	 cp 4
  0414  78            	 ld A,B
  0415  3806          	 jr c,wp_R
  0417  2804          	 jr z,wp_BL
  0419                	wp_D:
  0419                	wp_DY:
  0419  E608          	 and 8
  041B  180C          	 jr wp_str
  041D                	wp_BL:
  041D                	wp_R:
  041D  E610          	 and 16
  041F  1808          	 jr wp_str
  0421                	wp_B:
  0421  78            	 ld A,B
  0422  E608          	 and 8
  0424  1803          	 jr wp_str
  0426                	wp_G:
  0426  78            	 ld A,B
  0427  E610          	 and 16
  0429                	wp_str:
  0429  C608          	 add A,8
  042B  DD7730        	 ld (IX+48),A
  042E  3E19          	 ld A,25
  0430  DD7760        	 ld (IX+96),A
                      	
  0433  DD7ED0        	 ld A,(IX-48);(Syubetsu)
  0436  CB67          	 bit 4,A
  0438  CA0305        	 jp z,sraim_move3_e;(suraimuGPRINT)
  043B  C39D05        	 jp wizard_move_e_wpp;(wizard not print)mains_end
                      	; jp Egraph;
                      	
                      	
                      	
                      	;wp=0,st=x
  043E                	st_dec:
  043E  3D            	 dec A
  043F  DD7760        	 ld (IX+96),A
  0442  C38C04        	 jp sraim_or_wiz_action
                      	 
                      	 
                      	;***********************************knight,quox,ivent*********************************
  0445                	st_action:;Individual action
                      	; call bls
  0445  DD7ED0        	 ld A,(IX-48)
  0448  FE45          	 cp 45h
  044A  CA1D06        	 jp z,goast_action
  044D  FE46          	 cp 46h
  044F  CA1D06        	 jp z,goast_action
  0452  CB6F          	 bit 5,A
  0454  C24A08        	 jp nz,knight_action
  0457  FE83          	 cp 83h
  0459  CA130B        	 jp z,door_action
  045C  FE84          	 cp 84h
  045E  CA900A        	 jp z,box_action
  0461  FE85          	 cp 85h
  0463  CA700A        	 jp z,key_action
  0466  FE8F          	 cp 8fh
  0468  CA6E0B        	 jp z,gil_action
  046B  C30E0D        	 jp mains_end
                      	
  046E  32F000        	 ld (0f0h),A
  0471  DD7ED0        	 ld A,(IX-48)
  0474  32F400        	 ld (0f4h),A
  0477  DD7E00        	 ld A,(IX-0)
  047A  32F500        	 ld (0f5h),A
  047D  DD7E30        	 ld A,(IX+48)
  0480  32F600        	 ld (0f6h),A
  0483  DD7E60        	 ld A,(IX+96)
  0486  32F700        	 ld (0f7h),A
  0489  C3260D        	 jp retP
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	;****************************************************************************
                      	;*********************************sraim or wiz*******************************
                      	
  048C                	sraim_or_wiz_action:;HL=obj_xy++
  048C  DDCBD066      	 bit 4,(IX-48);(NO.)
  0490  C23805        	 jp nz,wiz_action
                      	
                      	 ;;;;
                      	 ;;;;
  0493  DD7E60        	 ld A,(IX+96);(st)
                      	 
                      	; ld (0f0h),A
                      	; jp retP
                      	
  0496  FE09          	 cp 9
  0498  280B          	 jr z,sraim_move1_B
  049A  FE05          	 cp 5
  049C  2823          	 jr z,sraim_move1
  049E  FE01          	 cp 1
  04A0  283F          	 jr z,sraim_move3
  04A2  C30305        	 jp sraim_move3_e;mains_end
                      	
                      	
  04A5                	sraim_move1_B:
  04A5  CD230F        	 call wall_ck
  04A8  2817          	 jr z,sraim_move1
  04AA  23            	 inc HL
  04AB  CBBE          	 res 7,(HL)
  04AD  CBB6          	 res 6,(HL)
  04AF  ED5F          	 ld A,R
                      	; rla
  04B1  1F            	 rra
  04B2  1F            	 rra
  04B3  1F            	 rra
  04B4  E6C0          	 and 0c0h
  04B6  B6            	 or (HL)
  04B7  77            	 ld (HL),A
  04B8  2B            	 dec HL
  04B9  3E50          	 ld A,80
  04BB  DD7760        	 ld (IX+96),A
  04BE  C30305        	 jp sraim_move3_e
  04C1                	sraim_move1:
                      	;graph_delete
                      	
                      	; push HL		;>
                      	; call bls
                      	; ld E,(HL)
                      	; inc HL
                      	; ld D,(HL)
                      	; call grp_del
                      	; pop HL		;<
                      	
                      	
  04C1  23            	 inc HL
  04C2  7E            	 ld A,(HL)
  04C3  E6C0          	 and 0c0h
  04C5  280B          	 jr z,sraim_move1_u
  04C7  FE80          	 cp 80h
  04C9  380C          	 jr c,sraim_move1_r
  04CB  280F          	 jr z,sraim_move1_d
  04CD                	sraim_move1_l:
  04CD  2B            	 dec HL
  04CE  35            	 dec (HL)
  04CF  35            	 dec (HL)
  04D0  1831          	 jr sraim_move3_e
  04D2                	sraim_move1_u:
  04D2  35            	 dec (HL)
  04D3  35            	 dec (HL)
  04D4  2B            	 dec HL
  04D5  182C          	 jr sraim_move3_e
  04D7                	sraim_move1_r:
  04D7  2B            	 dec HL
  04D8  34            	 inc (HL)
  04D9  34            	 inc (HL)
  04DA  1827          	 jr sraim_move3_e
  04DC                	sraim_move1_d:
  04DC  34            	 inc (HL)
  04DD  34            	 inc (HL)
  04DE  2B            	 dec HL
                      	
  04DF  1822          	 jr sraim_move3_e
                      	
                      	
  04E1                	sraim_move3:
                      	
  04E1  23            	 inc HL
  04E2  7E            	 ld A,(HL)
  04E3  E6C0          	 and 0c0h
  04E5  280C          	 jr z,sraim_move3_u
  04E7  FE80          	 cp 80h
  04E9  380E          	 jr c,sraim_move3_r
  04EB  2812          	 jr z,sraim_move3_d
  04ED                	sraim_move3_l:
  04ED  2B            	 dec HL
  04EE  35            	 dec (HL)
  04EF  35            	 dec (HL)
  04F0  35            	 dec (HL)
  04F1  1810          	 jr sraim_move3_e
  04F3                	sraim_move3_u:
  04F3  35            	 dec (HL)
  04F4  35            	 dec (HL)
  04F5  35            	 dec (HL)
  04F6  2B            	 dec HL
  04F7  180A          	 jr sraim_move3_e
  04F9                	sraim_move3_r:
  04F9  2B            	 dec HL
  04FA  34            	 inc (HL)
  04FB  34            	 inc (HL)
  04FC  34            	 inc (HL)
  04FD  1804          	 jr sraim_move3_e
  04FF                	sraim_move3_d:
  04FF  34            	 inc (HL)
  0500  34            	 inc (HL)
  0501  34            	 inc (HL)
  0502  2B            	 dec HL
  0503                	sraim_move3_e:
  0503  111419        	 ld DE,graph_sraimd
  0506                	Egraph:;(DE=)
  0506  ED530F05      	 ld (Egraph_put+1),DE
  050A  E5            	 push HL		;>
  050B  5E            	 ld E,(HL)
  050C  23            	 inc HL
  050D  56            	 ld D,(HL)
  050E                	Egraph_put:
  050E  210000        	 ld HL,overwrite
  0511  CDD811        	 call grp_set
  0514  E1            	 pop HL			;<
  0515  DD7ED0        	 ld A,(IX-48)
  0518  E6F8          	 and 11111000b
  051A  CA1E05        	 jp z,sraim_cross_ck;
  051D  C9            	 ret
                      	 
  051E                	sraim_cross_ck:
  051E  3AD44A        	 ld A,(gil_st2)
  0521  CB7F          	 bit 7,A		;(gil sworud MIRU)
  0523  2808          	 jr z,s1
  0525  CDEE0E        	 call cross_ck_a;s
  0528  DC100F        	 call c,cha_kill;(suraim HP=0)
  052B  1808          	 jr s2
  052D                	s1:;(gil_st=0-x)
  052D  CDEE0E        	 call cross_ck_a
  0530  3003          	 jr nc,s2
  0532  C3EC0C        	 jp gil_killing
                      	 
  0535                	s2:
                      	; jp c,retP
  0535  C30E0D        	 jp mains_end
                      	
                      	
                      	;******************wiz actions**Main***********************
  0538                	wiz_action:
  0538  DD7E60        	 ld A,(IX+96)
  053B  FE18          	 cp 24
  053D  CA6905        	 jp z,wiz_ap
  0540  FE0C          	 cp 12
  0542  CA8B05        	 jp z,wiz_sp
  0545  FD7E00        	 ld A,(IY)
  0548  B7            	 or A
  0549  C29105        	 jp nz,wiz_dec
  054C                	wiz_dec2:
  054C  112C19        	 ld DE,magic
  054F  CD0605        	 call Egraph
                      	;********************cross chack wiz*******************
  0552                	wizard_cross_ck;
  0552  3AD44A        	 ld A,(gil_st2)
  0555  CB7F          	 bit 7,A		;(gil sworud MIRU)
  0557  2808          	 jr z,ss1
  0559  CDEE0E        	 call cross_ck_a;s
  055C  DC100F        	 call c,cha_kill;(suraim HP=0)
  055F  1805          	 jr ss2
  0561                	ss1:;(gil_st=0-x)
  0561  CDEE0E        	 call cross_ck_a
  0564  3000          	 jr nc,wizard_end
                      	; jp gil_killing
  0566                	ss2:
  0566                	wizard_end:
                      	;********************wiz end***************************
  0566  C30E0D        	 jp mains_end
                      	
  0569                	wiz_ap:
                      	
  0569                	gil_notaction_f:
  0569  3AD04A        	 ld A,(gil_button)
  056C  DD3430        	 inc (IX+48)
  056F  DD3460        	 inc (IX+96)
  0572  E6C3          	 and 11000011b
  0574  CA6605        	 jp z,wizard_end
  0577  DD3530        	 dec (IX+48)
  057A  DD3560        	 dec (IX+96)
                      	 
  057D  DD7E60        	 ld A,(IX+96)
  0580  3E0A          	 ld A,10
  0582  FD7700        	 ld (IY),A
  0585  CDA005        	 call wiz_locate
  0588  C34C05        	 jp wiz_dec2
  058B                	wiz_sp:
  058B  CD0407        	 call spell_create
  058E  C34C05        	 jp wiz_dec2
  0591                	wiz_dec:
  0591  DD3460        	 inc (IX+96)
  0594  FD3500        	 dec (IY)
  0597  FD7E00        	 ld A,(IY)
  059A  C34C05        	 jp wiz_dec2
                      	
                      	;***********************wp>0 then noting*********************
  059D                	wizard_move_e_wpp;wp>0
  059D  C30E0D        	 jp mains_end
                      	
                      	;***********************wiz_locate**************************
  05A0                	wiz_locate:
                      	
  05A0  E5            	 push HL	;>
  05A1  21DD4A        	 ld HL,gil_xy
  05A4  5E            	 ld E,(HL);x
  05A5  23            	 inc HL
  05A6  56            	 ld D,(HL);y
                      	
                      	; ld A,E
                      	; ld (0f0h),A
                      	; ld A,D
                      	; ld (0f1h),A
                      	 
  05A7  E1            	 pop HL		;<
  05A8  ED5F          	 ld A,R
  05AA  4F            	 ld C,A
  05AB  ED5F          	 ld A,R
  05AD  E603          	 and 00000011b
  05AF  B7            	 or A
  05B0  CACE05        	 jp z,wiz_locate_left
  05B3  FE02          	 cp 2
  05B5  DAE505        	 jp c,wiz_locate_down
  05B8  CAF905        	 jp z,wiz_locate_right
  05BB                	wiz_locate_up:
  05BB  7A            	 ld A,D
  05BC  E63F          	 and 00111111b
  05BE  D60E          	 sub 14
  05C0  38DE          	 jr c,wiz_locate
  05C2  F680          	 or 10000000b
  05C4  57            	 ld D,A
                      	 
  05C5  7B            	 ld A,E
  05C6  77            	 ld (HL),A
  05C7  23            	 inc HL
  05C8  7A            	 ld A,D
  05C9  77            	 ld (HL),A
  05CA  2B            	 dec HL
                      	 
  05CB  C31106        	 jp wiz_locate_end
  05CE                	wiz_locate_left;
  05CE  7B            	 ld A,E
  05CF  D60E          	 sub 14
  05D1  FE1E          	 cp 30
  05D3  38CB          	 jr c,wiz_locate
  05D5  5F            	 ld E,A
                      	 
  05D6  7A            	 ld A,D
  05D7  E63F          	 and 00111111b
  05D9  F640          	 or 01000000b
  05DB  57            	 ld D,A
                      	 
  05DC  7B            	 ld A,E
  05DD  77            	 ld (HL),A
  05DE  23            	 inc HL
  05DF  7A            	 ld A,D
  05E0  77            	 ld (HL),A
  05E1  2B            	 dec HL
                      	 
  05E2  C31106        	 jp wiz_locate_end
  05E5                	wiz_locate_down;
  05E5  7A            	 ld A,D
  05E6  E63F          	 and 00111111b
  05E8  7A            	 ld A,D
  05E9  C60E          	 add A,14
  05EB  FE30          	 cp 47+1
  05ED  30B1          	 jr nc,wiz_locate
  05EF  57            	 ld D,A
                      	 
  05F0  7B            	 ld A,E
  05F1  77            	 ld (HL),A
  05F2  23            	 inc HL
  05F3  7A            	 ld A,D
  05F4  77            	 ld (HL),A
  05F5  2B            	 dec HL
                      	 
  05F6  C31106        	 jp wiz_locate_end
  05F9                	wiz_locate_right;
  05F9  7B            	 ld A,E
  05FA  C60E          	 add A,14
  05FC  FE88          	 cp 135+1
  05FE  D2A005        	 jp nc,wiz_locate
  0601  5F            	 ld E,A
                      	 
  0602  7A            	 ld A,D
  0603  E63F          	 and 00111111b
  0605  F6C0          	 or 11000000b
  0607  57            	 ld D,A
                      	 
  0608  7B            	 ld A,E
  0609  77            	 ld (HL),A
  060A  23            	 inc HL
  060B  7A            	 ld A,D
  060C  77            	 ld (HL),A
  060D  2B            	 dec HL
                      	 
  060E  C31106        	 jp wiz_locate_end
                      	 
                      	;
  0611                	wiz_locate_end:
  0611  CDB60F        	 call wall_mod
  0614  7E            	 ld A,(HL)
  0615  91            	 sub C
  0616  77            	 ld (HL),A 
  0617  23            	 inc HL		;>
  0618  7E            	 ld A,(HL)
  0619  90            	 sub B
  061A  77            	 ld (HL),A
  061B  2B            	 dec HL		;<
  061C  C9            	 ret
                      	 
                      	;******************************goast action***************************
  061D                	goast_action:
  061D  DD7E60        	 ld A,(IX+96)
  0620  47            	 ld B,A
  0621  DD7E00        	 ld A,(IX)
  0624  B8            	 cp B
  0625  3803          	 jr c,goast_action_b
  0627  DD7760        	 ld (IX+96),A
  062A                	goast_action_b:
  062A  DD7E30        	 ld A,(IX+48)
  062D  B7            	 or A
  062E  CA3B06        	 jp z,goast_action_a
  0631  3D            	 dec A
  0632  DD7730        	 ld (IX+48),A
  0635  CAD806        	 jp z,goast_warp_ap
  0638  C3A806        	 jp goast_end
  063B                	goast_action_a:
  063B  CDB60F        	 call wall_mod
  063E  79            	 ld A,C
  063F  B7            	 or A
  0640  C2A506        	 jp nz,goast_move
  0643  78            	 ld A,B
  0644  B7            	 or A
  0645  C2A506        	 jp nz,goast_move 
                      	 
  0648                	goast_action_0:
  0648  CD570D        	 call rand4
  064B  FE80          	 cp 80h
  064D  3803          	 jr c,goast_action_1
  064F  CD0407        	 call spell_create
  0652                	goast_action_1:
  0652  CDFD09        	 call xyload
  0655  3ADD4A        	 ld A,(gil_xy)
  0658  93            	 sub E
  0659  3004          	 jr nc,goast_cp1
  065B  2812          	 jr z,goast_y
  065D  ED44          	 neg
  065F                	goast_cp1:
  065F  4F            	 ld C,A
  0660  3ADE4A        	 ld A,(gil_xy+1)
  0663  E63F          	 and 00111111b
  0665  92            	 sub D
  0666  3004          	 jr nc,goast_cp2
  0668  280C          	 jr z,goast_x
  066A  ED44          	 neg
  066C                	goast_cp2:
  066C  B9            	 cp C
  066D  3807          	 jr c,goast_x 
  066F                	goast_y:
  066F  CDF009        	 call y_ck
  0672  3819          	 jr c,goast_up
  0674  181F          	 jr goast_do
  0676                	goast_x:
  0676  CDE809        	 call x_ck
  0679  3802          	 jr c,goast_le
  067B  1808          	 jr goast_ri
  067D                	goast_le:
  067D  23            	 inc HL
  067E  CBFE          	 set 7,(HL)
  0680  CBF6          	 set 6,(HL)
  0682  2B            	 dec HL
  0683  1818          	 jr goast_wc
  0685                	goast_ri:
  0685  23            	 inc HL
  0686  CBBE          	 res 7,(HL)
  0688  CBF6          	 set 6,(HL)
  068A  2B            	 dec HL
  068B  1810          	 jr goast_wc
  068D                	goast_up:
  068D  23            	 inc HL
  068E  CBBE          	 res 7,(HL)
  0690  CBB6          	 res 6,(HL)
  0692  2B            	 dec HL
  0693  1808          	 jr goast_wc
  0695                	goast_do:
  0695  23            	 inc HL
  0696  CBFE          	 set 7,(HL)
  0698  CBB6          	 res 6,(HL)
  069A  2B            	 dec HL
  069B  1800          	 jr goast_wc
  069D                	goast_wc:
  069D  CD230F        	 call wall_ck
  06A0  2803          	 jr z,goast_move
  06A2  C3D006        	 jp goast_warp
  06A5                	goast_move:
  06A5  CDFF08        	 call empty_move
  06A8                	goast_end:
                      	 
                      	;*****************************cross ck goast*****************************
  06A8  3AD44A        	 ld A,(gil_st2)
  06AB  B7            	 or A
  06AC  2811          	 jr z,sssss1
  06AE  CB7F          	 bit 7,A
  06B0  2808          	 jr z,sssss0
  06B2  CDEE0E        	 call cross_ck_a;s
  06B5  DC3B0A        	 call c,HP_decB;
  06B8  280D          	 jr z,sssss2
  06BA                	sssss0:
  06BA  CDEE0E        	 call cross_ck_a;
  06BD  1808          	 jr sssss2
  06BF                	sssss1:;(gil_st=0-x)
  06BF  CDEE0E        	 call cross_ck_a
  06C2  3003          	 jr nc,sssss2
  06C4  C3EC0C        	 jp gil_killing
  06C7                	sssss2:
                      	 
  06C7  114419        	 ld DE,graph_goast
  06CA  CD0605        	 call Egraph
  06CD  C30E0D        	 jp mains_end
                      	 
                      	;****************************goast sub*********************************** 
  06D0                	goast_warp:
  06D0  3E12          	 ld A,18
  06D2  DD7730        	 ld (IX+48),A
  06D5  C3A806        	 jp goast_end
                      	 
  06D8                	goast_warp_ap:
  06D8  23            	 inc HL
  06D9  7E            	 ld A,(HL)
  06DA  2B            	 dec HL
  06DB  E6C0          	 and 11000000b
  06DD  280C          	 jr z,goast_warp_ap_u
  06DF  FE80          	 cp 80h
  06E1  3810          	 jr c,goast_warp_ap_r
  06E3  2814          	 jr z,goast_warp_ap_d
  06E5                	goast_warp_ap_l:
  06E5  7E            	 ld A,(HL)
  06E6  D607          	 sub 7
  06E8  77            	 ld (HL),A
  06E9  1816          	 jr goast_warp_ap_e
  06EB                	goast_warp_ap_u:
  06EB  23            	 inc HL
  06EC  7E            	 ld A,(HL)
  06ED  D607          	 sub 7
  06EF  77            	 ld (HL),A
  06F0  2B            	 dec HL
  06F1  180E          	 jr goast_warp_ap_e
  06F3                	goast_warp_ap_r:
  06F3  7E            	 ld A,(HL)
  06F4  C607          	 add A,7
  06F6  77            	 ld (HL),A
  06F7  1808          	 jr goast_warp_ap_e
  06F9                	goast_warp_ap_d:
  06F9  23            	 inc HL
  06FA  7E            	 ld A,(HL)
  06FB  C607          	 add A,7
  06FD  77            	 ld (HL),A
  06FE  2B            	 dec HL
  06FF  1800          	 jr goast_warp_ap_e
  0701                	goast_warp_ap_e:
  0701  C3A806        	 jp goast_end
                      	 
                      	;******************************spell create*************************** 
                      	;******************************spell create*************************** 
  0704                	spell_create:
  0704  E5            	 push HL
  0705  AF            	 xor A
  0706  215049        	 ld HL,obj
  0709  AF            	 xor A
  070A  010000        	 ld BC,0
  070D  EDB1          	 cpir		;BC<0
  070F  03            	 inc BC
                      	 
                      	 
                      	; ld (HL),0	;chr clr
  0710  2B            	 dec HL		;spell address
  0711  DD7ED0        	 ld A,(IX-48)
  0714  FE13          	 cp 13h
  0716  2808          	 jr z,spellB
  0718  FE46          	 cp 46h
  071A  2804          	 jr z,spellB
  071C  360A          	 ld (HL),0Ah
  071E  1802          	 jr spellsetok
  0720                	spellB:
  0720  360B          	 ld (HL),0Bh
  0722                	spellsetok:
                      			;hp
  0722  113000        	 ld DE,48
  0725  19            	 add HL,DE
  0726  3601          	 ld (HL),1
                      	 		;st2
  0728  11F000        	 ld DE,48*5
  072B  19            	 add HL,DE
  072C  3600          	 ld (HL),0
                      	 
  072E  E1            	 pop HL
                      	 
                      	; ld (0f4h),HL
                      	
  072F  7E            	 ld A,(HL)
  0730  5F            	 ld E,A
  0731  23            	 inc HL
  0732  7E            	 ld A,(HL)
  0733  57            	 ld D,A
  0734  2B            	 dec HL
                      	 
  0735  E5            	 push HL
  0736  210000        	 ld HL,0
  0739  B7            	 or A
  073A  ED42          	 sbc HL,BC;xy_countor
  073C  B7            	 or A
  073D  ED42          	 sbc HL,BC
  073F  01104A        	 ld BC,obj_xy
  0742  09            	 add HL,BC
                      	 
                      	 
  0743  7B            	 ld A,E
  0744  77            	 ld (HL),A
  0745  23            	 inc HL
  0746  7A            	 ld A,D
  0747  77            	 ld (HL),A
                      	 
                      	; ld (0f0h),HL
                      	; ld (0f2h),BC
                      	 
                      	 
  0748  E1            	 pop HL
  0749  C9            	 ret
                      	;******************************spell action****************************
  074A                	spells_action:
  074A  FD7E00        	 ld A,(IY)
  074D  FE01          	 cp 1
  074F  CA9307        	 jp z,spells_action1
  0752  FE02          	 cp 2
  0754  CABC07        	 jp z,spells_action2
                      	
  0757  CDB60F        	 call wall_mod
  075A  78            	 ld A,B
  075B  B7            	 or A
  075C  C23708        	 jp nz,spells_action_delete
  075F  79            	 ld A,C
  0760  B7            	 or A
  0761  C23708        	 jp nz,spells_action_delete
                      	 
  0764  CD230F        	 call wall_ck
  0767  C2E907        	 jp nz,spells_action_dol
  076A                	spells_action_wiz:
  076A  23            	 inc HL
  076B  7E            	 ld A,(HL)
  076C  2B            	 dec HL
  076D  E6C0          	 and 11000000b
  076F  280A          	 jr z,spells_action_u
  0771  FE80          	 cp 80h
  0773  380C          	 jr c,spells_action_r
  0775  280E          	 jr z,spells_action_d
  0777                	spells_action_l:
  0777  35            	 dec (HL)
  0778  35            	 dec (HL)
  0779  1810          	 jr spells_action_urdl
  077B                	spells_action_u:
  077B  23            	 inc HL
  077C  35            	 dec (HL)
  077D  35            	 dec (HL)
  077E  2B            	 dec HL
  077F  180A          	 jr spells_action_urdl
  0781                	spells_action_r:
  0781  34            	 inc (HL)
  0782  34            	 inc (HL)
  0783  1806          	 jr spells_action_urdl
  0785                	spells_action_d:
  0785  23            	 inc HL
  0786  34            	 inc (HL)
  0787  34            	 inc (HL)
  0788  2B            	 dec HL
  0789  1800          	 jr spells_action_urdl
  078B                	spells_action_urdl:
  078B  3E01          	 ld A,1
  078D  FD7700        	 ld (IY),A
  0790  C3F607        	 jp spells_actionend
                      	 
                      	 
                      	 
  0793                	spells_action1:
  0793  23            	 inc HL
  0794  7E            	 ld A,(HL)
  0795  2B            	 dec HL
  0796  E6C0          	 and 11000000b
  0798  280A          	 jr z,spells_action1_u
  079A  FE80          	 cp 80h
  079C  380C          	 jr c,spells_action1_r
  079E  280E          	 jr z,spells_action1_d
  07A0                	spells_action1_l:
  07A0  35            	 dec (HL)
  07A1  35            	 dec (HL)
  07A2  1810          	 jr spells_action1_urdl
  07A4                	spells_action1_u:
  07A4  23            	 inc HL
  07A5  35            	 dec (HL)
  07A6  35            	 dec (HL)
  07A7  2B            	 dec HL
  07A8  180A          	 jr spells_action1_urdl
  07AA                	spells_action1_r:
  07AA  34            	 inc (HL)
  07AB  34            	 inc (HL)
  07AC  1806          	 jr spells_action1_urdl
  07AE                	spells_action1_d:
  07AE  23            	 inc HL
  07AF  34            	 inc (HL)
  07B0  34            	 inc (HL)
  07B1  2B            	 dec HL
  07B2  1800          	 jr spells_action1_urdl
  07B4                	spells_action1_urdl:
  07B4  3E02          	 ld A,2
  07B6  FD7700        	 ld (IY),A
  07B9  C3F607        	 jp spells_actionend
                      	 
                      	 
                      	
  07BC                	spells_action2:
  07BC  23            	 inc HL
  07BD  7E            	 ld A,(HL)
  07BE  2B            	 dec HL
  07BF  E6C0          	 and 11000000b
  07C1  280B          	 jr z,spells_action2_u
  07C3  FE80          	 cp 80h
  07C5  380E          	 jr c,spells_action2_r
  07C7  2811          	 jr z,spells_action2_d
  07C9                	spells_action2_l:
  07C9  35            	 dec (HL)
  07CA  35            	 dec (HL)
  07CB  35            	 dec (HL)
  07CC  1813          	 jr spells_action2_urdl
  07CE                	spells_action2_u:
  07CE  23            	 inc HL
  07CF  35            	 dec (HL)
  07D0  35            	 dec (HL)
  07D1  35            	 dec (HL)
  07D2  2B            	 dec HL
  07D3  180C          	 jr spells_action2_urdl
  07D5                	spells_action2_r:
  07D5  34            	 inc (HL)
  07D6  34            	 inc (HL)
  07D7  34            	 inc (HL)
  07D8  1807          	 jr spells_action2_urdl
  07DA                	spells_action2_d:
  07DA  23            	 inc HL
  07DB  34            	 inc (HL)
  07DC  34            	 inc (HL)
  07DD  34            	 inc (HL)
  07DE  2B            	 dec HL
  07DF  1800          	 jr spells_action2_urdl
  07E1                	spells_action2_urdl:
  07E1  3E00          	 ld A,0
  07E3  FD7700        	 ld (IY),A
  07E6  C3F607        	 jp spells_actionend
  07E9                	spells_action_dol:
  07E9  DD7ED0        	 ld A,(IX-48)
  07EC  FE0B          	 cp 0bh
  07EE  E5            	 push HL
  07EF  CCE50F        	 call z,matk_action
  07F2  E1            	 pop HL
  07F3  C33708        	 jp spells_action_delete
                      	 
  07F6                	spells_actionend:
  07F6                	spells_action_cross
                      	 
                      	
                      	;********************cross chack spell*******************
  07F6                	spell_cross_ck;
  07F6  CDEE0E        	 call cross_ck_a;s
  07F9  3033          	 jr nc,spell_cross_ck_end
  07FB                	spell_cross_ck_1:
                      	
  07FB  3ADE4A        	 ld A,(gil_xy+1)
  07FE  E6C0          	 and 11000000b
  0800  17            	 rla
  0801  17            	 rla
  0802  17            	 rla
  0803  47            	 ld B,A
  0804  23            	 inc HL
  0805  7E            	 ld A,(HL)
  0806  2B            	 dec HL
  0807  E6C0          	 and 11000000b
  0809  17            	 rla
  080A  17            	 rla
  080B  17            	 rla
  080C  3C            	 inc A
  080D  3C            	 inc A
  080E  E603          	 and 00000011b
  0810  4F            	 ld C,A
  0811  C5            	 push BC
                      	
  0812  3AD44A        	 ld A,(gil_st2)
  0815  CB7F          	 bit 7,A		;(gil sworud MIRU)
  0817  2009          	 jr nz,spell_cross_ck_s
  0819                	spell_cross_ck_n:
  0819  C1            	 pop BC
  081A  79            	 ld A,C
  081B  A8            	 xor B				;urdl = turdl
  081C  CA3708        	 jp z,spells_action_delete
  081F  C3EC0C        	 jp gil_killing
  0822                	spell_cross_ck_s:
  0822  C1            	 pop BC
  0823  79            	 ld A,C
  0824  3C            	 inc A
  0825  E603          	 and 00000011b
  0827  A8            	 xor B				;urdl = turdl
  0828  CA3708        	 jp z,spells_action_delete
  082B  C3EC0C        	 jp gil_killing
  082E                	spell_cross_ck_end:
  082E  115C19        	 ld DE,graph_spell
  0831  CD0605        	 call Egraph;call Egraph
  0834  C30E0D        	 jp mains_end
                      	 
  0837                	spells_action_delete:
  0837  AF            	 xor A
  0838  DD77D0        	 ld (IX-48),A
  083B  DD7700        	 ld (IX),A
  083E  FD7700        	 ld (IY),A
  0841  3600          	 ld (HL),0
  0843  23            	 inc HL
  0844  3600          	 ld (HL),0
  0846  2B            	 dec HL
  0847  C30E0D        	 jp mains_end
                      	 
                      	 
                      	
                      	 
                      	;***************************************************************
                      	;**************************knight action************************
  084A                	knight_action:;HL=obj_xy++
                      	;******************ricaba*******************
  084A  DD7E60        	 ld A,(IX+96)
  084D  47            	 ld B,A
  084E  DD7E00        	 ld A,(IX)
  0851  B8            	 cp B
  0852  3803          	 jr c,knight_actiona
  0854  DD7760        	 ld (IX+96),A
  0857                	knight_actiona:
  0857  DD7ED0        	 ld A,(IX-48)
  085A  FE23          	 cp 23h
  085C  2807          	 jr z,knight_action1
  085E  DD7E30        	 ld A,(IX+48)
  0861  B7            	 or A
  0862  CA1809        	 jp z,knight_action_end
                      	
  0865                	knight_action1:
  0865  CDB60F        	 call wall_mod
  0868  78            	 ld A,B
  0869  B7            	 or A
  086A  C2FB08        	 jp nz,knight_move
  086D  79            	 ld A,C
  086E  B7            	 or A
  086F  C2FB08        	 jp nz,knight_move
                      	 
  0872  CDD909        	 call xy_ck
  0875  CAB408        	 jp z,knight_xy
  0878  CDE809        	 call x_ck
  087B  CAC308        	 jp z,knight_x
  087E  CDF009        	 call y_ck
  0881  CADF08        	 jp z,knight_y
  0884                	kight_accel:
                      	
                      	 
  0884  CD050A        	 call right_turn
  0887  CD230F        	 call wall_ck
                      	; call z,48381
  088A  CAFB08        	 jp z,knight_move
  088D  CD130A        	 call left_turn
                      	 
  0890  CD230F        	 call wall_ck
  0893  C29908        	 jp nz,rndurdl
  0896  C3FB08        	 jp knight_move
  0899                	kight_accel_2:
  0899                	rndurdl:
  0899  CD050A        	 call right_turn
  089C  CD230F        	 call wall_ck
  089F  CAFB08        	 jp z,knight_move
                      	
  08A2  CD050A        	 call right_turn 
  08A5  CD050A        	 call right_turn
  08A8  CD230F        	 call wall_ck
  08AB  CAFB08        	 jp z,knight_move
                      	 
  08AE  CD130A        	 call left_turn 
  08B1  C3FB08        	 jp knight_move
                      	
                      	
  08B4                	knight_xy:
  08B4  23            	 inc HL
  08B5  7E            	 ld A,(HL)
  08B6  F6C0          	 or 11000000b
  08B8  77            	 ld (HL),A
  08B9  2B            	 dec HL
  08BA  CD230F        	 call wall_ck
  08BD  CAFB08        	 jp z,knight_move
  08C0  C39908        	 jp kight_accel_2 
                      	 
  08C3                	knight_x:
  08C3  CDF009        	 call y_ck
  08C6  3808          	 jr c,knight_x_1
  08C8  23            	 inc HL
  08C9  CBFE          	 set 7,(HL)
  08CB  CBB6          	 res 6,(HL)
  08CD  2B            	 dec HL
  08CE  1806          	 jr knight_x_2
  08D0                	knight_x_1:
  08D0  23            	 inc HL
  08D1  CBBE          	 res 7,(HL)
  08D3  CBB6          	 res 6,(HL)
  08D5  2B            	 dec HL
  08D6                	knight_x_2:
  08D6  CD230F        	 call wall_ck
  08D9  CAFB08        	 jp z,knight_move
  08DC  C39908        	 jp kight_accel_2 
                      	 
  08DF                	knight_y:
  08DF  CDE809        	 call x_ck
  08E2  3808          	 jr c,knight_y_1
  08E4  23            	 inc HL
  08E5  CBBE          	 res 7,(HL)
  08E7  CBF6          	 set 6,(HL)
  08E9  2B            	 dec HL
  08EA  1806          	 jr knight_y_2
  08EC                	knight_y_1:
  08EC  23            	 inc HL
  08ED  CBFE          	 set 7,(HL)
  08EF  CBF6          	 set 6,(HL)
  08F1  2B            	 dec HL
  08F2                	knight_y_2:
  08F2  CD230F        	 call wall_ck
  08F5  CAFB08        	 jp z,knight_move
  08F8  C39908        	 jp kight_accel_2 
                      	 
                      	
                      	
                      	
                      	
                      	
                      	
  08FB                	knight_move:;a=0~3
  08FB  111809        	 ld DE, knight_action_end
  08FE  D5            	 push DE
  08FF                	empty_move:
  08FF  23            	 inc HL
  0900  7E            	 ld A,(HL)
  0901  2B            	 dec HL
  0902  E6C0          	 and 11000000b
  0904  2808          	 jr z,knight_action_up
  0906  FE80          	 cp 80h
  0908  3808          	 jr c,knight_action_ri
  090A  2808          	 jr z,knight_action_do
  090C                	knight_action_le:
  090C  35            	 dec (HL)
  090D  C9            	 ret
  090E                	knight_action_up:
  090E  23            	 inc HL
  090F  35            	 dec (HL)
  0910  2B            	 dec HL
  0911  C9            	 ret
  0912                	knight_action_ri:
  0912  34            	 inc (HL)
  0913  C9            	 ret
  0914                	knight_action_do:
  0914  23            	 inc HL
  0915  34            	 inc (HL)
  0916  2B            	 dec HL
  0917  C9            	 ret
                      	
                      	 
                      	 
                      	
                      	
  0918                	knight_action_end:
  0918  FD7E30        	 ld A,(IY+48)
  091B  EE01          	 xor 1
  091D  FD7730        	 ld (IY+48),A
  0920  B7            	 or A
  0921  2805          	 jr z,knight_action_end2
                      	 
  0923  117419        	 ld DE,graph_n_knightu
  0926  1803          	 jr knight_action_end3
  0928                	knight_action_end2:
  0928  118C19        	 ld DE,graph_n_knightu+24
  092B                	knight_action_end3:
  092B  CD0605        	 call Egraph
                      	 
                      	 
                      	;********************cross chack kight*******************
                      	; call kwait
                      	
  092E  3AD44A        	 ld A,(gil_st2)
  0931  B7            	 or A
  0932  2814          	 jr z,ssss1
  0934  CB7F          	 bit 7,A	;(gil sworud MIRU) 
  0936  2808          	 jr z,ssss0
  0938  CDEE0E        	 call cross_ck_a;s
  093B  DC1D0A        	 call c,HP_dec;(suraim HP=0)
  093E  1810          	 jr ssss2
  0940                	ssss0:
  0940  CDEE0E        	 call cross_ck_a;s
  0943  DC300A        	 call c,HP_dec_swdbc
  0946  1808          	 jr ssss2
  0948                	ssss1:;(gil_st=0-x)
  0948  CDEE0E        	 call cross_ck_a
  094B  3003          	 jr nc,ssss2
  094D  C3EC0C        	 jp gil_killing
  0950                	ssss2:
  0950  DD7E30        	 ld A,(IX+48)
  0953  EEFF          	 xor 0ffh
  0955  DD7730        	 ld (IX+48),A
  0958  C30E0D        	 jp mains_end
                      	 
                      	
                      	
  095B                	knight_front_ck:
  095B  CDFD09        	 call xyload
  095E  F5            	 push AF
  095F  32CC09        	 ld (knight_front_ck_end+3),A
  0962  7B            	 ld A,E
  0963  32CA09        	 ld (knight_front_ck_end+1),A 
  0966  F1            	 pop AF
  0967  E6C0          	 and 11000000b
  0969  2810          	 jr z,knight_front_ck_u
  096B  FE02          	 cp 2
  096D  3814          	 jr c,knight_front_ck_r
  096F  281C          	 jr z,knight_front_ck_d
  0971                	knight_front_ck_l:
  0971  7B            	 ld A,E
  0972  D607          	 sub 7
  0974  FE1E          	 cp 30
  0976  DAD609        	 jp c,knight_front_outerwall
  0979  181C          	 jr knight_front_ck_e
  097B                	knight_front_ck_u:
  097B  7A            	 ld A,D
  097C  D607          	 sub 7
  097E  DAD609        	 jp c,knight_front_outerwall
  0981  1814          	 jr knight_front_ck_e
  0983                	knight_front_ck_r:
  0983  7B            	 ld A,E
  0984  C607          	 add A,7
  0986  FE88          	 cp 136
  0988  D2D609        	 jp nc,knight_front_outerwall
  098B  180A          	 jr knight_front_ck_e
  098D                	knight_front_ck_d:
  098D  7A            	 ld A,D
  098E  C607          	 add A,7
  0990  FE2B          	 cp 43
  0992  D2D609        	 jp nc,knight_front_outerwall
  0995  1800          	 jr knight_front_ck_e
  0997                	knight_front_ck_e:
  0997  CD050A        	 call right_turn
  099A  CD230F        	 call wall_ck
  099D  CAC909        	 jp z,knight_front_ck_end
                      	
  09A0  CD130A        	 call left_turn
  09A3  CD230F        	 call wall_ck
  09A6  CAC909        	 jp z,knight_front_ck_end
                      	
  09A9  CD130A        	 call left_turn
  09AC  CD230F        	 call wall_ck
  09AF  CAC909        	 jp z,knight_front_ck_end
                      	 
  09B2  CD050A        	 call right_turn
  09B5  CD050A        	 call right_turn
                      	 
  09B8  23            	 inc HL
  09B9  7E            	 ld A,(HL)
  09BA  E6C0          	 and 11000000b
  09BC  47            	 ld B,A
  09BD  3ACC09        	 ld A,(knight_front_ck_end+3)
  09C0  E63F          	 and 00111111b
  09C2  B0            	 or B
  09C3  32CC09        	 ld (knight_front_ck_end+3),A
  09C6  2B            	 dec HL
                      	 
  09C7  18CE          	 jr knight_front_ck_e
                      	 
  09C9                	knight_front_ck_end:
  09C9  1E00          	 ld E,overwrite
  09CB  1600          	 ld D,overwrite
  09CD  7B            	 ld A,E
  09CE  77            	 ld (HL),A
  09CF  23            	 inc HL
  09D0  7A            	 ld A,D
  09D1  77            	 ld (HL),A
  09D2  2B            	 dec HL
  09D3  C3FB08        	 jp knight_move
                      	
  09D6                	knight_front_outerwall:
  09D6  C39908        	 jp kight_accel_2
                      	
                      	
                      	
                      	;***************************ckeck sub****************************
                      	
  09D9                	xy_ck:;chr cp
  09D9  CDFD09        	 call xyload
  09DC  E5            	 push HL		;>
  09DD  2ADD4A        	 ld HL,(gil_xy)
  09E0  7C            	 ld A,H
  09E1  E63F          	 and 00111111b
  09E3  67            	 ld H,A
  09E4  ED52          	 sbc HL,DE
  09E6  E1            	 pop HL			;<
  09E7  C9            	 ret
  09E8                	x_ck:
  09E8  CDFD09        	 call xyload
  09EB  3ADD4A        	 ld A,(gil_xy)
  09EE  93            	 sub E
  09EF  C9            	 ret
  09F0                	y_ck:
  09F0  CDFD09        	 call xyload
  09F3  7A            	 ld A,D
  09F4  E63F          	 and 00111111b
  09F6  3ADE4A        	 ld A,(gil_xy+1)
  09F9  E63F          	 and 00111111b
  09FB  92            	 sub D
  09FC  C9            	 ret
                      	
                      	
  09FD                	xyload:;A=urdl D=none
  09FD  5E            	 ld E,(HL)
  09FE  23            	 inc HL
  09FF  7E            	 ld A,(HL)
  0A00  E63F          	 and 00111111b
  0A02  57            	 ld D,A
  0A03  2B            	 dec HL
  0A04  C9            	 ret
                      	
  0A05                	right_turn:
  0A05  23            	 inc HL
  0A06  7E            	 ld A,(HL)
  0A07  E6C0          	 and 11000000b
  0A09  C640          	 add A,40H
  0A0B  47            	 ld B,A
  0A0C  7E            	 ld A,(HL)
  0A0D  E63F          	 and 00111111b
  0A0F  B0            	 or B
  0A10  77            	 ld (HL),A
  0A11  2B            	 dec HL
  0A12  C9            	 ret
                      	 
  0A13                	left_turn:
  0A13  CD050A        	 call right_turn
  0A16  CD050A        	 call right_turn
  0A19  CD050A        	 call right_turn
  0A1C  C9            	 ret
                      	
                      	;*************************hp dec*****************************
  0A1D                	HP_dec:
  0A1D  3AD84A        	 ld A,(gil_sword)
  0A20  FE02          	 cp 2
  0A22  DD7E00        	 ld A,(IX)
  0A25  2003          	 jr nz,HP_dec1
  0A27  3D            	 dec A
  0A28  2801          	 jr z,HP_dec2
  0A2A                	HP_dec1:
  0A2A  3D            	 dec A
  0A2B                	HP_dec2:
  0A2B  DD7700        	 ld (IX),A
  0A2E  281F          	 jr z,HP_rec
  0A30                	HP_dec_swdbc:
  0A30                	gil_HP_dec:
  0A30  3AD14A        	 ld A,(gil_hp)
  0A33  3D            	 dec A
  0A34  32D14A        	 ld (gil_hp),A
  0A37  CAEC0C        	 jp z,gil_killing
  0A3A  C9            	 ret
                      	 
  0A3B                	HP_decB:
  0A3B  3AD84A        	 ld A,(gil_sword)
  0A3E  FE02          	 cp 2
  0A40  DD7E00        	 ld A,(IX)
  0A43  2003          	 jr nz,HP_decb1
  0A45  3D            	 dec A
  0A46  2801          	 jr z,HP_decb2
  0A48                	HP_decb1:
  0A48  3D            	 dec A
  0A49                	HP_decb2:
  0A49  DD7700        	 ld (IX),A
  0A4C  2814          	 jr z,HP_rec2
  0A4E  C9            	 ret
                      	
                      	 
  0A4F                	HP_rec:
  0A4F  DD7E60        	 ld A,(IX+96)
  0A52  47            	 ld B,A
  0A53  AF            	 xor A
  0A54  DD7760        	 ld (IX+96),A
  0A57  3AD14A        	 ld A,(gil_HP)
  0A5A  80            	 add A,B
  0A5B  3002          	 jr nc,H_recP2
  0A5D  3EFF          	 ld A,255
  0A5F                	H_recP2:
  0A5F  32D14A        	 ld (gil_HP),A
  0A62                	HP_rec2:
  0A62  AF            	 xor A
  0A63  DD7700        	 ld (IX),A
  0A66  DD7730        	 ld (IX+48),A
  0A69  DD7760        	 ld (IX+96),A
  0A6C  FD7700        	 ld (IY),A
  0A6F  C9            	 ret
                      	
                      	;*************************key actions************************
  0A70                	key_action:
  0A70  3AED4A        	 ld A,(key)
  0A73  B7            	 or A
  0A74  2807          	 jr z,key_action_1
  0A76  AF            	 xor A
  0A77  DD7700        	 ld (IX),A
  0A7A  C30E0D        	 jp mains_end
  0A7D                	key_action_1:
  0A7D  CDEE0E        	 call cross_ck_a
  0A80  3005          	 jr nc,key_action_end
  0A82  3E01          	 ld A,1
  0A84  32ED4A        	 ld (key),A
  0A87                	key_action_end:
  0A87  11A419        	 ld DE,graph_key
  0A8A  CD0605        	 call Egraph
  0A8D  C30E0D        	 jp mains_end
                      	
                      	;**************************box action*************************
  0A90                	box_action:
                      	
  0A90  DD7E30        	 ld A,(IX+48)
  0A93  B7            	 or A
  0A94  3A4949        	 ld A,(floor)
  0A97  200F          	 jr nz,box_actiont
                      	 
  0A99  3D            	 dec A
  0A9A  D9            	 exx
  0A9B  87            	 add A,A
  0A9C  5F            	 ld E,A
  0A9D  1600          	 ld D,0
  0A9F  21B30A        	 ld HL,box_action_table_farse
  0AA2                	box_action2:
  0AA2  19            	 add HL,DE
  0AA3  5E            	 ld E,(HL)
  0AA4  23            	 inc HL
  0AA5  56            	 ld D,(HL)
  0AA6  EB            	 ex DE,HL
                      	 
                      	; ld (0f0h),HL
                      	; ret
                      	 
  0AA7  E9            	 jp (HL)
  0AA8                	box_actiont:
  0AA8  3D            	 dec A
  0AA9  D9            	 exx
  0AAA  87            	 add A,A
  0AAB  5F            	 ld E,A
  0AAC  1600          	 ld D,0
  0AAE  21B70A        	 ld HL,box_action_table_true
  0AB1  18EF          	 jr box_action2
                      	 
                      	 
  0AB3                	box_action_table_farse:
  0AB3  BB0AE50A      	 dw floor1,floor2
  0AB7                	box_action_table_true:
  0AB7  CA0AF40A      	 dw floor1t,floor2t
                      	
                      	
                      	;***********************floor1******************************
  0ABB                	floor1:
  0ABB  D9            	 exx
                      	 
  0ABC  3ABC19        	 ld A,(dammy)
  0ABF  FE03          	 cp 3
  0AC1  DA0E0D        	 jp c,mains_end
  0AC4  DD7730        	 ld (IX+48),A
  0AC7  C30E0D        	 jp mains_end
  0ACA                	floor1t
  0ACA  D9            	 exx
  0ACB  3AE14A        	 ld A,(matk)
  0ACE  B7            	 or A
  0ACF  C20E0D        	 jp nz,mains_end
  0AD2  CDEE0E        	 call cross_ck_a
  0AD5  D20A0B        	 jp nc,box_action_end
  0AD8  3E01          	 ld A,1
  0ADA  32E14A        	 ld (matk),A
  0ADD  3E02          	 ld A,2
  0ADF  32D64A        	 ld (gil_matk_count),A
  0AE2  C30E0D        	 jp mains_end
                      	 
                      	 
                      	
                      	;***********************floor2******************************
  0AE5                	floor2:
  0AE5  D9            	 exx
                      	 
  0AE6  3ABC19        	 ld A,(dammy)
  0AE9  FE02          	 cp 2
  0AEB  DA0E0D        	 jp c,mains_end
  0AEE  DD7730        	 ld (IX+48),A
  0AF1  C30E0D        	 jp mains_end
  0AF4                	floor2t
  0AF4  D9            	 exx
  0AF5  3AE24A        	 ld A,(boot)
  0AF8  B7            	 or A
  0AF9  C20E0D        	 jp nz,mains_end
  0AFC  CDEE0E        	 call cross_ck_a
  0AFF  D20A0B        	 jp nc,box_action_end
  0B02  3E01          	 ld A,1
  0B04  32E24A        	 ld (boot),A
  0B07  C30E0D        	 jp mains_end
                      	
  0B0A                	box_action_end:
  0B0A  11B619        	 ld DE,graph_box
  0B0D  CD0605        	 call Egraph
  0B10  C30E0D        	 jp mains_end
                      	
                      	
                      	;*************************door actions************************
  0B13                	door_action:
  0B13  3AED4A        	 ld A,(key)
  0B16  B7            	 or A
  0B17  2002          	 jr nz,door_action_1
  0B19  1812          	 jr door_action_end
  0B1B                	door_action_1:
  0B1B  11B019        	 ld DE,graph_door+6
  0B1E  CD0605        	 call Egraph
  0B21  CDEE0E        	 call cross_ck_a
  0B24  CDD909        	 call xy_ck
  0B27  CA360B        	 jp z,next_floor
  0B2A  C30E0D        	 jp mains_end
  0B2D                	door_action_end:
  0B2D  11AA19        	 ld DE,graph_door
  0B30  CD0605        	 call Egraph
  0B33  C30E0D        	 jp mains_end
                      	
  0B36                	next_floor:
  0B36  110601        	 ld DE,0106h
  0B39  060B          	 ld B,11
  0B3B  21590B        	 ld HL,next_floorms
  0B3E  CDF1BF        	 call msp
  0B41  110802        	 ld DE,0208h
  0B44  060A          	 ld B,10
  0B46  21640B        	 ld HL,next_floorms+11
  0B49  CDF1BF        	 call msp
  0B4C  CD320D        	 call tim255
  0B4F  CDFDBC        	 call kwait
  0B52  214949        	 ld HL,floor
  0B55  34            	 inc (HL)
  0B56  C38801        	 jp Stating_before
  0B59                	next_floorms:
  0B59  464C4F4F522043	 db "FLOOR CLEAR"
  0B64  4E45585420464C	 db "NEXT FLOOR"
                      	
                      	;*************************gil actions*************************
  0B6E                	gil_action:
  0B6E  E5            	 push HL
                      	
                      	
  0B6F  3ADD4A        	 ld A,(gil_xy)
  0B72  5F            	 ld E,A
  0B73  3ADE4A        	 ld A,(gil_xy+1)
  0B76  57            	 ld D,A
  0B77  CD6712        	 call grp_del
                      	; call kwait
                      	
                      	;*************************key scanf**************************
  0B7A  CD090E        	 call keysc
  0B7D  32D04A        	 ld (gil_button),A
  0B80  08            	 ex AF,AF'
                      	
                      	;************************sword back***************************
  0B81  3AD44A        	 ld A,(gil_st2)
  0B84  B7            	 or A
  0B85  C2B50C        	 jp nz,gil_sword_f2
                      	;***********************sword atack****************************
  0B88                	gil_action_l_b:
  0B88  08            	 ex AF,AF'
  0B89  CB6F          	 bit 5,A
  0B8B  C27C0C        	 jp nz,gil_sword_f
  0B8E  CD9F0C        	 call gil_sword_reset
                      	
  0B91  218418        	 ld HL,graph_gil_ulf
  0B94  224E0C        	 ld (gil_action_end-2),HL
                      	;************************urdl move*****************************
  0B97                	gil_action_l:
  0B97  08            	 ex AF,AF'
  0B98  3AE24A        	 ld A,(boot)
  0B9B  B7            	 or A
  0B9C  200B          	 jr nz,gil_action_l2
  0B9E  3AD74A        	 ld A,(gil_bt)
  0BA1  EEFF          	 xor 0ffh
  0BA3  32D74A        	 ld (gil_bt),A
  0BA6  CA4D0C        	 jp z,gil_action_end-3
  0BA9                	gil_action_l2:
  0BA9  08            	 ex AF,AF'
  0BAA  CB47          	 bit 0,A
  0BAC  200F          	 jr nz,gil_left
  0BAE  CB4F          	 bit 1,A
  0BB0  202D          	 jr nz,gil_right
  0BB2  CB77          	 bit 6,A
  0BB4  204C          	 jr nz,gil_down
  0BB6  CB7F          	 bit 7,A
  0BB8  206C          	 jr nz,gil_up
                      	;*****************************noting************************
  0BBA  C34D0C        	 jp gil_action_end-3
                      	 ;************************move farse*************************
  0BBD                	gil_left:
  0BBD  3ADE4A        	 ld A,(gil_xy+1);y
  0BC0  E63F          	 and 00111111b
  0BC2  CACC0B        	 jp z,gil_left_l
  0BC5                	gil_left_s:
  0BC5  D607          	 sub 7
  0BC7  DA690C        	 jp c,direction_p
  0BCA  20F9          	 jr nz,gil_left_s
  0BCC                	gil_left_l:
  0BCC  3EC0          	 ld A,11000000b
  0BCE  21DE4A        	 ld HL,gil_xy+1
  0BD1  B6            	 or (HL)
  0BD2  77            	 ld (HL),A
  0BD3  2B            	 dec HL;ld HL,gil_xy
  0BD4  CD230F        	 call wall_ck
  0BD7  B7            	 or A;
  0BD8  C24D0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0BDB  35            	 dec (HL)
  0BDC  C3460C        	 jp gil_walk
                      	
  0BDF                	gil_right:
  0BDF  3ADE4A        	 ld A,(gil_xy+1);y
  0BE2  E63F          	 and 00111111b
  0BE4  CAEE0B        	 jp z,gil_right_l
  0BE7                	gil_right_s:
  0BE7  D607          	 sub 7
  0BE9  DA690C        	 jp c,direction_p
  0BEC  20F9          	 jr nz,gil_right_s
  0BEE                	gil_right_l:
  0BEE  3E3F          	 ld A,00111111b
  0BF0  21DE4A        	 ld HL,gil_xy+1
  0BF3  A6            	 and (HL)
  0BF4  77            	 ld (HL),A
  0BF5  CBF6          	 set 6,(HL)
  0BF7  2B            	 dec HL;ld HL,gil_xy
  0BF8  CD230F        	 call wall_ck
  0BFB  B7            	 or A;
  0BFC  C24D0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0BFF  34            	 inc (HL)
  0C00  1844          	 jr gil_walk
                      	
  0C02                	gil_down:
  0C02  3ADD4A        	 ld A,(gil_xy);x
  0C05  D61E          	 sub 30
  0C07  CA110C        	 jp z,gil_down_l
  0C0A                	gil_down_s:
  0C0A  D607          	 sub 7
  0C0C  DA690C        	 jp c,direction_p
  0C0F  20F9          	 jr nz,gil_down_s
  0C11                	gil_down_l:
  0C11  3E3F          	 ld A,00111111b
  0C13  21DE4A        	 ld HL,gil_xy+1
  0C16  A6            	 and (HL)
  0C17  77            	 ld (HL),A
  0C18  CBFE          	 set 7,(HL)
  0C1A  2B            	 dec HL;ld HL,gil_xy
  0C1B  CD230F        	 call wall_ck
  0C1E  B7            	 or A;
  0C1F  C24D0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0C22  23            	 inc HL
  0C23  34            	 inc (HL)
  0C24  1820          	 jr gil_walk
                      	
  0C26                	gil_up:
  0C26  3ADD4A        	 ld A,(gil_xy);x
  0C29  D61E          	 sub 30
  0C2B  CA350C        	 jp z,gil_up_l
  0C2E                	gil_up_s:
  0C2E  D607          	 sub 7
  0C30  DA690C        	 jp c,direction_p
  0C33  20F9          	 jr nz,gil_up_s
  0C35                	gil_up_l:
  0C35  3E3F          	 ld A,00111111b
  0C37  21DE4A        	 ld HL,gil_xy+1
  0C3A  A6            	 and (HL)
  0C3B  77            	 ld (HL),A
  0C3C  2B            	 dec HL;ld HL,gil_xy
  0C3D  CD230F        	 call wall_ck
  0C40  B7            	 or A;
  0C41  C24D0C        	 jp nz,gil_action_end-3
                      	
                      	; ld HL,gil_xy
  0C44  23            	 inc HL
  0C45  35            	 dec (HL)
                      	; jr gil_walk
                      	
                      	
  0C46                	gil_walk:
  0C46  21D34A        	 ld HL,gil_st1
  0C49  3EFF          	 ld A,0ffh
  0C4B  AE            	 xor (HL)
  0C4C  77            	 ld (HL),A
                      	
  0C4D  218418        	 ld HL,graph_gil_ulf
  0C50                	gil_action_end:
  0C50  3AD34A        	 ld A,(gil_st1)
  0C53  3C            	 inc A
  0C54  111800        	 ld DE,24
  0C57  CD5D0D        	 call xsan
  0C5A                	gil_action_end_l:
  0C5A  3ADD4A        	 ld A,(gil_xy)
  0C5D  5F            	 ld E,A
  0C5E  3ADE4A        	 ld A,(gil_xy+1)
  0C61  57            	 ld D,A
  0C62  CDD811        	 call grp_set
  0C65  E1            	 pop HL
  0C66  C30E0D        	 jp mains_end
                      	
  0C69                	direction_p:
  0C69  3ADE4A        	 ld A,(gil_xy+1)
  0C6C  E6C0          	 and 11000000b
  0C6E  CA350C        	 jp z,gil_up_l
  0C71  FE80          	 cp 80h
  0C73  DAEE0B        	 jp c,gil_right_l
  0C76  CA110C        	 jp z,gil_down_l
  0C79  C3BD0B        	 jp gil_left
                      	
  0C7C                	gil_sword_f:;key_action
  0C7C  08            	 ex AF,AF'
  0C7D  B7            	 or A
  0C7E  C2940C        	 jp nz,gil_sword_set 
                      	;************************sword atack***************************
  0C81  3E0A          	 ld A,10		;back flame
  0C83  32D44A        	 ld (gil_st2),A
                      	;***********************matk action****************************
  0C86  CDD90F        	 call matk_action_gil
                      	;*************************************************************
  0C89  11B418        	 ld DE,graph_gilsw_ulf	;gil_sw
  0C8C  ED534E0C      	 ld (gil_action_end-2),DE
  0C90  08            	 ex AF,AF'
  0C91  C3970B        	 jp gil_action_l
  0C94                	gil_sword_set:
  0C94  11E418        	 ld DE,graph_gilsword_ulf	;gil_swd
  0C97  ED534E0C      	 ld (gil_action_end-2),DE
  0C9B                	gil_sword_set_l:
  0C9B  08            	 ex AF,AF'
  0C9C  C3970B        	 jp gil_action_l
  0C9F                	gil_sword_reset:
  0C9F  08            	 ex AF,AF'
  0CA0  3AD44A        	 ld A,(gil_st2)
  0CA3  47            	 ld B,A
  0CA4  08            	 ex AF,AF'
  0CA5  CB78          	 bit 7,B
  0CA7  C8            	 ret z
  0CA8  08            	 ex AF,AF'
  0CA9  E1            	 pop HL
  0CAA  3E80          	 ld A,10000000b
                      	;************************sword back***************************
  0CAC  F60A          	 or 10			;back flame
  0CAE  32D44A        	 ld (gil_st2),A
  0CB1  08            	 ex AF,AF'
  0CB2  C3970B        	 jp gil_action_l
  0CB5                	gil_sword_f2:;auto_action
  0CB5  FE80          	 cp 80h
  0CB7  CA880B        	 jp z,gil_action_l_b
  0CBA  E680          	 and 10000000b
  0CBC  C2D40C        	 jp nz,gil_sword_f_decB;A=1nnnnnnnb
  0CBF                	gil_sword_f_decA:;A=0nnnnnnnb
  0CBF  21D44A        	 ld HL,gil_st2
  0CC2  7E            	 ld A,(HL)
  0CC3  3D            	 dec A
  0CC4  77            	 ld (HL),A
  0CC5  11B418        	 ld DE,graph_gilsw_ulf	;gil_sw
  0CC8  ED534E0C      	 ld (gil_action_end-2),DE
  0CCC  C2E80C        	 jp nz,gil_action_l_r
  0CCF  CBFE          	 set 7,(HL)
  0CD1  C3E80C        	 jp gil_action_l_r
  0CD4                	gil_sword_f_decB:;A=1nnnnnnnb
  0CD4  21D44A        	 ld HL,gil_st2
  0CD7  7E            	 ld A,(HL)
  0CD8  3D            	 dec A
  0CD9  77            	 ld (HL),A
  0CDA  E67F          	 and 01111111b
  0CDC  11B418        	 ld DE,graph_gilsw_ulf	;gil_sw
  0CDF  ED534E0C      	 ld (gil_action_end-2),DE
  0CE3  C2E80C        	 jp nz,gil_action_l_r
  0CE6  CBBE          	 res 7,(HL)
  0CE8                	gil_action_l_r:
  0CE8  08            	 ex AF,AF'
  0CE9  C3970B        	 jp gil_action_l
                      	
                      	
  0CEC                	gil_killing:
  0CEC  CDE30D        	 call grp_o
  0CEF  21030D        	 ld HL,killingm
  0CF2  110000        	 ld DE,0
  0CF5  060B          	 ld B,11
  0CF7  CDF1BF        	 call msp
  0CFA  DD7ED0        	 ld A,(IX-48)
  0CFD  32F000        	 ld (0f0h),A
  0D00  C3260D        	 jp retP
                      	
                      	
                      	
  0D03                	killingm:
  0D03  6265656E206B69	 db "been killed"
                      	
                      	
  0D0E                	mains_end:
                      	; ld A,(IX+48)
                      	; ld (0f0h),A
                      	; ld (0f2h),IX
                      	
  0D0E  3AA403        	 ld A,(count+1)
  0D11  3D            	 dec A
  0D12  32A403        	 ld (count+1),A
  0D15  23            	 inc HL
  0D16  23            	 inc HL
  0D17  DD23          	 inc IX
  0D19  FD23          	 inc IY
  0D1B  D9            	 exx
  0D1C  CD090E        	 call keysc
  0D1F  CB57          	 bit 2,A
  0D21  C0            	 ret nz
  0D22  D9            	 exx
  0D23  C3A303        	 jp mains
                      	
                      	
  0D26                	retP:
  0D26  310000        	 ld SP,0
  0D29  C9            	 ret
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	;*********************************************************
  0D2A                	TIMBTL:
  0D2A  3E32          	 LD A,50
  0D2C  1806          	 JR TIMER
  0D2E                	TIM30:
  0D2E  3E25          	 LD A,37
  0D30  1802          	 JR TIMER
  0D32                	TIM255:
  0D32  3EFF          	 LD A,255
  0D34                	TIMER:
  0D34  010000        	 LD BC,0
  0D37  03            	 INC BC;LOOP
  0D38  000000000000  	 DB 0,0,0,0,0,0
  0D3E  A8            	 XOR B
  0D3F  C8            	 RET Z
  0D40  18F5          	 JR TIMER+3
  0D42                	RAND:;A
  0D42  E5            	 PUSH HL
  0D43  D5            	 push DE
  0D44  210000        	 LD HL,0
  0D47  54            	 LD D,H
  0D48  5D            	 LD E,L
  0D49  29            	 ADD HL,HL
  0D4A  29            	 ADD HL,HL
  0D4B  19            	 ADD HL,DE
  0D4C  11475D        	 LD DE,5D47H
  0D4F  19            	 ADD HL,DE
  0D50  22450D        	 LD (RAND+3),HL
  0D53  7C            	 LD A,H
  0D54  D1            	 pop DE
  0D55  E1            	 POP HL
  0D56  C9            	 RET
  0D57                	RAND4:
                      	; ld A,R
                      	; rra
                      	; rra
                      	; rra
                      	; and 11000000b
                      	; ret
  0D57  CD420D        	 CALL RAND
  0D5A  E6C0          	 AND 11000000b
  0D5C  C9            	 RET
  0D5D                	XSAN:
  0D5D  B7            	 OR A
  0D5E  C8            	 RET Z
  0D5F                	XSANL:
  0D5F  19            	 ADD HL,DE
  0D60  3D            	 DEC A
  0D61  20FC          	 JR NZ,XSANL
  0D63  C9            	 RET
  0D64                	NMEMRY:
  0D64  0000000000    	 DB 0,0,0,0,0
  0D69                	ASCN:;HL=l(2byte)DE
  0D69  11640D        	 LD DE,NMEMRY
  0D6C  011027        	 LD BC,10000
  0D6F  CDA30D        	 CALL WARIS
  0D72  01E803        	 LD BC,1000
  0D75  CDA30D        	 CALL WARIS
  0D78  016400        	 LD BC,100
  0D7B  CDA30D        	 CALL WARIS
  0D7E  010A00        	 LD BC,10
  0D81  CDA30D        	 CALL WARIS
  0D84  7D            	 LD A,L
  0D85  12            	 LD (DE),A
  0D86  0605          	 LD B,5
  0D88  11640D        	 LD DE,NMEMRY
  0D8B                	ASCL:
  0D8B  1A            	 LD A,(DE)
  0D8C  FE00          	 CP 0
  0D8E  2802          	 JR Z,ASCL2
  0D90  1808          	 JR ASC2
  0D92                	ASCL2:
  0D92  13            	 INC DE
  0D93  10F6          	 DJNZ ASCL
  0D95  0601          	 LD B,1
  0D97  11680D        	 LD DE,NMEMRY+4
  0D9A                	ASC2:
  0D9A  1A            	 LD A,(DE)
  0D9B  0E30          	 LD C,30H
  0D9D  81            	 ADD A,C
  0D9E  12            	 LD (DE),A
  0D9F  13            	 INC DE
  0DA0  10F8          	 DJNZ ASC2
  0DA2  C9            	 RET
  0DA3                	WARIS:
  0DA3  AF            	 XOR A
                      	;WARI1:
  0DA4  ED42          	 SBC HL,BC
  0DA6  3803          	 JR C,WARI2
  0DA8  3C            	 INC A
  0DA9  18F9          	 JR WARIS+1
  0DAB                	WARI2:
  0DAB  09            	 ADD HL,BC
  0DAC  12            	 LD (DE),A
  0DAD  13            	 INC DE		;
  0DAE  C9            	 RET
  0DAF                	cls:
  0DAF  F5            	 push AF
  0DB0  D5            	 push DE
  0DB1  E5            	 push HL
  0DB2  C5            	 push BC
  0DB3  3E00          	 ld A,0
  0DB5  216813        	 ld HL,grapu_area
  0DB8  116913        	 ld DE,grapu_area+1
  0DBB  77            	 ld (HL),A
  0DBC  015F03        	 ld BC,144*6-1
  0DBF  EDB0          	 ldir
  0DC1  CDE30D        	 call grp_o
  0DC4  C1            	 pop BC
  0DC5  E1            	 pop HL
  0DC6  D1            	 pop DE
  0DC7  F1            	 pop AF
  0DC8  C9            	 ret
                      	
  0DC9                	bls:
  0DC9  F5            	 push AF
  0DCA  D5            	 push DE
  0DCB  E5            	 push HL
  0DCC  C5            	 push BC
  0DCD  216813        	 LD HL,grapu_area
  0DD0  36FF          	 LD (HL),0FFH
  0DD2  116913        	 LD DE,grapu_area+1
  0DD5  015F03        	 LD BC,863
  0DD8  EDB0          	 LDIR
  0DDA  CDE30D        	 CALL grp_o
  0DDD  D9            	 EXX
  0DDE  C1            	 pop BC
  0DDF  E1            	 pop HL
  0DE0  D1            	 pop DE
  0DE1  F1            	 pop AF
  0DE2  C9            	 RET
  0DE3                	grp_o:
  0DE3  3E06          	 ld A,6
  0DE5  110000        	 ld DE,0
  0DE8  216813        	 ld HL,grapu_area
  0DEB                	grp_o_l:
  0DEB  D5            	 push DE
  0DEC  F5            	 push AF
  0DED  0690          	 ld B,144
  0DEF  CDD0BF        	 call grp
  0DF2  23            	 inc HL
  0DF3  F1            	 pop AF
  0DF4  D1            	 pop DE
  0DF5  14            	 inc D
  0DF6  3D            	 dec A
  0DF7  20F2          	 jr nz,grp_o_l
  0DF9  C9            	 ret
                      	
  0DFA                	grp_open:
  0DFA  0E06          	 ld C,6
  0DFC                	grp_open_l
  0DFC  C5            	 push BC
  0DFD  D5            	 push DE
  0DFE  CDD0BF        	 call grp
  0E01  D1            	 pop DE
  0E02  14            	 inc D
  0E03  23            	 inc HL
  0E04  C1            	 pop BC
  0E05  0D            	 dec C
  0E06  20F4          	 jr nz,grp_open_l
  0E08  C9            	 ret
                      	
  0E09                	keysc:
  0E09  F3            	 di
  0E0A  AF            	 xor A
  0E0B  D311          	 out (11h),A
  0E0D  3E08          	 ld A,08h
  0E0F  D311          	 out (11h),A
  0E11  CDAD8A        	 call 8aadh
  0E14  DB10          	 in A,(10h)
  0E16  E6E0          	 and 0e0h
  0E18  47            	 ld B,A
  0E19  AF            	 xor A
  0E1A  D311          	 out (11h),A
  0E1C  3E10          	 ld A,10h
  0E1E  D311          	 out (11h),A
  0E20  CDAD8A        	 call 8aadh
  0E23  DB10          	 in A,(10h)
  0E25  E60F          	 and 0fh
  0E27  B0            	 or B
  0E28  FB            	 ei
  0E29  C9            	 ret
                      	
                      	
                      	
  0E2A                	charReput:;HL=obj_xy++
  0E2A                	charReput_x:
  0E2A  7E            	 ld A,(HL);x
  0E2B  4F            	 ld C,A
  0E2C  D61E          	 sub 30
  0E2E  CA460E        	 jp z,charReput_y
  0E31                	charReput_x_lp:
  0E31  D607          	 sub 7
  0E33  CA460E        	 jp z,charReput_y
  0E36  30F9          	 jr nc,charReput_x_lp
  0E38  FEFD          	 cp 0fch+1;cy=-4~-6 left
  0E3A  3804          	 jr c,charReput_x_1
  0E3C  ED44          	 neg;(right+)
  0E3E  1804          	 jr charReput_x_2
  0E40                	charReput_x_1:
  0E40  C607          	 add A,7
  0E42  ED44          	 neg;(left-)
  0E44                	charReput_x_2:
  0E44  81            	 add A,C
  0E45  77            	 ld (HL),A
                      	
  0E46                	charReput_y:
  0E46  23            	 inc HL
  0E47  7E            	 ld A,(HL)
  0E48  2B            	 dec HL
  0E49  4F            	 ld C,A
  0E4A  E63F          	 and 00111111b
  0E4C  C8            	 ret z
  0E4D                	charReput_y_lp:
  0E4D  D607          	 sub 7
  0E4F  C8            	 ret z
  0E50  30FB          	 jr nc,charReput_y_lp
  0E52  FEFD          	 cp 0fch+1;cy=-4~-6 up
  0E54  3804          	 jr c,charReput_y_1
  0E56  ED44          	 neg;(down+)
  0E58  1804          	 jr charReput_y_2
  0E5A                	charReput_y_1:
  0E5A  C607          	 add A,7
  0E5C  ED44          	 neg;(up-)
  0E5E                	charReput_y_2:
  0E5E  81            	 add A,C
  0E5F  23            	 inc HL
  0E60  77            	 ld (HL),A
  0E61  2B            	 dec HL
  0E62  C9            	 ret 
                      	
                      	
  0E63                	cross_ck_s:;HL=obj_xy+
  0E63  5E            	 ld E,(HL)
  0E64  23            	 inc HL
  0E65  56            	 ld D,(HL)
  0E66  2B            	 dec HL
  0E67  3ADE4A        	 ld A,(gil_xy+1)
  0E6A  E6C0          	 and 11000000b
  0E6C  CA950E        	 jp z,cross_ck_s_up
  0E6F  FE80          	 cp 80h
  0E71  DAB30E        	 jp c,cross_ck_s_right
  0E74  CAD00E        	 jp z,cross_ck_s_down
  0E77                	cross_ck_s_left:
  0E77  3ADE4A        	 ld A,(gil_xy+1)
  0E7A  E63F          	 and 3fh
  0E7C  92            	 sub D	;x-x1
  0E7D  FE03          	 cp 3
  0E7F  3805          	 jr c,cross_ck_s_left_2
  0E81  2F            	 cpl
  0E82  3C            	 inc A
  0E83  FE03          	 cp 3
  0E85  D0            	 ret nc
  0E86                	cross_ck_s_left_2:
  0E86  3ADD4A        	 ld A,(gil_xy)
  0E89  93            	 sub E
  0E8A  FE06          	 cp 6		;when (a-d)>0 is that empty at left.
  0E8C  D8            	 ret c
  0E8D  2F            	 cpl
  0E8E  3C            	 inc A
  0E8F  FE03          	 cp 3
  0E91  DAEC0C        	 jp c,gil_killing
  0E94  C9            	 ret
  0E95                	cross_ck_s_up:
  0E95  3ADD4A        	 ld A,(gil_xy)
  0E98  93            	 sub E	;x-x1
  0E99  FE03          	 cp 3
  0E9B  3805          	 jr c,cross_ck_s_up_2
  0E9D  2F            	 cpl
  0E9E  3C            	 inc A
  0E9F  FE03          	 cp 3
  0EA1  D0            	 ret nc
  0EA2                	cross_ck_s_up_2:
  0EA2  3ADE4A        	 ld A,(gil_xy+1)
  0EA5  E63F          	 and 3fh
  0EA7  92            	 sub D
  0EA8  FE03          	 cp 3		;when (a-d)>0 is that empty at up.
  0EAA  D8            	 ret c
  0EAB  2F            	 cpl
  0EAC  3C            	 inc A
  0EAD  FE03          	 cp 3
  0EAF  DAEC0C        	 jp c,gil_killing
  0EB2  C9            	 ret
  0EB3                	cross_ck_s_right:
  0EB3  3ADE4A        	 ld A,(gil_xy+1)
  0EB6  E63F          	 and 3fh
  0EB8  92            	 sub D	;x-x1
  0EB9  FE03          	 cp 3
  0EBB  3805          	 jr c,cross_ck_s_right_2
  0EBD  2F            	 cpl
  0EBE  3C            	 inc A
  0EBF  FE03          	 cp 3
  0EC1  C9            	 ret ;c or nc
  0EC2                	cross_ck_s_right_2:
  0EC2  3ADD4A        	 ld A,(gil_xy)
  0EC5  93            	 sub E
  0EC6  FE03          	 cp 3		;when (a-d)<0 is that empty at right.
  0EC8  DAEC0C        	 jp c,gil_killing
  0ECB  2F            	 cpl
  0ECC  3C            	 inc A
  0ECD  FE06          	 cp 6
  0ECF  C9            	 ret ;c or nc
  0ED0                	cross_ck_s_down:
  0ED0  3ADD4A        	 ld A,(gil_xy)
  0ED3  93            	 sub E	;x-x1
  0ED4  FE03          	 cp 3
  0ED6  3805          	 jr c,cross_ck_s_down_2
  0ED8  2F            	 cpl
  0ED9  3C            	 inc A
  0EDA  FE03          	 cp 3
  0EDC  D0            	 ret nc
  0EDD                	cross_ck_s_down_2:
  0EDD  3ADE4A        	 ld A,(gil_xy+1)
  0EE0  E63F          	 and 3fh
  0EE2  92            	 sub D
  0EE3  FE03          	 cp 3		;when (a-d)<0 is that empty at down.
  0EE5  DAEC0C        	 jp c,gil_killing
  0EE8  D8            	 ret c
  0EE9  2F            	 cpl
  0EEA  3C            	 inc A
  0EEB  FE06          	 cp 6
  0EED  C9            	 ret
                      	
                      	
  0EEE                	cross_ck_a:;HL=obj_xy+
  0EEE  5E            	 ld E,(HL);x
  0EEF  23            	 inc HL
  0EF0  7E            	 ld A,(HL)
  0EF1  2B            	 dec HL
  0EF2  E63F          	 and 3fh
  0EF4  57            	 ld D,A	;y
                      	; ld HL,(gil_xy)
  0EF5  3ADD4A        	 ld A,(gil_xy)
  0EF8  93            	 sub E	;x-x1
  0EF9  FE03          	 cp 3
  0EFB  3805          	 jr c,cross_ck_al
  0EFD  2F            	 cpl
  0EFE  3C            	 inc A
  0EFF  FE03          	 cp 3
  0F01  D0            	 ret nc
  0F02                	cross_ck_al:
  0F02  3ADE4A        	 ld A,(gil_xy+1)
  0F05  E63F          	 and 3fh
  0F07  92            	 sub D
  0F08  FE03          	 cp 3
  0F0A  D8            	 ret c
  0F0B  2F            	 cpl
  0F0C  3C            	 inc A
  0F0D  FE03          	 cp 3
  0F0F  C9            	 ret ;nc or cy
                      	;cy is crosses.
                      	
  0F10                	cha_kill:;HL=obj_xy++,IX=obj_hp
  0F10  E5            	 push HL
  0F11  5E            	 ld E,(HL)
  0F12  23            	 inc HL
  0F13  56            	 ld D,(HL)
  0F14  CD6712        	 call grp_del
  0F17  21BC19        	 ld HL,dammy
  0F1A  7E            	 ld A,(HL)
  0F1B  3C            	 inc A
  0F1C  77            	 ld (HL),A
  0F1D  E1            	 pop HL
  0F1E  AF            	 xor A
  0F1F  DD7700        	 ld (IX),A
  0F22  C9            	 ret
                      	
                      	
  0F23                	wall_ck:
  0F23  E5            	 push HL
  0F24  CD290F        	 call wall_cks
  0F27  E1            	 pop HL
  0F28  C9            	 ret
                      	
  0F29                	wall_cks:;HL,obj_xy+;non zero=don't pass, zero=pass and A=0, cy=not block
  0F29  E5            	 push HL
                      	;HL=(y,x)
  0F2A  5E            	 ld E,(HL);x
  0F2B  23            	 inc HL
  0F2C  56            	 ld D,(HL);y
  0F2D  2B            	 dec HL
  0F2E  EB            	 ex DE,HL
  0F2F  3E3F          	 ld A,00111111b
  0F31  A4            	 and H
  0F32  010000        	 ld BC,0
  0F35  2808          	 jr z,wall_ck_lc
  0F37                	wall_ck_lb:
  0F37  04            	 inc B
  0F38  D607          	 sub 7
  0F3A  DAB30F        	 jp c,wall_ck_end
  0F3D  20F8          	 jr nz,wall_ck_lb
  0F3F                	wall_ck_lc:
  0F3F  7D            	 ld A,L
  0F40  D61E          	 sub 30
  0F42  2808          	 jr z,wall_ck_le
  0F44                	wall_ck_ld:
  0F44  0C            	 inc C
  0F45  D607          	 sub 7
  0F47  DAB30F        	 jp c,wall_ck_end
  0F4A  20F8          	 jr nz,wall_ck_ld
  0F4C                	wall_ck_le:
  0F4C  7C            	 ld A,H
  0F4D  E6C0          	 and 11000000b
  0F4F  CA9D0F        	 jp z,wall_ck_lu
  0F52  FE80          	 cp 80h
  0F54  DA860F        	 jp c,wall_ck_lr
  0F57  CA700F        	 jp z,wall_ck_ldd
                      	
  0F5A                	wall_ck_ll:
  0F5A  213311        	 ld HL,map_memry_left-17
                      	;x+C
  0F5D  59            	 ld E,C
  0F5E  1600          	 ld D,0
  0F60  19            	 add HL,DE
                      	;y+17*B
  0F61  111100        	 ld DE,17
  0F64  04            	 inc B
  0F65                	wall_ck_ll_2:
  0F65  19            	 add HL,DE
  0F66  10FD          	 djnz wall_ck_ll_2
                      	; or A
                      	; sbc HL,DE
  0F68  22F60F        	 ld (block_pointaP+1),HL
  0F6B  7E            	 ld A,(HL)
  0F6C  E680          	 and t;t(80h) or f(0)
  0F6E  E1            	 pop HL
                      	
                      	; ld A,"l"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0F6F  C9            	 ret
                      	
                      	
  0F70                	wall_ck_ldd:
  0F70  21B410        	 ld HL,map_memry_top-16
                      	;x+C
  0F73  59            	 ld E,C
  0F74  1600          	 ld D,0
  0F76  19            	 add HL,DE
                      	;y+16*B
  0F77  111000        	 ld DE,16
  0F7A  04            	 inc B
  0F7B                	wall_ck_ld2:
  0F7B  19            	 add HL,DE
  0F7C  10FD          	 djnz wall_ck_ld2
                      	; sub HL,DE
  0F7E  22F60F        	 ld (block_pointaP+1),HL
  0F81  7E            	 ld A,(HL)
  0F82  E680          	 and t;t(80h) or f(0)
  0F84  E1            	 pop HL
                      	
                      	; ld A,"d"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0F85  C9            	 ret
                      	
                      	
  0F86                	wall_ck_lr:
  0F86  213311        	 ld HL,map_memry_left-17
                      	;x+C
  0F89  59            	 ld E,C
  0F8A  1600          	 ld D,0
  0F8C  19            	 add HL,DE
  0F8D  23            	 inc HL
                      	;y+17*B
  0F8E  111100        	 ld DE,17
  0F91  04            	 inc B
  0F92                	wall_ck_lr_2:
  0F92  19            	 add HL,DE
  0F93  10FD          	 djnz wall_ck_lr_2
                      	; or A
                      	; sbc HL,DE
  0F95  22F60F        	 ld (block_pointaP+1),HL
  0F98  7E            	 ld A,(HL)
  0F99  E680          	 and t;t(80h) or f(0)
  0F9B  E1            	 pop HL
                      	
                      	; ld A,"r"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0F9C  C9            	 ret
                      	
                      	
                      	
                      	
  0F9D                	wall_ck_lu:
  0F9D  21A410        	 ld HL,map_memry_top-16-16
                      	;x+C
  0FA0  59            	 ld E,C
  0FA1  1600          	 ld D,0
  0FA3  19            	 add HL,DE
                      	;y+16*B
  0FA4  111000        	 ld DE,16
  0FA7  04            	 inc B
  0FA8                	wall_ck_lu2:
  0FA8  19            	 add HL,DE
  0FA9  10FD          	 djnz wall_ck_lu2
                      	; or A
                      	; sbc HL,DE
  0FAB  22F60F        	 ld (block_pointaP+1),HL
  0FAE  7E            	 ld A,(HL)
  0FAF  E680          	 and t;t(80h) or f(0)
  0FB1  E1            	 pop HL
                      	
                      	; ld A,"u"
                      	; ld DE,0
                      	; call 0be62h
                      	; pop HL
                      	
  0FB2  C9            	 ret
  0FB3                	wall_ck_end:
  0FB3  E1            	 pop HL
  0FB4  AF            	 xor A
  0FB5  C9            	 ret
                      	
                      	
                      	;******************************wall mod block**************************
                      	;********************wall mod****HL=obj_xy************************
  0FB6                	wall_mod:
  0FB6  010000        	 ld BC,0
  0FB9  7E            	 ld A,(HL) 
  0FBA  5F            	 ld E,A
  0FBB  23            	 inc HL
  0FBC  7E            	 ld A,(HL)
  0FBD  E63F          	 and 00111111b
  0FBF  57            	 ld D,A
  0FC0  2B            	 dec HL
                      	 
  0FC1  7B            	 ld A,E
  0FC2  D61E          	 sub 30
  0FC4  2807          	 jr z,wall_mod_l2
  0FC6                	wall_mod_l1:
  0FC6  D607          	 sub 7
  0FC8  2803          	 jr z,wall_mod_l2
  0FCA  30FA          	 jr nc,wall_mod_l1
  0FCC  4F            	 ld C,A
                      	
  0FCD                	wall_mod_l2
  0FCD  7A            	 ld A,D
  0FCE  B7            	 or A
  0FCF  2807          	 jr z,wall_mod_l4
  0FD1                	wall_mod_l3:
  0FD1  D607          	 sub 7
  0FD3  2803          	 jr z,wall_mod_l4
  0FD5  30FA          	 jr nc,wall_mod_l3
  0FD7  47            	 ld B,A
  0FD8                	wall_mod_l4
                      	; ld A,E
                      	; ld (0f0h),A
                      	; ld A,D
                      	; ld (0f1h),A
                      	; ld A,C
                      	; ld (0f4h),A
                      	; ld A,B
                      	; ld (0f5h),A
  0FD8  C9            	 ret
                      	 
                      	 
                      	 
                      	;*************************************matk action******************************
                      	
  0FD9                	matk_action_gil:
  0FD9  21D64A        	 ld HL,gil_matk_count
  0FDC  5E            	 ld E,(HL)
  0FDD  1C            	 inc E
  0FDE  1D            	 dec E
  0FDF  C8            	 ret z
  0FE0  1D            	 dec E
  0FE1  73            	 ld (HL),E
                      	
  0FE2  21DD4A        	 ld HL,gil_xy
  0FE5                	matk_action:;HL=obj address+ let push pop
  0FE5  08            	 ex AF,AF'
  0FE6  323710        	 ld (matk_action_gil_ret+1),A
  0FE9  220010        	 ld (matk_action_HLP+1),HL
  0FEC  CD230F        	 call wall_ck
  0FEF  DA3610        	 jp c,matk_action_gil_ret
  0FF2  CA3610        	 jp z,matk_action_gil_ret
  0FF5                	block_pointaP:
  0FF5  210000        	 ld HL,overwrite		;block address
  0FF8  4E            	 ld C,(HL)
  0FF9  0C            	 inc C
  0FFA  CA2B10        	 jp z,gil_matk_break 
  0FFD  3600          	 ld (HL),0
                      	 
                      	; call bls
                      	
  0FFF                	matk_action_HLP:
  0FFF  210000        	 ld HL,overwrite
  1002  223910        	 ld (matk_action_gil_ret+3),HL
                      	
  1005  5E            	 ld E,(HL)
  1006  23            	 inc HL
  1007  56            	 ld D,(HL)
  1008  7A            	 ld A,D
  1009  E6C0          	 and 11000000b
  100B  2818          	 jr z,matk_action_u
  100D  FE80          	 cp 80h
  100F  380E          	 jr c,matk_action_r
  1011  2806          	 jr z,matk_action_d
  1013                	matk_action_l:
  1013  1D            	 dec E
  1014  CD6712        	 call grp_del
  1017  181D          	 jr matk_action_gil_ret
  1019                	matk_action_d:
  1019  14            	 inc D
  101A  CD6712        	 call grp_del
  101D  1817          	 jr matk_action_gil_ret
  101F                	matk_action_r:
  101F  1C            	 inc E
  1020  CD6712        	 call grp_del
  1023  1811          	 jr matk_action_gil_ret
  1025                	matk_action_u:
  1025  15            	 dec D
  1026  CD6712        	 call grp_del
  1029  180B          	 jr matk_action_gil_ret
                      	
  102B                	gil_matk_break:
  102B  DD7ED0        	 ld A,(IX-48)
  102E  FE8F          	 cp 8fh
  1030  2004          	 jr nz,matk_action_gil_ret
  1032  AF            	 xor A
  1033  32D64A        	 ld (gil_matk_count),A
  1036                	matk_action_gil_ret:
  1036  3E00          	 ld A,overwrite
  1038  210000        	 ld HL,overwrite
  103B  08            	 ex AF,AF'
  103C  C9            	 ret
                      	
                      	
                      	
  103D                	Map_make:
  103D  CDAF0D        	 call cls
  1040  21F519        	 ld HL,Map_data
  1043  3A4949        	 ld A,(floor)
  1046  3D            	 dec A
  1047  11C900        	 ld DE,96+105
  104A  CD5D0D        	 call xsan
  104D  11C410        	 ld DE,map_memry_top
  1050  016000        	 ld BC,96
  1053  EDB0          	 ldir
  1055  114411        	 ld DE,map_memry_left
  1058  3E07          	 ld A,7
  105A  13            	 inc DE
  105B                	map_make_l:
  105B  F5            	 push AF
  105C  010F00        	 ld BC,15
  105F  EDB0          	 ldir
  1061  13            	 inc DE
  1062  13            	 inc DE
  1063  F1            	 pop AF
  1064  3D            	 dec A
  1065  20F4          	 jr nz,map_make_l
  1067  111E06        	 ld DE,061eh
  106A  DD21C410      	 ld IX,map_memry_top
  106E  FD214411      	 ld IY,map_memry_left
                      	
  1072                	map_make_l_l:
  1072  DD7E00        	 ld A,(IX)
  1075  E680          	 and t
  1077  2808          	 jr z,map_make_Xe
  1079  D5            	 push DE
  107A  21CC11        	 ld HL,graph_wall+0
  107D  CDD811        	 call grp_set
  1080  D1            	 pop DE
  1081                	map_make_Xe:
  1081  DD23          	 inc IX
                      	
  1083  FD7E00        	 ld A,(IY)
  1086  E680          	 and t
  1088  280F          	 jr z,map_make_Ye
  108A  D5            	 push DE
  108B  21D211        	 ld HL,graph_wall+6
  108E  15            	 dec D
  108F  15            	 dec D
  1090  15            	 dec D
  1091  15            	 dec D
  1092  15            	 dec D
  1093  15            	 dec D
  1094  1D            	 dec E
  1095  CDD811        	 call grp_set
  1098  D1            	 pop DE
  1099                	map_make_Ye:
  1099  FD23          	 inc IY
                      	
  109B  3E07          	 ld A,7
  109D  83            	 add A,E
  109E  5F            	 ld E,A
  109F  FE8E          	 cp 142
  10A1  C27210        	 jp nz,map_make_l_l
                      	 
  10A4  3E07          	 ld A,7
  10A6  82            	 add A,D
  10A7  57            	 ld D,A
  10A8  FE37          	 cp 55
  10AA  2807          	 jr z,map_make_end
  10AC  1E1E          	 ld E,1eh
  10AE  FD23          	 inc IY
  10B0  C37210        	 jp map_make_l_l
  10B3                	map_make_end:
  10B3  C9            	 ret
                      	
                      	
                      	
                      	
  10B4  FFFFFFFFFFFFFF	 db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh;16
  10C4                	map_memry_top:;1(ture or false)0000000(loop count,7fh=Outer wall)b
  10C4                	 ds 16
  10D4                	 ds 16
  10E4                	 ds 16
  10F4                	 ds 16
  1104                	 ds 16
  1114                	 ds 16
  1124  FFFFFFFFFFFFFF	 db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh;16
  1134  FFFFFFFFFFFFFF	 db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh;16
                      	
                      	
                      	
  1144                	map_memry_left:;1(ture or false)0000000(loop count,7fh=Outer wall)b
  1144  FF            	 db 0ffh
  1145                	 ds 15
  1154  FF            	 db 0ffh
  1155  FF            	 db 0ffh
  1156                	 ds 15
  1165  FF            	 db 0ffh
  1166  FF            	 db 0ffh
  1167                	 ds 15
  1176  FF            	 db 0ffh
  1177  FF            	 db 0ffh
  1178                	 ds 15
  1187  FF            	 db 0ffh
  1188  FF            	 db 0ffh
  1189                	 ds 15
  1198  FF            	 db 0ffh
  1199  FF            	 db 0ffh
  119A                	 ds 15
  11A9  FF            	 db 0ffh
  11AA  FF            	 db 0ffh
  11AB                	 ds 15
  11BA  FF            	 db 0ffh
  11BB  FF            	 db 0ffh
                      	 
  11BC                	 ds 15
  11CB  FF            	 db 0ffh
  11CC                	graph_wall:
  11CC  010101010101  	 db 1,1,1,1,1,1
  11D2  3F0000000000  	 db 3fh,0,0,0,0,0
                      	
                      	
                      	
  11D8                	grp_set:;HL_data,DE_(y,x),B_databit
  11D8  0606          	 ld B,6
                      	;
                      	
  11DA  7A            	 ld A,D
  11DB  E6C0          	 and 11000000b
  11DD  281F          	 jr z,grp_set_0
  11DF  FE80          	 cp 80h
  11E1  3814          	 jr c,grp_set_1
  11E3  2809          	 jr z,grp_set_2
                      	;left
  11E5  3E12          	 ld A,18
  11E7  85            	 add A,L
  11E8  6F            	 ld L,A
  11E9  3013          	 jr nc,grp_set_0
  11EB  24            	 inc H
  11EC  1810          	 jr grp_set_0
                      	;dowm
  11EE                	grp_set_2:
  11EE  3E0C          	 ld A,12
  11F0  85            	 add A,L
  11F1  6F            	 ld L,A
  11F2  300A          	 jr nc,grp_set_0
  11F4  24            	 inc H
  11F5  1807          	 jr grp_set_0
                      	;right
  11F7                	grp_set_1:
  11F7  3E06          	 ld A,6
  11F9  85            	 add A,L
  11FA  6F            	 ld L,A
  11FB  3001          	 jr nc,grp_set_0
  11FD  24            	 inc H
                      	
                      	;up,non direction
  11FE                	grp_set_0:
  11FE  7B            	 ld A,E
  11FF  322512        	 ld (grp_set_or1+1),A
  1202  7A            	 ld A,D
  1203  E63F          	 and 3fh
  1205  1600          	 ld D,0
  1207                	grp_set_set1:
  1207  14            	 inc D
  1208  D608          	 sub 8
  120A  30FB          	 jr nc,grp_set_set1
  120C  15            	 dec D
  120D  C608          	 add A,8
  120F                	grp_set_set2:
  120F  322E12        	 ld (grp_set_shiftd_bit+1),A
  1212  4F            	 ld C,A
  1213  3E08          	 ld A,8
  1215  91            	 sub C
  1216  325412        	 ld (grp_set_shiftu_bit+1),A
                      	
  1219                	grp_set_shiftd:
  1219  7A            	 ld A,D			;line number
  121A  E5            	 push HL					;HL
  121B  216813        	 ld HL,grapu_area
  121E  119000        	 ld DE,144
  1221  CD5D0D        	 call xsan		;y+
  1224                	grp_set_or1:
  1224  1E00          	 ld E,overwrite
  1226  1600          	 ld D,0
  1228  19            	 add HL,DE		;x+
  1229  EB            	 ex DE,HL
  122A  E1            	 pop HL			;data
  122B  E5            	 push HL					;HL
  122C  C5            	 push BC						;BC
  122D                	grp_set_shiftd_bit:
  122D  0E00          	 ld C,overwrite		;shift bit count
  122F  7E            	 ld A,(HL)
  1230  08            	 ex AF,AF'
  1231  79            	 ld A,C
  1232  B7            	 or A
  1233  2807          	 jr z,grp_set_shiftd_bit_2
  1235  08            	 ex AF,AF'
  1236                	grp_set_shiftd_bit_l:
  1236  CB27          	 sla A
  1238  0D            	 dec C
  1239  20FB          	 jr nz,grp_set_shiftd_bit_l
  123B  08            	 ex AF,AF'
  123C                	grp_set_shiftd_bit_2:
  123C  08            	 ex AF,AF'
  123D  4F            	 ld C,A
  123E  1A            	 ld A,(DE)
  123F                	grp_set_change1:
  123F  B1            	 or C
  1240  12            	 ld (DE),A
  1241                	grp_set_shiftd_l:
  1241  23            	 inc HL
  1242  13            	 inc DE
  1243  10E8          	 djnz grp_set_shiftd_bit
                      	
                      	; dec DE
                      	
  1245  EB            	 ex DE,HL
  1246  119000        	 ld DE,144
  1249  19            	 add HL,DE
                      	
                      	
  124A  C1            	 pop BC						;HL
  124B  7D            	 ld A,L
  124C  90            	 sub B
  124D  3001          	 jr nc,grp_set_shiftu_bit_b
  124F  25            	 dec H
  1250                	grp_set_shiftu_bit_b:
  1250  6F            	 ld L,A
  1251  EB            	 ex DE,HL
                      	
  1252  E1            	 pop HL			;data2
  1253                	grp_set_shiftu_bit:
  1253  0E00          	 ld C,overwrite		;shift bit count
  1255  7E            	 ld A,(HL)
  1256                	grp_set_shiftu_bit_l
  1256  CB3F          	 srl A
  1258  0D            	 dec C
  1259  20FB          	 jr nz,grp_set_shiftu_bit_l
  125B  4F            	 ld C,A
  125C  1A            	 ld A,(DE)
  125D                	grp_set_change2:
  125D  B1            	 or C
  125E  12            	 ld (DE),A
  125F                	grp_set_shiftu_l:
  125F  23            	 inc HL
  1260  13            	 inc DE
  1261  10F0          	 djnz grp_set_shiftu_bit
                      	
  1263  CDE30D        	 call grp_o
  1266  C9            	 ret
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
                      	
  1267                	grp_del:;HL_data,DE_(y,x),B_databit
  1267  21D212        	 ld HL,del_graph
  126A  0606          	 ld B,6
  126C  7B            	 ld A,E
  126D  329312        	 ld (grp_set_or1d+1),A
  1270  7A            	 ld A,D
  1271  E63F          	 and 3fh
  1273  1600          	 ld D,0
  1275                	grp_set_set1d:
  1275  14            	 inc D
  1276  D608          	 sub 8
  1278  30FB          	 jr nc,grp_set_set1d
  127A  15            	 dec D
  127B  C608          	 add A,8
  127D                	grp_set_set2d:
  127D  329C12        	 ld (grp_set_shiftd_bitd+1),A
  1280  4F            	 ld C,A
  1281  3E08          	 ld A,8
  1283  91            	 sub C
  1284  32C212        	 ld (grp_set_shiftu_bitd+1),A
                      	
  1287                	grp_set_shiftdd:
  1287  7A            	 ld A,D			;line number
  1288  E5            	 push HL					;HL
  1289  216813        	 ld HL,grapu_area
  128C  119000        	 ld DE,144
  128F  CD5D0D        	 call xsan		;y+
  1292                	grp_set_or1d:
  1292  1E00          	 ld E,overwrite
  1294  1600          	 ld D,0
  1296  19            	 add HL,DE		;x+
  1297  EB            	 ex DE,HL
  1298  E1            	 pop HL			;data
  1299  E5            	 push HL					;HL
  129A  C5            	 push BC						;BC
  129B                	grp_set_shiftd_bitd:
  129B  0E00          	 ld C,overwrite		;shift bit count
  129D  7E            	 ld A,(HL)
  129E  08            	 ex AF,AF'
  129F  79            	 ld A,C
  12A0  B7            	 or A
  12A1  2807          	 jr z,grp_set_shiftd_bit_2d
  12A3  08            	 ex AF,AF'
  12A4                	grp_set_shiftd_bit_ld:
  12A4  37            	 scf
  12A5  17            	 rla
  12A6  0D            	 dec C
  12A7  20FB          	 jr nz,grp_set_shiftd_bit_ld
  12A9  08            	 ex AF,AF'
  12AA                	grp_set_shiftd_bit_2d:
  12AA  08            	 ex AF,AF'
  12AB  4F            	 ld C,A
  12AC  1A            	 ld A,(DE)
  12AD                	grp_set_change1d:
  12AD  A1            	 and C
  12AE  12            	 ld (DE),A
  12AF                	grp_set_shiftd_ld:
  12AF  23            	 inc HL
  12B0  13            	 inc DE
  12B1  10E8          	 djnz grp_set_shiftd_bitd
                      	
                      	; dec DE
                      	
  12B3  EB            	 ex DE,HL
  12B4  119000        	 ld DE,144
  12B7  19            	 add HL,DE
                      	
                      	
  12B8  C1            	 pop BC						;HL
  12B9  7D            	 ld A,L
  12BA  90            	 sub B
  12BB  3001          	 jr nc,grp_set_shiftu_bit_bd
  12BD  25            	 dec H
  12BE                	grp_set_shiftu_bit_bd:
  12BE  6F            	 ld L,A
  12BF  EB            	 ex DE,HL
                      	
  12C0  E1            	 pop HL			;data2
  12C1                	grp_set_shiftu_bitd:
  12C1  0E00          	 ld C,overwrite		;shift bit count
  12C3  7E            	 ld A,(HL)
  12C4                	grp_set_shiftu_bit_ld
  12C4  37            	 scf
  12C5  1F            	 rra
  12C6  0D            	 dec C
  12C7  20FB          	 jr nz,grp_set_shiftu_bit_ld
  12C9  4F            	 ld C,A
  12CA  1A            	 ld A,(DE)
  12CB                	grp_set_change2d:
  12CB  A1            	 and C
  12CC  12            	 ld (DE),A
  12CD                	grp_set_shiftu_ld:
  12CD  23            	 inc HL
  12CE  13            	 inc DE
  12CF  10F0          	 djnz grp_set_shiftu_bitd
  12D1  C9            	 ret
                      	
  12D2                	del_graph:
  12D2  C0C0C0C0C0C0  	 db 0c0h,0c0h,0c0h,0c0h,0c0h,0c0h
                      	
                      	
                      	; ds 144
                      	; ds 144
                      	
  12D8                	 ds 144
  1368                	grapu_area:
  1368                	 ds 144*6
  16C8                	 ds 144
                      	 
                      	; ds 144
                      	; ds 144
                      	;********************************Graphics**********************************
  1758                	graph_title:
  1758  00000000000000	 db 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,80h,60h,80h,00,00,0C0h,30h,0Ch,08h,30h,0C0h,0C0h,30h,08h,10h,0E0h,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
  178A  00000000000000	 db 00,00,00,00,00,00,00,00,00,80h,0C0h,00,00,80h,60h,10h,18h,06h,01h,00h,01h,0Eh,03h,00,00,00,00,00,00,01,00,00,00,03,0Ch,30h,40h,080h,00,80h,0E0h,00,00,00,00,00,00,00,00,00
  17BC  000000000000C0	 db 00,00,00,00,00,00,0C0h,30h,0Eh,01h,4Fh,66h,0F1h,0E0h,0F0h,58h,58h,40h,20h,80h,0E0h,0F8h,80h,0F0h,0C0h,0E0h,0F0h,0D8h,68h,0A9h,0C3h,42h,82h,86h,84h,0Ch,18h,79h,0F6h,0E1h,0C1h,86h,38h,0C0h,00,00,00,00,00,00
  17EE  00804020180601	 db 00,80h,40h,20h,18h,06h,01h,00,00,00,00,0Fh,3Fh,7Fh,0FEh,0F8h,0F8h,0F0h,0FEh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,0FFh,7Eh,7Eh,7Dh,7Dh,78h,7Dh,3Fh,1Fh,0Fh,00,00,03h,0Ch,70h,80h,00,00
  1820  00FF0000000000	 db 00,0FFh,00,00,00,00,00,00,00,0F8h,08,08,0F0h,00,0FCh,02Eh,06Fh,0D7h,07,7Fh,80h,00,0F8h,00,0F0h,50h,4Ch,4Eh,0FFh,07,0F7h,0Fh,4Eh,4Ch,0D4h,00,0F0h,50h,48h,48h,0F8h,00,00,00,00,00,00,0Fh,30h,0C0h
  1852  78474040404044	 db 78h,47h,40h,40h,40h,40h,44h,44h,44h,45h,45h,45h,44h,44h,45h,44h,44h,45h,44h,44h,45h,45h,45h,44h,45h,44h,44h,44h,45h,44h,44h,45h,45h,45h,45h,44h,45h,44h,44h,44h,45h,44h,44h,44h,40h,40h,40h,40h,40h,7Fh
                      	
  1884                	graph_gil_ulf:
  1884  000C3F1F0C00  	 db 00,0Ch,3Fh,1Fh,0Ch,00
  188A                	graph_gil_rlf:
  188A  00003F3F0C00  	 db 00,00,3Fh,3Fh,0Ch,00
  1890                	graph_gil_dlf:
  1890  000C1F370C00  	 db 00,0Ch,1Fh,37h,0Ch,00
  1896                	graph_gil_llf:
  1896  000C3F3F0000  	 db 00,0Ch,3Fh,3Fh,00,00
                      	
  189C                	graph_gil_urf:
  189C  000C1F3F0C00  	 db 00,0Ch,1Fh,3Fh,0Ch,00
  18A2                	graph_gil_rrf:
  18A2  00201F1F2C00  	 db 00,20h,1Fh,1Fh,2Ch,00
  18A8                	graph_gil_drf:
  18A8  000C3F170C00  	 db 00,0Ch,3Fh,17h,0Ch,00
  18AE                	graph_gil_lrf:
  18AE  002C1F1F2000  	 db 00,2Ch,1Fh,1Fh,20h,00
                      	
  18B4                	graph_gilsw_ulf:
  18B4  000C3F1F0C08  	 db 00,0Ch,3Fh,1Fh,0Ch,08
  18BA  080C3F3F0C00  	 db 08h,0Ch,3Fh,3Fh,0Ch,00
  18C0  080C1F370C00  	 db 08,0Ch,1Fh,37h,0Ch,00
  18C6  000C3F3F0C08  	 db 00,0Ch,3Fh,3Fh,0Ch,08
                      	;graph_gilsw_urf:
  18CC  000C1F3F0C08  	 db 00,0Ch,1Fh,3Fh,0Ch,08
  18D2  082C1F1F2C00  	 db 08,2Ch,1Fh,1Fh,2Ch,00
  18D8  080C3F170C00  	 db 08,0Ch,3Fh,17h,0Ch,00
  18DE  002C1F1F2C08  	 db 00,2Ch,1Fh,1Fh,2Ch,08
                      	
  18E4                	graph_gilsword_ulf:
  18E4  1E0C3F1F0407  	 db 1Eh,0Ch,3Fh,1Fh,04h,07h
  18EA  000E3F3F0808  	 db 00,0Eh,3Fh,3Fh,08,08
  18F0  38041F3F0C1E  	 db 38h,04h,1Fh,3Fh,0Ch,1Eh
  18F6  08083F3F0E00  	 db 08,08,3Fh,3Fh,0Eh,00
                      	;graph_gilsword_ulf:
  18FC  1E0C1F3F0407  	 db 1Eh,0Ch,1Fh,3Fh,04,07
  1902  002E1F1F2808  	 db 00,2Eh,1Fh,1Fh,28h,08
  1908  38043F1F0C1E  	 db 38h,04h,3Fh,1Fh,0Ch,1Eh
  190E  08281F1F2E00  	 db 08,28h,1Fh,1Fh,2Eh,00
                      	
                      	
  1914                	graph_sraimd:
  1914  00181C1C1800  	 db 00,18h,1Ch,1Ch,18h,00
  191A                	graph_sraimu:
  191A  00181C1C1800  	 db 00,18h,1Ch,1Ch,18h,00
  1920                	graph_sraimd1:
  1920  000C1A1E0C00  	 db 00,0Ch,1Ah,1Eh,0Ch,00
  1926                	graph_sraimu2:
  1926  000C1A1E0C00  	 db 00,0Ch,1Ah,1Eh,0Ch,00
                      	
  192C                	magic:
  192C  032E3F3F2E03  	 db 03,2Eh,3Fh,3Fh,2Eh,03
  1932                	magicr:
  1932  00203F3F2E18  	 db 00,20h,3Fh,3Fh,2Eh,18h
  1938                	magic3:
  1938  182E3F3F2E18  	 db 18h,2Eh,3Fh,3Fh,2Eh,18h
  193E                	magic4:
  193E  182E3F3F2000  	 db 18h,2Eh,3Fh,3Fh,20h,00
                      	 
  1944                	graph_goast:
  1944  030E1F1F0E03  	 db 03,0Eh,1Fh,1Fh,0Eh,03
  194A  10181E1F0F1A  	 db 10h,18h,1Eh,1Fh,0Fh,1Ah
  1950  180E1F1F0E18  	 db 18h,0Eh,1Fh,1Fh,0Eh,18h
  1956  1A0F1F1E1810  	 db 1Ah,0Fh,1Fh,1Eh,18h,10h
                      	 
  195C                	graph_spell:
  195C  000018180000  	 db 00,00,18h,18h,00,00
  1962  000018180000  	 db 00,00,18h,18h,00,00
  1968  000018180000  	 db 00,00,18h,18h,00,00
  196E  000018180000  	 db 00,00,18h,18h,00,00
                      	 
                      	
  1974                	graph_n_knightu:;r foot
  1974  000C1F3F0407  	 db 00,0Ch,1Fh,3Fh,04,07
  197A                	graph_n_knightr:
  197A  00201F1F2808  	 db 00,20h,1Fh,1Fh,28h,08
  1980                	graph_n_knightd:
  1980  38043F1F0C00  	 db 38h,04h,3Fh,1Fh,0Ch,00
  1986                	graph_n_knightl:
  1986  08281F1F2000  	 db 08,28h,1Fh,1Fh,20h,00
                      	 
                      	;graph_n_knightu:;l foot
  198C  000C3F1F0407  	 db 00,0Ch,3Fh,1Fh,04h,07h
                      	;graph_n_knightr:
  1992  00003F3F0808  	 db 00,00,3Fh,3Fh,08h,08
                      	;graph_n_knightd:
  1998  38041F3F0C00  	 db 38h,04h,1Fh,3Fh,0Ch,00
                      	;graph_n_knightl:
  199E  08083F3F0000  	 db 08,08,3Fh,3Fh,00,00
                      	
  19A4                	graph_key:
  19A4  20283A0D0200  	 db 20h,28h,3Ah,0Dh,02,00
  19AA                	graph_door:
  19AA  3E29293D293E  	 db 3Eh,29h,29h,3Dh,29h,3Eh
  19B0  3E3F3F3F3F3E  	 db 3Eh,3Fh,3Fh,3Fh,3Fh,3Eh
  19B6                	graph_box:
  19B6  1C161A161E0E  	 db 1Ch,16h,1Ah,16h,1Eh,0Eh
                      	
  19BC                	dammy:
  19BC  000000000000  	 db 0,0,0,0,0,0
  19C2  000000000000  	 db 0,0,0,0,0,0
  19C8  000000000000  	 db 0,0,0,0,0,0
  19CE  000000000000  	 db 0,0,0,0,0,0
                      	;************************************Data**************************************
  19D4                	obj_1:
  19D4  01010101010183	 db 1,1,1,1,1,1,83h,84h,85h,8fh,0
  19DF  01010102020183	 db 1,1,1,2,2,1,83h,84h,85h,8fh,0
  19EA  01010102020183	 db 1,1,1,2,2,1,83h,84h,85h,8fh,0
                      	
                      	
  19F5                	Map_data:;96+105=201byte
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f;d
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	; db f,f,f,f,f,f,f,f,f,f,f,f,f,f,f
                      	 
                      	 
  19F5  00008080800000	 db f,f,t,t,t,f,f,f,f,f,f,t,f,t,f,f
  1A05  00000080008000	 db f,f,f,t,f,t,f,t,f,t,t,f,t,t,f,t
  1A15  80008080000080	 db t,f,t,t,f,f,t,f,f,f,f,f,t,f,f,t
  1A25  00008080808000	 db f,f,t,t,t,t,f,t,f,t,f,f,f,t,f,f
  1A35  00008080808000	 db f,f,t,t,t,t,f,t,t,f,f,t,f,t,f,t
  1A45  80008000008000	 db t,f,t,f,f,t,f,f,t,t,f,t,t,t,f,t
                      	
  1A55  80000000000080	 db t,f,f,f,f,f,t,f,t,t,f,f,f,f,t
  1A64  00800000808000	 db f,t,f,f,t,t,f,t,f,f,f,t,f,t,f
  1A73  80800080800000	 db t,t,f,t,t,f,f,t,t,t,t,f,t,t,f
  1A82  80800000008080	 db t,t,f,f,f,t,t,t,f,f,t,t,f,t,f
  1A91  80000000800080	 db t,f,f,f,t,f,t,f,t,t,t,t,t,f,t
  1AA0  00008000000000	 db f,f,t,f,f,f,f,f,f,t,f,f,t,f,f
  1AAF  00800080008080	 db f,t,f,t,f,t,t,f,f,f,f,f,t,f,f
                      	 
  1ABE                	 ds 201*59
                      	 
  4911                	hp_table1:
  4911  01010101010101	 db 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  4921                	hp_table2:
  4921  01010101181818	 db 1,1,1,1,24,24,24,1,1
  492A                	hp_table3:
  492A  18303060609060	 db 24,48,48,96,96,144,96
  4931                	hp_table4:
  4931  30507001181818	 db 48,80,112,1,24,24,24,96
  4939                	hp_table5:
  4939  01010101010101	 db 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10110000b
                      	 
                      	;**********************************Variable**************************************
  4949  00            	floor:db 0
  494A  0000          	pdoor_xy:dw 0		;83h
  494C  0000          	pkey_xy:dw 0		;85h
  494E  0000          	pgil_xy:dw 0		;84h,8fh
  4950                	obj:ds 48
  4980                	obj_hp:ds 48
  49B0                	obj_wp:ds 48
  49E0                	obj_st:ds 48
  4A10                	obj_xy:ds 96;(x,y&d)
  4A70                	obj_st2:ds 48
  4AA0                	obj_st3:ds 48
                      	
  4AD0  00            	gil_button:db 0
  4AD1  00            	gil_hp:db 0
  4AD2  00            	gil_wp:db 0
  4AD3  00            	gil_st1:db 0	;00 or ffh:right foot or left foot
  4AD4  00            	gil_st2:db 0	;bit 0-6:counter,bit 7:sword set,if bit 7 enable and bit 0-6 > 0 dec (st2)
                      			;
  4AD5  00            	gil_matk:db 0	;1:c,2:s,3:g,0:none
  4AD6  00            	gil_matk_count:db 0	;matk use count.it is deced when use a matk.
  4AD7  00            	gil_bt:db 0	;0ffh is dash enable.
  4AD8  00            	gil_sword:db 0	;1:dragon,2:ex
  4AD9  00            	gil_armor:db 0	;1 is hyper.
  4ADA  00            	gil_gunt:db 0	;1 is hyper.
  4ADB  00            	gil_shield:db 0	;1 is hyper.
  4ADC  00            	gil_neck:db 0	;1:g,2:r,3:b.
                      	
  4ADD                	gil_xy:ds 2
  4ADF                	gil_dblock:ds 2
                      	
  4AE1                	Item:
  4AE1                	matk:
  4AE1  00            	 db 0
  4AE2                	boot:
  4AE2  00            	 db 0
  4AE3                	sword
  4AE3  00            	 db 0:
  4AE4                	armor
  4AE4  00            	 db 0:
  4AE5                	gntrt
  4AE5  00            	 db 0:
  4AE6                	shield:
  4AE6  00            	 db 0
  4AE7                	hlmt:
  4AE7  00            	 db 0
  4AE8                	rod:
  4AE8  00            	 db 0
  4AE9                	book:
  4AE9  00            	 db 0
  4AEA                	cndl:
  4AEA  00            	 db 0
  4AEB                	brns:
  4AEB  00            	 db 0
  4AEC                	posion:
  4AEC  00            	 db 0
  4AED                	key:
  4AED  00            	 db 0
                      	
                      	
  4AEE                	end
